/*! For license information please see 7204.745279aacd9892c6.js.LICENSE.txt */
"use strict";(self.webpackChunkcollection_sidebar=self.webpackChunkcollection_sidebar||[]).push([[7204,8137],{8137:(e,t,n)=>{n.r(t),n.d(t,{FeatureFlagsProvider:()=>I,useFeatureFlag:()=>r,withFeatureFlagsConsumer:()=>i});var l=n(78439);const a=({options:e,allFlags:t,ldClient:n})=>{var l,a;const{flagName:r,defaultValue:s,requiredAttributesInContext:u=[]}="defaultValue"in e?e:Object.assign({},e,{defaultValue:void 0}),o=null!=(l=null==n||null==(a=n.getContext())?void 0:a.custom)?l:{},i=(null==u?void 0:u.length)>0&&!u.every((e=>e in o))?s:t[r];return null!=i?i:t[r]};function r(e){const t=(0,l.useFlags)(),n=(0,l.useLDClient)();return{value:a({allFlags:t,ldClient:n,options:e})}}var s=n(40540),u=n(52322);const o={ldClient:void 0,flags:void 0};function i(e){return(0,l.withLDConsumer)()((t=>{const n=(0,l.useFlags)(),r=(0,l.useLDClient)();return(0,u.jsx)(e,Object.assign({},t,o,{getFlagsValue:e=>a({options:e,ldClient:r,allFlags:n})}))}))}var d=n(26663),c=n.n(d),g=n(13101);const v=()=>(0,g.isLoggedIn)()?{kind:"user",key:(0,g.getUserId)(),custom:{platform:window.SDK_PLATFORM,appVersion:window.APP_VERSION,releaseChannel:window.NX_RELEASE_CHANNEL,analyticsEnabled:"browser"===window.SDK_PLATFORM,userCreatedAt:0,daysSinceUserCreate:0,emailDomain:"",isPaidPlanGrowth:!1,teamSize:0,roles:[],teamCreatedAt:0,daysSinceTeamCreate:0,webFnCustomPlanId:""}}:{kind:"anonymous",key:"0",custom:{platform:window.SDK_PLATFORM,appVersion:window.APP_VERSION,releaseChannel:window.NX_RELEASE_CHANNEL,analyticsEnabled:"browser"===window.SDK_PLATFORM}};var m=n(16669),C=n(88749);function f(e){return e&&+new Date(e)||0}function _(e){if(!e)return null;const t=new Date,n=new Date(e);return Math.floor(Math.abs(t.getTime()-n.getTime())/864e5)}const p=(0,s.createContext)(void 0),w=({passedInFeatureFlagContext:e,children:t,debounceInterval:n=200})=>{const[a,r]=(0,s.useState)([]),o=(0,s.useRef)(!1),i=(0,l.useLDClient)(),d=(0,s.useCallback)((e=>{r((t=>[...t,e]))}),[]),{loggedInUserCustomAttributes:c,isCustomAttributesLoading:v,externalUserId:w}=function(e){var t,n,a;const r=(0,g.getUserId)(),u=(0,g.isLoggedIn)(),o=(0,l.useLDClient)(),{data:i,isLoading:d}=(0,m.useTeamsByUserId)({overrideQueryParams:{billing:!0},enabled:u}),{data:c,isLoading:v}=(0,m.useExternalId)({userId:r,enabled:u}),{data:p,isLoading:w}=(0,m.useUserInfo)({userId:r,enabled:u}),{data:F,isLoading:b}=(0,C.useGetPlanFeatures)(r,u),I=null!=(t=null==i||null==(n=i.organizations)?void 0:n.find((e=>e.id===(0,g.getTeamId)())))?t:void 0,y=d||w||b||v,x=(0,s.useMemo)((()=>{var t,n,l,a,r,s,i,d,c,g,v;return y||!u?void 0:Object.assign({},null==o?void 0:o.getContext().custom,null==e?void 0:e.custom,{userCreatedAt:f(null!=(t=null==p?void 0:p.created_at)?t:null),daysSinceUserCreate:_(null!=(n=null==p?void 0:p.created_at)?n:null)||0,emailDomain:null!=(l=null==p||null==(a=p.email)?void 0:a.split("@")[1])?l:"",teamSize:null!=(r=null==I?void 0:I.team_size)?r:0,roles:(null!=(s=null==I?void 0:I.roles)?s:"").split(","),teamCreatedAt:f(null!=(i=null==I?void 0:I.created_at)?i:null),daysSinceTeamCreate:_(null!=(d=null==I?void 0:I.created_at)?d:null)||0,webFnCustomPlanId:null!=(c=null==I?void 0:I.plan)?c:null,isPaidPlanGrowth:null!=(g=null==F||null==(v=F.data)||null==(v=v.features.is_paid_plan_growth)?void 0:v.value)&&g})}),[y,u,o,null==e?void 0:e.custom,null==p?void 0:p.created_at,null==p?void 0:p.email,null==I?void 0:I.team_size,null==I?void 0:I.roles,null==I?void 0:I.created_at,null==I?void 0:I.plan,null==F||null==(a=F.data)?void 0:a.features]);return{isCustomAttributesLoading:y,loggedInUserCustomAttributes:x,externalUserId:null!=c?c:(0,g.getUserId)()}}(e);(0,s.useEffect)((()=>{v||d(c)}),[d,v,c]);const b=((e,t)=>{const n=(0,s.useRef)(null);return(0,s.useCallback)((()=>{n.current&&clearTimeout(n.current),n.current=setTimeout(e,t)}),[e,t])})((0,s.useCallback)((async()=>{if(!o.current&&0!==a.length){const t=F({contextUpdateQueue:a,currentFeatureFlagsContext:null==i?void 0:i.getContext(),externalUserId:w,passedInFeatureFlagContext:e});o.current=!0;try{await(null==i?void 0:i.identify(t)),r([])}catch(e){throw new Error(`Error occurred while updating feature flags context: ${e}`)}finally{o.current=!1}}}),[a,i,w,e]),n);return(0,s.useEffect)((()=>{b()}),[b]),(0,u.jsx)(p.Provider,{value:{addCustomAttributesUpdateToQueue:d},children:t})},F=({contextUpdateQueue:e,currentFeatureFlagsContext:t,externalUserId:n,passedInFeatureFlagContext:l})=>e.reduce(((e,l)=>{const a=Object.assign({},e.custom,l);return Object.assign({},t,{key:n,custom:a})}),Object.assign({},t,l,{custom:(null==t?void 0:t.custom)||{}})),b={useCamelCaseFlagKeys:!1};function I({children:e,featureFlagsContext:t}){const n=c().LAUNCH_DARKLY_CLIENT_SIDE_ID;return n?(0,u.jsx)(l.LDProvider,{clientSideID:n,context:v(),reactOptions:b,children:(0,u.jsx)(w,{passedInFeatureFlagContext:t,children:e})}):(0,u.jsx)(u.Fragment,{children:e})}},11837:(e,t,n)=>{var l=n(40540),a=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var r=Symbol.for;a=r("react.element"),t.Fragment=r("react.fragment")}var s=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u=Object.prototype.hasOwnProperty,o={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,n){var l,r={},i=null,d=null;for(l in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(d=t.ref),t)u.call(t,l)&&!o.hasOwnProperty(l)&&(r[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===r[l]&&(r[l]=t[l]);return{$$typeof:a,type:e,key:i,ref:d,props:r,_owner:s.current}}t.jsx=i,t.jsxs=i},52322:(e,t,n)=>{e.exports=n(11837)}}]);
//# sourceMappingURL=7204.745279aacd9892c6.js.map