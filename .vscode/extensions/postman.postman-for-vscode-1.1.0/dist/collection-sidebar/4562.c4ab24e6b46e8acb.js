"use strict";(self.webpackChunkcollection_sidebar=self.webpackChunkcollection_sidebar||[]).push([[4562],{24562:(e,t,o)=>{o.d(t,{Z:()=>Ft});var n=o(40540),s=o(77651),i=o(50297),d=o(59530),a=o.n(d),r=o(60398);var l=o(52322);const c=Array.from({length:10}),p=({numLoadingTiles:e=c})=>(0,l.jsx)("div",{className:"sidebar-loading-state_sidebar-loading-state__XG889","data-testid":"sidebar-loading-state",children:e.map(((e,t)=>(0,l.jsx)("div",{className:"sidebar-loading-state_sidebar-loading-state--item__Z1vOR",children:(0,l.jsx)("div",{className:"sidebar-loading-state_sidebar-loading-state__info__qDG37"})},t)))});var u=o(74962),m=o(9460),I=o(80605);const f=e=>{const t=e.illustration||null;return(0,l.jsxs)("div",{className:"sidebar-empty-state_sidebar-empty-state__zGbOy",children:[(0,l.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__illustration__sxdhr",children:t}),(0,l.jsxs)("div",{className:"sidebar-empty-state_sidebar-empty-state__head-and-body__z9GWI",children:[(0,l.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__title__C6Q5t",children:(0,l.jsx)(u.Z,{type:"h4",color:"content-color-secondary",text:e.title})}),(0,l.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__description__771s1",children:(0,l.jsx)(m.ZP,{type:"body-medium",color:"content-color-secondary",children:e.message})})]}),e.action&&(0,l.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__cta__AhqHg",children:(0,l.jsx)(I.Z,{type:"primary",size:"medium",isLoading:e.action.isLoading,text:e.action.label,isDisabled:!e.hasPermissions,tooltip:e.action.tooltip,onClick:()=>{e.action&&e.action.handler&&e.action.handler()}})})]})};var h=o(35736);const g=a().div.withConfig({displayName:"refetch-item__MetaContainer",componentId:"sc-1flourh-0"})(["height:100%;width:100%;display:flex;align-items:center;justify-content:center;font-size:var(--text-size-m);line-height:var(--line-height-m);padding:var(--spacing-xs) 0;color:var(--content-color-tertiary);"]),v=a().button.withConfig({displayName:"refetch-item__RetryButton",componentId:"sc-1flourh-1"})(["all:unset;color:var(--content-color-brand);cursor:pointer;display:inline-block;margin-left:var(--spacing-xs);"]),y=a().div.withConfig({displayName:"refetch-item__SpinnerWrapper",componentId:"sc-1flourh-2"})(["height:100%;display:flex;align-items:center;justify-content:center;"]);function b({isRefetching:e,onRetry:t}){return e?(0,l.jsx)(g,{children:(0,l.jsx)(y,{children:(0,l.jsx)(h.Z,{size:"small"})})}):(0,l.jsx)(g,{children:(0,l.jsxs)(m.ZP,{type:"para",children:["Unable to load items.",t&&(0,l.jsx)(v,{onClick:t,children:"Retry"})]})})}var x=o(73599),w=o(53186);const k="New Collection";var C=o(31660),E=o.n(C),N=o(494),S=o(98283),_=o(69356),j=o.n(_),q=o(22833),L=o.n(q),R=o(81397),F=o(39245);const T=a()(F.Link).withConfig({displayName:"styled__LinkContainer",componentId:"sc-1oxhokt-0"})(["display:flex;flex:1 1 0%;overflow:hidden;align-items:center;height:100%;width:100%;color:var(--content-color-primary);&:hover{color:var(--content-color-primary);}"]),D=a().span.withConfig({displayName:"styled__IconWithSpacing",componentId:"sc-1oxhokt-1"})(["flex:0;display:flex;justify-content:flex-end;align-items:center;margin-right:var(--spacing-s,8px);height:var(--size-xs,16px);min-width:32px;font-size:9px;"]);var O=o(58560),$=o(56415),P=o(3341);const A=a().div.withConfig({displayName:"left-meta-component__IconContainer",componentId:"sc-1nbtm5g-0"})(["margin-right:var(--spacing-s,4px);display:flex;justify-content:center;align-items:center;&:hover{background-color:var(--highlight-background-color-tertiary);}"]),Z=a().div.withConfig({displayName:"left-meta-component__SpacingDiv",componentId:"sc-1nbtm5g-1"})(["width:16px;"]),M=e=>(0,l.jsxs)(O.Z,{direction:"row",height:"100%",alignItems:"center",children:[e.expandEnabled?(0,l.jsx)(A,{"data-testid":`generic-sidebar-item-toggle-button--${e.itemIdentifier}`,onClick:t=>{t.preventDefault(),t.stopPropagation(),e.onItemToggle&&e.onItemToggle()},children:e.isItemOpen?(0,l.jsx)($.Z,{}):(0,l.jsx)(P.Z,{})}):(0,l.jsx)(Z,{}),e.icon&&(0,l.jsx)(O.Z,{basis:28,grow:0,shrink:0,alignItems:"center",justifyContent:"flex-end",children:(0,l.jsx)(D,{children:e.icon})})]});var U=o(17282),z=o(64691),B=o(48263),V=o(59824),W=o(29225);const X=a().div.withConfig({displayName:"action-menu__ActionMenuContainer",componentId:"sc-kv88mk-0"})(["margin-left:var(--spacing-xs);"]),J=e=>{return e.actions.length>0?(0,l.jsx)(X,{children:(0,l.jsxs)(z.Z,{isOpen:e.isActionMenuOpen,closeMenu:()=>{e.onActionMenuClose&&e.onActionMenuClose()},children:[(0,l.jsx)(B.Z,{onClick:()=>{e.onMenuButtonClick&&e.onMenuButtonClick()},children:(0,l.jsx)(I.Z,{"data-testid":"action-menu-button",icon:(0,l.jsx)(W.Z,{}),type:"tertiary"})}),(0,l.jsx)(V.Z,{placement:"bottom-end",children:(t=e.actions,t.map((e=>(0,l.jsx)(U.Z,{isDisabled:!e.isEnabled,type:e.isDestructive?"destructive":"default",onClick:()=>{e.onClick&&e.onClick()},children:e.label},e.type))))})]})}):null;var t},G=e=>e.icons?(0,l.jsx)(O.Z,{alignItems:"center",gap:"spacing-xs",children:e.icons}):null;var Q=o(7246);const K=a().div.withConfig({displayName:"item__SidebarItemWrapper",componentId:"sc-vwge49-0"})(["overflow:hidden;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;width:100%;"]),H=(0,i.observer)((e=>{const{toggleItem:t,route:o,expandable:s,icon:i,isExpanded:d,name:a,actions:r=[],isEditing:c,clearEditing:p,onRenameSubmit:u,metaIcons:m}=e,[I,f]=(0,n.useState)(!1),[h,g]=(0,n.useState)(!1),[v,y]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{y(h||I)}),[I,h]),(0,l.jsxs)(K,{onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onContextMenu:e=>{e.stopPropagation(),g(!0)},children:[(0,l.jsxs)(T,{to:o,customNavEvent:F.OPEN_EXTENSION_URL,"customNavEvent-updateURL":!0,children:[(0,l.jsx)(M,{expandEnabled:s,icon:i,itemIdentifier:a,isItemOpen:d,onItemToggle:()=>t&&t()}),(0,l.jsx)(R.Z,{content:a,children:(0,l.jsx)(Q.InlineEditor,{onSubmit:e=>{u&&u(e)},isEditMode:c,setIsEditMode:e=>{e||p&&p()},value:a})}),(0,l.jsx)(G,{icons:m})]}),v&&(0,l.jsx)(J,{actions:r,isActionMenuOpen:h,onMenuButtonClick:()=>g(!h),onActionMenuClose:()=>{g(!1)}})]})})),Y="rename",ee="delete",te="duplicate",oe="add-request",ne="add-folder";function se(e,t){var o;const s=(0,n.useCallback)((e=>e.data.find((e=>e.id===t))),[t]),{data:i}=(0,w.useCollectionListRawQuery)({workspaceId:e,select:s});if(null!=i&&null!=(o=i.attributes)&&o.permissions){var d;const e=null==i||null==(d=i.attributes)?void 0:d.permissions;return{userCanEdit:e.userCanUpdate,userCanDelete:e.userCanDelete}}return{userCanEdit:!1,userCanDelete:!1}}var ie=o(26246),de=o(19578),ae=o(78476);class re{constructor(){this.filterText="",this.openNodeIds=ae.observable.map({}),this.visibleNodeIds=ae.observable.map({}),this.isVisibilityFilterActive=void 0,this.selectedNodeId=void 0,this.selectionData=void 0,this.renamingNodeId=void 0,this.treeData=void 0,this.itemCreationLoadingItems={collection:{},folder:{},request:{},response:{}},this.clearRename=()=>{this.renamingNodeId=void 0},this.setRenamingNode=e=>{this.renamingNodeId=e},this.toggleItemExpansion=e=>{this.openNodeIds.has(e)?this.openNodeIds.delete(e):this.openNodeIds.set(e,!0)},this.setItemExpanded=e=>{this.openNodeIds.set(e,!0)},this.setFilterText=e=>{this.filterText=e,this.updateNodesOnFilterChange()},this.updateNodesOnFilterChange=()=>{(0,ae.runInAction)((()=>{if(this.filterText||(this.isVisibilityFilterActive=!1,this.visibleNodeIds.clear(),this.openNodeIds.clear()),this.treeData&&this.filterText){const e=function(e,t,o=[]){const n=[];for(const s of e)n.push(...le(s,t,o));return n}(this.treeData,this.filterText.toLowerCase());this.isVisibilityFilterActive=!0,this.visibleNodeIds.clear(),this.openNodeIds.clear();for(const t of e){this.visibleNodeIds.set(t.id,!0);for(const e of t.parentIds)this.visibleNodeIds.set(e,!0),this.openNodeIds.set(e,!0);for(const e of t.childIds)this.visibleNodeIds.set(e,!0)}}}))},this.setSelected=(e,t)=>{if(this.selectedNodeId=e,this.treeData&&this.selectedNodeId){const e=ce(this.treeData,this.selectedNodeId);if(e)for(const t of e)this.openNodeIds.set(t,!0)}e&&t&&this.openNodeIds.set(e,!0)},this.addItemCreationLoadingState=(e,t)=>{this.itemCreationLoadingItems[e][t.parent]||(this.itemCreationLoadingItems[e][t.parent]={after:{},end:new Set}),t.after?(t.after&&!this.itemCreationLoadingItems[e][t.parent].after[t.after]&&(this.itemCreationLoadingItems[e][t.parent].after[t.after]=new Set),t.after&&this.itemCreationLoadingItems[e][t.parent].after[t.after].add(t.id)):this.itemCreationLoadingItems[e][t.parent].end.add(t.id)},(0,ae.makeObservable)(this,{filterText:ae.observable,isVisibilityFilterActive:ae.observable,selectedNodeId:ae.observable,renamingNodeId:ae.observable,itemCreationLoadingItems:ae.observable,toggleItemExpansion:ae.action,setSelected:ae.action,addItemCreationLoadingState:ae.action,removeItemCreationLoadingState:ae.action,setItemExpanded:ae.action,clearRename:ae.action,setRenamingNode:ae.action,setFilterText:ae.action}),this.updateNodesOnFilterChange=function(e,t){let o;return function(...t){clearTimeout(o),o=setTimeout((()=>{e(...t)}),250)}}(this.updateNodesOnFilterChange)}setTreeData(e){this.treeData=e}removeItemCreationLoadingState(e,t){var o,n;t.after&&(null==(n=this.itemCreationLoadingItems[e][t.parent])||null==(n=n.after)||null==(n=n[t.after])||n.delete(t.id)),null==(o=this.itemCreationLoadingItems[e][t.parent])||o.end.delete(t.id)}}function le(e,t,o=[]){var n;const s=[];if(null!=(n=e.name)&&n.toLowerCase().includes(t)){const t={id:e.id,parentIds:[...o],childIds:e.children.map((e=>e.id))};s.push(t)}for(const n of e.children){const i=[...o,e.id];s.push(...le(n,t,i))}return s}function ce(e,t,o=[]){for(const n of e){if(n.id===t)return o;if(n.children){const e=[...o,n.id],s=ce(n.children,t,e);if(s)return s}}return null}const pe=(0,n.createContext)(new re);function ue(e){const t=(0,n.useRef)(new re),o=!!e.collectionTrees;return(0,n.useEffect)((()=>{e.collectionTrees&&t.current.setTreeData(e.collectionTrees)}),[e.collectionTrees,t]),(0,n.useEffect)((()=>{t.current.setSelected(e.selectedItemId,e.expandSelected)}),[e.selectedItemId,e.expandSelected,o,t.current.setSelected]),(0,l.jsx)(pe.Provider,{value:t.current,children:e.children})}function me(){const e=(0,n.useContext)(pe);if(!e)throw new Error("useSidebarListUIState should only be used inside CollectionListUIStateProvider");return e}function Ie(e){const t=me(),o=(0,n.useCallback)(((o,n,s)=>{t.addItemCreationLoadingState(e,{id:o,parent:n,after:s})}),[e,t]),s=(0,n.useCallback)(((o,n,s)=>{t.removeItemCreationLoadingState(e,{id:o,parent:n,after:s})}),[e,t]);return{itemCreationLoadingItems:t.itemCreationLoadingItems[e],addItem:o,removeItem:s}}function fe(){return me().setItemExpanded}function he(){const e=me();return{clearRename:e.clearRename,renamingNodeId:e.renamingNodeId,setRenamingNode:e.setRenamingNode}}var ge=o(56880);function ve(e){const t=me(),o=t.openNodeIds.has(e);return(0,n.useCallback)((()=>t.toggleItemExpansion(e)),[e,o,t])}var ye=o(37691);const be=a().div.withConfig({displayName:"fork-label__ForkLabelWrapper",componentId:"sc-1yreyox-0"})(["display:flex;align-items:center;overflow:hidden;"]),xe=a().p.withConfig({displayName:"fork-label__LabelContainer",componentId:"sc-1yreyox-1"})(["display:inline-block;white-space:nowrap;overflow:hidden;max-width:120px;margin-left:var(--spacing-xs);font-size:var(--text-size-s);font-weight:var(--text-weight-regular);text-overflow:ellipsis;color:var(--content-color-tertiary);"]),we=({label:e})=>(0,l.jsxs)(be,{children:[(0,l.jsx)(ye.Z,{color:"content-color-tertiary",size:"small"}),(0,l.jsx)(xe,{children:e})]});var ke=o(83729);const Ce=()=>(0,l.jsx)("div",{"data-testid":"collection-lock-icon",children:(0,l.jsx)(ke.Z,{})}),Ee=(0,i.observer)((e=>{var t;const{item:o,actions:i,permissions:d}=function(e,t){const{userCanEdit:o,userCanDelete:i}=se(e,t),{userCanRunCollection:d}=(0,w.useWorkspacePermissions)(e),{addToast:a}=(0,s.ZP)(),{setRenamingNode:l,clearRename:c}=he(),{addItem:p,removeItem:u}=Ie("collection"),m=ie.Modals.getModals(),I=(0,de.getTabManager)(),f=(0,F.useNavigate)(),{addItem:h,removeItem:g}=Ie("request"),{addItem:v,removeItem:y}=Ie("folder"),b=fe(),x=(0,w.useDeleteCollection)(),k=(0,w.useDuplicateCollection)(),C=(0,w.useCreateRequest)(),E=(0,w.useCreateNewFolder)(),N=(0,n.useCallback)((e=>e.data.find((e=>e.id===t))),[t]),{data:S}=(0,w.useCollectionListRawQuery)({workspaceId:e,select:N});return{item:S,actions:[{type:oe,label:"Add Request",isEnabled:o,onClick:()=>{const o=(0,r.v4)();h(o,t),b(t),C.mutate({workspaceId:e,collectionId:t,parentFolderIds:[],request:{id:o,name:"New request",method:"GET",url:"",events:[],auth:null,collection:t,responses:[],responses_order:[]}},{onSuccess:({data:t})=>{f(`/workspace/${e}/request/${t.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"http-request",action:"create",label:"sidebar",value:1})},onSettled:()=>{g(o,t)},onError:()=>{a({status:"error",description:"Could not create request."})}})}},{type:ne,label:"Add Folder",isEnabled:o,onClick:()=>{const o=(0,r.v4)();v(o,t),b(t),E.mutate({workspaceId:e,collectionId:t,parentFolderIds:[],requestBody:{id:o,name:"New folder",collection:t}},{onSuccess:({data:t})=>{f(`/workspace/${e}/folder/${t.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"http-folder",action:"create",label:"sidebar",value:1})},onSettled:()=>{y(o,t)},onError:()=>{a({status:"error",description:"Could not create folder."})}})}},{type:"run-collection",label:"Run Collection",isEnabled:d,onClick:()=>{f(`/workspace/${e}/run/create?collection=${t}&type=manual-run`,{},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"collectionrun",action:"open_run_create",label:"collection_sidebar",entityType:"collection",entityId:t})}},{type:"view-documentation",label:"View Documentation",isEnabled:!0,onClick:()=>{f(`/workspace/${e}/documentation/${t}`,{},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"documentation",action:"view_documentation",label:"collection_sidebar",entityType:"collection",entityId:t})}},{type:Y,label:"Rename",isEnabled:o,onClick:()=>{c(),l(t)}},{type:te,label:"Duplicate",isEnabled:o,onClick:()=>{const o=(0,r.v4)();p(o,e,t),k.mutate({workspaceId:e,collectionId:t},{onError:()=>{a({status:"error",description:"Could not duplicated collection."})},onSettled:()=>{u(o,e,t)},onSuccess:({data:t})=>{f(`/workspace/${e}/collection/${(0,w.composeUID)(t.id,t.owner)}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL})}})}},{type:ee,label:"Delete",isEnabled:i,isDestructive:!0,onClick:async()=>{var o;const n=await m.showWarningDialog({uid:"collections-sidebar-delete-collection",subject:null!=S&&null!=(o=S.attributes.fork)&&o.forkLabel?"Delete this forked collection?":`Delete "${null==S?void 0:S.name}"?`,message:"This will delete the monitors, scheduled runs and integrations and deactivate the mock servers associated with this collection.",options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Delete",isPrimary:!0}]});n&&"Delete"===n.title&&x.mutate({workspaceId:e,collectionId:t,onSuccess:()=>{I.closeTabByRoute(`/workspace/${e}/collection/${t}`)}},{onError:()=>{a({status:"error",description:"Could not delete collection."})}})}}],permissions:{userCanEdit:o,userCanDelete:i}}}(e.workspaceId,e.collectionId),[a,c]=(0,n.useState)(!1),p=ve(e.collectionId),{clearRename:u,renamingNodeId:m}=he(),I=(0,w.useUpdateUpdateCollectionInList)();if((0,n.useEffect)((()=>{o&&o.id===m?c(!0):c(!1)}),[m,o]),!o)return null;const f=[];return null!=(t=o.attributes.fork)&&t.forkLabel&&f.push((0,l.jsx)(we,{label:o.attributes.fork.forkLabel})),d.userCanEdit||f.push((0,l.jsx)(Ce,{})),(0,l.jsx)(H,{name:o.name,expandable:!0,isExpanded:!!e.isExpanded,route:`/workspace/${e.workspaceId}/collection/${e.collectionId}`,actions:i,toggleItem:p,isEditing:a,clearEditing:u,onRenameSubmit:t=>{u(),t!==o.name&&I.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,patch:{id:e.collectionId,name:t}})},metaIcons:f})}));var Ne=o(35547);function Se(e,t,o){const n=t[0],s=t.slice(1);if(!n)return;const i=o.find((e=>e.id===n));return i?s.length>0?Se(e,s,i.folders):i.folders.find((t=>t.id===e)):void 0}function _e(e){const{userCanEdit:t,userCanDelete:o}=se(e.workspaceId,e.collectionId),{userCanRunCollection:i}=(0,w.useWorkspacePermissions)(e.workspaceId),{addItem:d,removeItem:a}=Ie("request"),{addToast:l}=(0,s.ZP)(),c=(0,F.useNavigate)(),{addItem:p,removeItem:u}=Ie("folder"),m=(0,w.useCreateRequest)(),I=(0,w.useCreateNewFolder)(),f=fe(),h=(_=e.collectionId,(j=e.parentFolderIds)&&j.length>0?{model:"folder",id:j.at(-1)}:{model:"collection",id:_}),{addItem:g,removeItem:v}=Ie("folder"),{setRenamingNode:y,clearRename:b}=he(),x=ie.Modals.getModals(),k=(0,de.getTabManager)(),C=(0,w.useDeleteFolder)(),E=(0,w.useDuplicateFolder)(),N=(0,n.useCallback)((t=>{const o=t.data.find((t=>t.id===e.collectionId));if(o)return e.parentFolderIds?Se(e.folderId,e.parentFolderIds,o.folders):o.folders.find((t=>t.id===e.folderId))}),[e.collectionId,e.parentFolderIds,e.folderId]),{data:S}=(0,w.useCollectionListRawQuery)({workspaceId:e.workspaceId,select:N});var _,j;return{item:S,actions:[{type:oe,label:"Add Request",isEnabled:t,onClick:()=>{const t=(0,r.v4)();d(t,e.folderId),f(e.folderId),m.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds?[...e.parentFolderIds,e.folderId]:[e.folderId],request:{id:t,name:"New request",method:"GET",url:"",events:[],auth:null,collection:e.collectionId,folder:e.folderId,responses:[],responses_order:[]}},{onSuccess:({data:t})=>{c(`/workspace/${e.workspaceId}/request/${t.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"http-request",action:"create",label:"sidebar",value:1})},onSettled:()=>{a(t,e.folderId)},onError:()=>{l({status:"error",description:"Could not create request."})}})}},{type:ne,label:"Add Folder",isEnabled:t,onClick:()=>{const t=(0,r.v4)();p(t,e.folderId),f(e.folderId),I.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds?[...e.parentFolderIds,e.folderId]:[e.folderId],requestBody:{id:t,name:"New folder",folder:e.folderId,collection:e.collectionId}},{onSuccess:({data:t})=>{c(`/workspace/${e.workspaceId}/folder/${t.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"http-folder",action:"create",label:"sidebar",value:1})},onSettled:()=>{u(t,e.folderId)},onError:()=>{l({status:"error",description:"Could not create folder."})}})}},{type:"run-folder",label:"Run Folder",isEnabled:i,onClick:()=>{c(`/workspace/${e.workspaceId}/run/create?folder=${e.folderId}&collection=${e.collectionId}&type=manual-run`,{},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"collectionrun",action:"open_run_create",label:"folder_sidebar",entityType:"folder",entityId:e.folderId})}},{type:Y,label:"Rename",isEnabled:t,onClick:()=>{b(),y(e.folderId)}},{type:te,label:"Duplicate",isEnabled:t,onClick:()=>{const t=(0,r.v4)();g(t,h.id,e.folderId),E.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds||[],requestBody:{ids:[e.folderId],target:h,location:{position:"after",model:"folder",id:e.folderId},mode:"copy"}},{onError:()=>{l({status:"error",description:"Could not duplicate folder."})},onSuccess:({data:t})=>{c(`/workspace/${e.workspaceId}/folder/${t.ids[0]}`,{},{customNavEvent:F.OPEN_EXTENSION_URL})},onSettled:()=>{v(t,h.id,e.folderId)}})}},{type:ee,label:"Delete",isEnabled:o,isDestructive:!0,onClick:async()=>{const t=await x.showWarningDialog({uid:"collections-sidebar-delete-folder",subject:`DELETE ${null==S?void 0:S.name}?`,message:`Are you sure you want to delete ${null==S?void 0:S.name}?`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Delete",isPrimary:!0}]});t&&"Delete"===t.title&&C.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds||[],folderId:e.folderId,onSuccess:()=>{k.closeTabByRoute(`/workspace/${e.workspaceId}/folder/${e.folderId}`)}},{onError:()=>{l({status:"error",description:"Could not delete folder."})}})}}]}}const je=(0,i.observer)((e=>{const{item:t,actions:o}=_e({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds,folderId:e.folderId}),[s,i]=(0,n.useState)(!1),d=ve(e.folderId),{clearRename:a,renamingNodeId:r}=he(),c=(0,w.useUpdateFolderInList)();return(0,n.useEffect)((()=>{t&&t.id===r?i(!0):i(!1)}),[r,t]),t?(0,l.jsx)(H,{name:t.name,expandable:!0,isExpanded:!!e.isExpanded,route:`/workspace/${e.workspaceId}/folder/${e.folderId}`,icon:(0,l.jsx)(Ne.Z,{}),isEditing:s,clearEditing:a,onRenameSubmit:o=>{a(),o!==t.name&&c.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,folderId:e.folderId,parentFolderIds:e.parentFolderIds||[],patch:{id:e.folderId,name:o}})},actions:o,toggleItem:d}):null}));function qe(e,t,o){const n=t[0],s=t.slice(1);if(!n)return;const i=o.find((e=>e.id===n));return i?s.length>0?qe(e,s,i.folders):i.requests.find((t=>t.id===e)):void 0}function Le(e){const{userCanEdit:t,userCanDelete:o}=se(e.workspaceId,e.collectionId),{setRenamingNode:i,clearRename:d}=he(),{addItem:a,removeItem:l}=Ie("request"),{addItem:c,removeItem:p}=Ie("response"),u=ie.Modals.getModals(),m=(0,de.getTabManager)(),{addToast:I}=(0,s.ZP)(),f=(0,F.useNavigate)(),h=fe(),g=(C=e.collectionId,(E=e.parentFolderIds)&&E.length>0?{model:"folder",id:E.at(-1)}:{model:"collection",id:C}),v=(0,w.useDeleteRequest)(),y=(0,w.useDuplicateRequest)(),b=(0,w.useCreateResponse)(),x=(0,n.useCallback)((t=>{const o=t.data.find((t=>t.id===e.collectionId));if(o)return e.parentFolderIds?qe(e.requestId,e.parentFolderIds,o.folders):o.requests.find((t=>t.id===e.requestId))}),[e.collectionId,e.parentFolderIds,e.requestId]),{data:k}=(0,w.useCollectionListRawQuery)({workspaceId:e.workspaceId,select:x});var C,E;return{item:k,actions:[{type:"add-example",label:"Add Example",isEnabled:t,onClick:()=>{const t=(0,r.v4)();c(t,e.requestId),h(e.requestId),k&&b.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds,requestId:e.requestId,name:null==k?void 0:k.name},{onSuccess:({data:t})=>{f(`/workspace/${e.workspaceId}/example/${t.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"http-example",action:"create",label:"sidebar",value:1})},onSettled:()=>{p(t,e.requestId)},onError:()=>{I({status:"error",description:"Could not create example."})}})}},{type:Y,label:"Rename",isEnabled:t,onClick:()=>{d(),i(e.requestId)}},{type:te,label:"Duplicate",isEnabled:t,onClick:()=>{const t=(0,r.v4)();a(t,g.id,e.requestId),y.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds||[],requestBody:{ids:[e.requestId],target:g,location:{position:"after",model:"request",id:e.requestId},mode:"copy"}},{onError:()=>{I({status:"error",description:"Could not duplicate request."})},onSuccess:({data:t})=>{f(`/workspace/${e.workspaceId}/request/${t.ids[0]}`,{},{customNavEvent:F.OPEN_EXTENSION_URL})},onSettled:()=>{l(t,g.id,e.requestId)}})}},{type:ee,label:"Delete",isEnabled:o,isDestructive:!0,onClick:async()=>{const t=await u.showWarningDialog({uid:"collections-sidebar-delete-request",subject:`DELETE ${null==k?void 0:k.name}?`,message:`Are you sure you want to delete ${null==k?void 0:k.name}?`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Delete",isPrimary:!0}]});t&&"Delete"===t.title&&v.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds||[],requestId:e.requestId,onSuccess:()=>{m.closeTabByRoute(`/workspace/${e.workspaceId}/request/${e.requestId}`)}},{onError:()=>{I({status:"error",description:"Could not delete request."})}})}}]}}const Re={PROPFIND:"PROP",DELETE:"DEL",OPTIONS:"OPT",UNLINK:"UNLNK",UNLOCK:"UNLCK"},Fe=e=>e?Re[e]||e.slice(0,5):null,Te=a().div.withConfig({displayName:"icon__Container",componentId:"sc-dpfx06-0"})(["font-family:var(--text-family-code);font-weight:450;font-size:8px;line-height:15px;color:",";"],(({method:e})=>{switch(e){case"GET":return"var(--base-color-success, #0CBB52)";case"PUT":return"var(--base-color-info, #097BED)";case"POST":return"var(--base-color-warning, #FFB400)";case"DELETE":return"var(--base-color-error, #EB2013)";default:return"var(--content-color-primary, #212121)"}}));function De(e){const t=e.method.toUpperCase();return(0,l.jsx)(Te,{method:t,children:(0,l.jsx)("div",{children:Fe(t)})})}const Oe=(0,i.observer)((e=>{const{item:t,actions:o}=Le({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds,requestId:e.requestId}),[s,i]=(0,n.useState)(!1),d=ve(e.requestId),{clearRename:a,renamingNodeId:r}=he(),c=(0,w.useUpdateRequestInList)();return(0,n.useEffect)((()=>{t&&t.id===r?i(!0):i(!1)}),[r,t]),t?(0,l.jsx)(H,{name:t.name,expandable:t.responses_order.length>0,isExpanded:!!e.isExpanded,route:`/workspace/${e.workspaceId}/request/${e.requestId}`,icon:(0,l.jsx)(De,{method:t.method}),actions:o,isEditing:s,clearEditing:a,onRenameSubmit:o=>{a(),o!==t.name&&c.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,requestId:e.requestId,parentFolderIds:e.parentFolderIds||[],patch:{id:e.requestId,name:o}})},toggleItem:d}):null})),$e=a().div.withConfig({displayName:"loading-item__Loading",componentId:"sc-6h2cd9-0"})(["padding-left:var(--spacing-xxl);display:flex;width:100%;animation:fade 1s ease-in-out infinite;"]),Pe=a().div.withConfig({displayName:"loading-item__IconLoadingBlock",componentId:"sc-6h2cd9-1"})(["height:var(--size-xs);width:var(--size-xs);background-color:var(--highlight-background-color-secondary);"]),Ae=a().div.withConfig({displayName:"loading-item__NameLoadingBlock",componentId:"sc-6h2cd9-2"})(["margin-left:var(--spacing-s);height:var(--size-xs);background-color:var(--highlight-background-color-secondary);width:100px;"]);function Ze(){return(0,l.jsxs)($e,{children:[(0,l.jsx)(Pe,{}),(0,l.jsx)(Ae,{})]})}const Me=a().div.withConfig({displayName:"collection-empty-item__EmptyWraper",componentId:"sc-1jnf69k-0"})(["padding-left:var(--spacing-xxl);display:flex;width:100%;flex-direction:column;"]);function Ue(e){const t=(0,F.useNavigate)(),{addItem:o,removeItem:n}=Ie("request"),{userCanEdit:i}=se(e.workspaceId,e.collectionId),d=fe(),{addToast:a}=(0,s.ZP)(),c=(0,w.useCreateRequest)();return(0,l.jsxs)(Me,{children:[(0,l.jsx)(m.ZP,{color:"content-color-secondary",type:"body-medium",children:"This collection is empty"}),i&&(0,l.jsxs)(m.ZP,{color:"content-color-secondary",type:"body-medium",children:[(0,l.jsx)(I.Z,{onClick:()=>{(()=>{const s=(0,r.v4)();o(s,e.collectionId),d(e.collectionId),c.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:[],request:{id:s,name:"New request",method:"GET",url:"",events:[],auth:null,collection:e.collectionId,responses:[],responses_order:[]},onSuccess:({data:o})=>{t(`/workspace/${e.workspaceId}/request/${o.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"http-request",action:"create",label:"sidebar",value:1})},onSettled:()=>{n(s,e.collectionId)},onError:()=>{a({status:"error",description:"Could not create request."})}})})()},type:"plain",text:"Add a request"})," to start working"]})]})}const ze=a().div.withConfig({displayName:"folder-empty-item__EmptyWraper",componentId:"sc-guxea6-0"})(["padding-left:var(--spacing-xxl);display:flex;width:100%;flex-direction:column;"]);function Be(e){const t=(0,F.useNavigate)(),{addItem:o,removeItem:n}=Ie("request"),{userCanEdit:i}=se(e.workspaceId,e.collectionId),d=fe(),{addToast:a}=(0,s.ZP)(),c=(0,w.useCreateRequest)();return(0,l.jsxs)(ze,{children:[(0,l.jsx)(m.ZP,{color:"content-color-secondary",type:"body-medium",children:"This folder is empty"}),i&&(0,l.jsxs)(m.ZP,{color:"content-color-secondary",type:"body-medium",children:[(0,l.jsx)(I.Z,{onClick:()=>{(()=>{const s=(0,r.v4)();o(s,e.folderId),d(e.folderId),c.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds,request:{id:s,name:"New request",method:"GET",url:"",events:[],auth:null,collection:e.collectionId,folder:e.folderId,responses:[],responses_order:[]},onSettled:()=>{n(s,e.folderId)},onSuccess:({data:o})=>{t(`/workspace/${e.workspaceId}/request/${o.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL}),ge.AnalyticsService.addEventV2({category:"http-request",action:"create",label:"sidebar",value:1})},onError:()=>{a({status:"error",description:"Could not create request."})}})})()},type:"plain",text:"Add a request"})," to start working"]})]})}var Ve=o(10907);const We=(0,i.observer)((e=>{const{item:t,isLoading:o,actions:i}=function(e){const{userCanEdit:t}=se(e.workspaceId,e.collectionId),{data:o,isLoading:n}=(0,w.useResponseMeta)({responseId:e.responseId}),{addItem:i,removeItem:d}=Ie("response"),{addToast:a}=(0,s.ZP)(),l=(0,w.useDuplicateResponse)(),c=(0,F.useNavigate)(),p=(0,w.useDeleteResponse)(),u=ie.Modals.getModals(),m=(0,de.getTabManager)(),{clearRename:I,setRenamingNode:f}=he(),h=[{type:Y,label:"Rename",isEnabled:t,onClick:()=>{I(),f(e.responseId)}},{type:te,label:"Duplicate",isEnabled:t,onClick:()=>{const t=(0,r.v4)();i(t,e.requestId,e.responseId),l.mutate({collectionId:e.collectionId,parentFolderIds:e.parentFolderIds,requestId:e.requestId,workspaceId:e.workspaceId,responseId:e.responseId},{onError:()=>{a({status:"error",description:"Could not duplicate example."})},onSuccess:({data:t})=>{c(`/workspace/${e.workspaceId}/example/${t.ids[0]}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL})},onSettled:()=>{d(t,e.requestId,e.responseId)}})}},{type:ee,label:"Delete",isEnabled:t,isDestructive:!0,onClick:async()=>{var t,n;const s=await u.showWarningDialog({uid:"collections-sidebar-delete-response",subject:`DELETE ${null==o||null==(t=o.data)?void 0:t.name}?`,message:`Are you sure you want to delete ${null==o||null==(n=o.data)?void 0:n.name}?`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Delete",isPrimary:!0}]});s&&"Delete"===s.title&&p.mutate({workspaceId:e.workspaceId,collectionId:e.collectionId,parentFolderIds:e.parentFolderIds||[],requestId:e.requestId,responseId:e.responseId,onSuccess:()=>{m.closeTabByRoute(`/workspace/${e.workspaceId}/example/${e.responseId}`)}},{onError:()=>{a({status:"error",description:"Could not delete example."})}})}}];return{item:null==o?void 0:o.data,isLoading:n,actions:h}}({responseId:e.responseId,collectionId:e.collectionId,workspaceId:e.workspaceId,parentFolderIds:e.parentFolderIds,requestId:e.requestId}),[d,a]=(0,n.useState)(!1),{clearRename:c,renamingNodeId:p}=he(),u=(0,w.useResponseMetaUpdateMutation)();return(0,n.useEffect)((()=>{t&&t.id===p?a(!0):a(!1)}),[p,t]),o||!t?(0,l.jsx)(Ze,{}):(0,l.jsx)(H,{name:t.name,expandable:!1,isExpanded:!1,route:`/workspace/${e.workspaceId}/example/${e.responseId}`,icon:(0,l.jsx)(Ve.Z,{}),actions:i,clearEditing:c,isEditing:d,onRenameSubmit:o=>{c(),o!==(null==t?void 0:t.name)&&u.mutate({patch:{name:o},responseId:e.responseId})}})})),Xe=(0,i.observer)((e=>{const{item:t}=e;switch(t.type){case"collection":return(0,l.jsx)(Ee,Object.assign({isExpanded:t.isExpanded,isSelected:t.isSelected},t.data));case"folder":return(0,l.jsx)(je,Object.assign({isExpanded:t.isExpanded,isSelected:t.isSelected},t.data));case"request":return(0,l.jsx)(Oe,Object.assign({isExpanded:t.isExpanded,isSelected:t.isSelected},t.data));case"response":return(0,l.jsx)(We,Object.assign({isSelected:t.isSelected},t.data));case"loading":return(0,l.jsx)(Ze,{});case"collection-empty":return(0,l.jsx)(Ue,Object.assign({},t.data));case"folder-empty":return(0,l.jsx)(Be,Object.assign({},t.data));default:return null}})),Je=a().li.withConfig({displayName:"list-item__StyledContainer",componentId:"sc-1esdb42-0"})(["display:flex;height:28px;align-items:center;font-size:var(--text-size-m,12px);flex:1;overflow:hidden;box-sizing:border-box;color:var(--content-color-primary,var(--grey-90));background-color:",";padding:var(--spacing-zero) var(--spacing-s);> *{box-sizing:border-box;}&.action{cursor:pointer;&:hover{background-color:var(--highlight-background-color-secondary);.sidebar-list-item__right-section-actions,.actions-dropdown{.btn{height:var(--size-s);}}}&:has(*:hover),&:has(*:focus){background-color:var(--highlight-background-color-secondary);.sidebar-list-item__right-section-actions,.actions-dropdown{.btn{height:var(--size-s);}}}}"],(({isSelected:e})=>e?"var(--highlight-background-color-secondary)":"inherit")),Ge=e=>{const{item:t,style:o}=e;return(0,l.jsxs)(Je,{className:L()({action:!0}),style:o,role:"treeitem","aria-expanded":t.isExpanded,tabIndex:-1,isSelected:t.isSelected,"aria-selected":t.isSelected,children:[Array.from({length:t.depth}).fill(null).map(((e,t)=>(0,l.jsx)("div",{className:"indent"},`indent-${t}`))),(0,l.jsx)(Xe,{item:t})]})},Qe=["items"],Ke=["style","data"],He=["items"],Ye=["style","data"];function et(e,t){const{style:o,data:{items:n}}=e,s=(0,S.Z)(e.data,Qe),i=(0,S.Z)(e,Ke),{style:d,data:{items:a}}=t,r=(0,S.Z)(t.data,He),l=(0,S.Z)(t,Ye);return j()(o,d)&&j()(n,a)&&j()(s,r)&&j()(i,l)}const tt=(0,n.memo)((({data:e,index:t,style:o})=>{const s=(0,n.useRef)({}),{items:i,resetRowHeights:d}=e,a=i[t];return(0,n.useEffect)((()=>{s.current&&d()}),[s,d]),(0,l.jsx)(Ge,{item:a,style:o},a.id)}),et);tt.displayName="memo(ItemRenderer)";const ot=tt,nt=a().ul.withConfig({displayName:"react-window-list__StyledList",componentId:"sc-phtn6a-0"})(["height:100%;width:100%;margin:0;padding:0;box-sizing:border-box;.indent{flex:0 0 var(--spacing-s);box-sizing:border-box;height:inherit;border-right:thin solid transparent;}&:hover,&:focus{.indent{border-right:thin solid var(--border-color-default);}}"]),st=(0,n.forwardRef)(((e,t)=>(0,l.jsx)(nt,Object.assign({role:"tree",tabIndex:0,ref:t},e,{children:e.children}))));st.displayName="forwardRef(ReactWindowList)";const it=st,dt=a().div.withConfig({displayName:"list-view__Container",componentId:"sc-eu41y6-0"})(["height:100%;padding-top:var(--spacing-s);"]),at=(0,i.observer)((e=>{const{items:t}=e,o=(0,n.useRef)(null),s={items:t,resetRowHeights:()=>{o.current&&o.current.resetAfterIndex(0)}};return(0,l.jsx)(dt,{children:(0,l.jsx)(E(),{children:({height:e,width:t})=>(0,l.jsx)(N.VariableSizeList,{height:e,itemData:s,itemCount:s.items.length,ref:o,itemSize:e=>{return(t=s.items[e]).type&&["collection-empty","folder-empty"].includes(t.type)?58:28;var t},width:t,innerElementType:it,children:ot})})})}));function rt(e,t){const o={};for(const t of e)o[t.id]=t;const n=[];for(const e of t){const t=o[e];t&&n.push(t)}return n}function lt(e,t,o,n){return[{id:e,type:"response",depth:n,isSelected:t.selectedNodeId===e,data:{collectionId:o.collectionId,workspaceId:o.workspaceId,parentFolderIds:o.parentFolderIds,requestId:o.requestId,responseId:e}}]}function ct(e,t,o,n){const s=[];if(t.isVisibilityFilterActive&&!t.visibleNodeIds.has(e.id))return s;if(s.push({id:e.id,type:"request",depth:n,isExpanded:t.openNodeIds.has(e.id),isSelected:t.selectedNodeId===e.id,data:{workspaceId:o.workspaceId,collectionId:o.collectionId,parentFolderIds:o.parentFolderIds,requestId:e.id}}),!t.openNodeIds.has(e.id))return s;for(const d of e.responses_order){s.push(...lt(d,t,{collectionId:o.collectionId,workspaceId:o.workspaceId,parentFolderIds:o.parentFolderIds,requestId:e.id},n+1));for(const o of(null==(i=t.itemCreationLoadingItems.response[e.id])||null==(i=i.after)?void 0:i[d])||new Set){var i;s.push({type:"loading",id:o,depth:n+1,isExpanded:!1,isSelected:!1,data:null})}}for(const o of(null==(d=t.itemCreationLoadingItems.response[e.id])?void 0:d.end)||new Set){var d;s.push({type:"loading",id:o,depth:n+1,isExpanded:!1,isSelected:!1,data:null})}return s}function pt(e,t,o,n){const s=[];if(t.isVisibilityFilterActive&&!t.visibleNodeIds.has(e.id))return s;if(s.push({id:e.id,type:"folder",depth:n,isExpanded:t.openNodeIds.has(e.id),isSelected:t.selectedNodeId===e.id,data:{workspaceId:o.workspaceId,collectionId:o.collectionId,parentFolderIds:o.parentFolderIds,folderId:e.id}}),!t.openNodeIds.has(e.id))return s;const i=rt(e.folders,e.folders_order);for(const a of i){s.push(...pt(a,t,{collectionId:o.collectionId,workspaceId:o.workspaceId,parentFolderIds:o.parentFolderIds?[...o.parentFolderIds,e.id]:[e.id]},n+1));for(const o of(null==(d=t.itemCreationLoadingItems.folder[e.id])||null==(d=d.after)?void 0:d[a.id])||new Set){var d;s.push({type:"loading",id:o,depth:n+1,isExpanded:!1,isSelected:!1,data:null})}}for(const o of(null==(a=t.itemCreationLoadingItems.folder[e.id])?void 0:a.end)||new Set){var a;s.push({type:"loading",id:o,depth:n+1,isExpanded:!1,isSelected:!1,data:null})}const r=rt(e.requests,e.order);for(const i of r){s.push(...ct(i,t,{collectionId:o.collectionId,workspaceId:o.workspaceId,parentFolderIds:o.parentFolderIds?[...o.parentFolderIds,e.id]:[e.id]},n+1));for(const o of(null==(l=t.itemCreationLoadingItems.request[e.id])||null==(l=l.after)?void 0:l[i.id])||new Set){var l;s.push({type:"loading",id:o,depth:n+1,isExpanded:!1,isSelected:!1,data:null})}}for(const o of(null==(c=t.itemCreationLoadingItems.request[e.id])?void 0:c.end)||new Set){var c;s.push({type:"loading",id:o,depth:n+1,isExpanded:!1,isSelected:!1,data:null})}return 1===s.length&&s.push({id:`empty-folder-${e.id}`,type:"folder-empty",depth:n+1,data:{folderId:e.id,collectionId:o.collectionId,workspaceId:o.workspaceId,parentFolderIds:o.parentFolderIds?[...o.parentFolderIds,e.id]:[e.id]},isExpanded:!1}),s}function ut(e,t,o){const n=[];if(t.isVisibilityFilterActive&&!t.visibleNodeIds.has(e.id))return n;if(n.push({id:e.id,type:"collection",depth:0,data:{workspaceId:o,collectionId:e.id},isExpanded:t.openNodeIds.has(e.id),isSelected:t.selectedNodeId===e.id}),!t.openNodeIds.has(e.id))return n;const s=rt(e.folders,e.folders_order);for(const d of s){n.push(...pt(d,t,{collectionId:e.id,workspaceId:o},1));for(const o of(null==(i=t.itemCreationLoadingItems.folder[e.id])||null==(i=i.after)?void 0:i[d.id])||new Set){var i;n.push({type:"loading",id:o,depth:1,isExpanded:!1,isSelected:!1,data:null})}}for(const o of(null==(d=t.itemCreationLoadingItems.folder[e.id])?void 0:d.end)||new Set){var d;n.push({type:"loading",id:o,depth:1,isExpanded:!1,isSelected:!1,data:null})}const a=rt(e.requests,e.order);for(const s of a){n.push(...ct(s,t,{collectionId:e.id,workspaceId:o},1));for(const o of(null==(r=t.itemCreationLoadingItems.request[e.id])||null==(r=r.after)?void 0:r[s.id])||new Set){var r;n.push({type:"loading",id:o,depth:1,isExpanded:!1,isSelected:!1,data:null})}}for(const o of(null==(l=t.itemCreationLoadingItems.request[e.id])?void 0:l.end)||new Set){var l;n.push({type:"loading",id:o,depth:1,isExpanded:!1,isSelected:!1,data:null})}return 1===n.length&&n.push({id:`empty-collection-${e.id}`,type:"collection-empty",depth:1,data:{collectionId:e.id,workspaceId:o},isExpanded:!1}),n}var mt=o(80809);const It="collection-list-loading-paint-time",ft="collection-list-loading-paint-mark",{PerformanceMarkPaint:ht}=mt.perfComponents,gt=()=>{performance.measure(It,{},ft),(0,mt.sendMeasureEvent)({name:It,category:"app-perf",label:"collection-sidebar-loading",entityType:"collection-sidebar"})},vt=a()("div").withConfig({displayName:"collection-sidebar-view__SidebarContainer",componentId:"sc-8tzmso-0"})(["display:flex;flex-direction:column;height:800px;padding-top:var(--spacing-s);"]),yt=(0,i.observer)((e=>{var t,o;const[s,i]=(0,n.useState)(!1),{items:d,queryResult:a}=function(e){const t=(0,w.useCollectionListRawQuery)({workspaceId:e.workspaceId}),o=me();if(!t.data)return{queryResult:t};const n=[];t.data.data.sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase())));for(const i of t.data.data){n.push(...ut(i,o,e.workspaceId));for(const t of(null==(s=o.itemCreationLoadingItems.collection[e.workspaceId])||null==(s=s.after)?void 0:s[i.id])||new Set){var s;n.push({type:"loading",id:t,depth:0,isExpanded:!1,isSelected:!1,data:null})}}for(const t of(null==(i=o.itemCreationLoadingItems.collection[e.workspaceId])?void 0:i.end)||new Set){var i;n.push({type:"loading",id:t,depth:0,isExpanded:!1,isSelected:!1,data:null})}return{items:n,queryResult:t}}({workspaceId:e.workspaceId}),c=Array.isArray(null==(t=a.data)?void 0:t.data)&&0===(null==(o=a.data)?void 0:o.data.length),u=(0,w.useCreateNewCollection)(),m=(0,w.useWorkspacePermissions)(e.workspaceId);return!d&&a.error?(0,l.jsx)(vt,{children:(0,l.jsx)(b,{isRefetching:a.isRefetching,onRetry:a.refetch})}):d?c?(0,l.jsx)(vt,{children:(0,l.jsx)(f,{illustration:(0,l.jsx)(x.Z,{}),title:"Create a collection for your requests",message:"A collection lets you group related requests and easily set common authorization, tests, scripts, and variables for all requests in it.",hasPermissions:m.userCanCreate,action:{label:"Create Collection",tooltip:m.userCanCreate?"":"You do not have permissions to create a collection in this workspace",handler:()=>{i(!0),u.mutate({workspaceId:e.workspaceId,requestBody:{id:(0,r.v4)(),name:k}},{onSettled:()=>{i(!1)},onSuccess:()=>{ge.AnalyticsService.addEventV2({category:"http-collection",action:"create",label:"sidebar",value:1})}})},isLoading:s}})}):(0,l.jsx)(at,{items:d}):(0,l.jsx)(vt,{children:(0,l.jsx)(ht,{markName:ft,callback:gt,children:(0,l.jsx)(p,{})})})}));var bt=o(82420),xt=o(25869),wt=o(17647);const kt=a()(O.Z).withConfig({displayName:"collection-top-bar__CollectionTopBarWrapper",componentId:"sc-8v028h-0"})(["margin-right:var(--spacing-s);margin-left:var(--spacing-s);margin-top:var(--spacing-s);"]),Ct=a()(I.Z).withConfig({displayName:"collection-top-bar__CreateNewButton",componentId:"sc-8v028h-1"})(["margin-right:var(--spacing-xs);width:var(--size-s);padding:0;height:var(--size-s);"]),Et=(0,i.observer)((e=>{const[t,o]=(0,n.useState)(!1),[s,i]=function(){const e=me();return[e.filterText,e.setFilterText]}(),{error:d,isFetching:a,isLoading:c}=(0,w.useCollectionListRawQuery)({workspaceId:e.workspaceId}),{addItem:p,removeItem:u}=Ie("collection"),m=(0,F.useNavigate)(),I=(0,w.useCreateNewCollection)(),f=(0,w.useWorkspacePermissions)(e.workspaceId);return(0,l.jsxs)(kt,{alignItems:"center",justifyContent:"space-between",gap:"spacing-s",children:[(0,l.jsx)(Ct,{icon:(0,l.jsx)(xt.Z,{}),type:"tertiary",tooltip:!f.userCanCreate&&"You do not have permissions to create a collection in this workspace","data-testid":"collection-top-bar-create-button",isDisabled:d||a||c||t||!f.userCanCreate,onClick:()=>{const t=(0,r.v4)();o(!0),p(t,e.workspaceId),I.mutate({workspaceId:e.workspaceId,requestBody:{id:(0,r.v4)(),name:k}},{onSettled:n=>{o(!1),u(t,e.workspaceId),n&&n.data&&m(`/workspace/${e.workspaceId}/collection/${(0,w.composeUID)(n.data.id,n.data.owner)}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:F.OPEN_EXTENSION_URL})},onSuccess:()=>{ge.AnalyticsService.addEventV2({category:"http-collection",action:"create",label:"sidebar",value:1})}})}}),(0,l.jsx)(bt.Z,{onChange:e=>i(e.target.value),value:s,placeholder:"Filter",prefix:(0,l.jsx)(wt.Z,{}),onClear:()=>{i("")},"data-testid":"collection-top-bar-search-input"})]})}));var Nt=o(10099);function St(e){const t=e.responses_order.map((e=>function(e){return{id:e,type:"response",children:[]}}(e)));return{id:e.id,name:e.name,type:"request",children:t}}function _t(e){const t=e.folders.map((e=>_t(e))),o=e.requests.map((e=>St(e)));return{id:e.id,name:e.name,type:"folder",children:[...t,...o]}}function jt(e){const t=e.folders.map((e=>_t(e))),o=e.requests.map((e=>St(e)));return{id:e.id,name:e.name,type:"collection",children:[...t,...o]}}var qt=o(60607);const Lt=(0,i.observer)((()=>{const e=(0,Nt.useActiveWorkspaceId)(),{data:t}=function(e){const t=(0,n.useCallback)((e=>e.data.map((e=>jt(e)))),[]);return(0,w.useCollectionListRawQuery)({workspaceId:e.workspaceId,select:t})}({workspaceId:e}),{selectedItemId:o,selectedItemType:s}=function(){const{collectionId:e,folderId:t,requestId:o,exampleId:n}=(0,qt.useParams)();return e?{selectedItemType:"collection",selectedItemId:e}:t?{selectedItemType:"folder",selectedItemId:t}:o?{selectedItemType:"request",selectedItemId:o}:n?{selectedItemType:"response",selectedItemId:n}:{}}();return(0,w.useCollectionListSubscription)({workspaceId:e}),(0,l.jsxs)(ue,{collectionTrees:t,selectedItemId:o,expandSelected:["collection","folder"].includes(s||""),children:[(0,l.jsx)(Et,{workspaceId:e}),(0,l.jsx)(yt,{workspaceId:e})]})})),Rt=a().div.withConfig({displayName:"collection-sidebar__Wrapper",componentId:"sc-ff16lm-0"})(["height:100%;display:flex;flex-direction:column;"]),Ft=()=>w.ENABLE_COLLECTIONS?(0,l.jsx)(s.VW,{children:(0,l.jsxs)(Rt,{children:[(0,l.jsx)(Lt,{}),(0,l.jsx)(ie.Modals.Ui.ModalDialog,{uid:"collections-sidebar-delete-collection"}),(0,l.jsx)(ie.Modals.Ui.ModalDialog,{uid:"collections-sidebar-delete-folder"}),(0,l.jsx)(ie.Modals.Ui.ModalDialog,{uid:"collections-sidebar-delete-request"}),(0,l.jsx)(ie.Modals.Ui.ModalDialog,{uid:"collections-sidebar-delete-response"})]})}):null}}]);
//# sourceMappingURL=4562.c4ab24e6b46e8acb.js.map