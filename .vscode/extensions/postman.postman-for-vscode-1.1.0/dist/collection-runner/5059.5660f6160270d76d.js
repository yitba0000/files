"use strict";(self.webpackChunkcollection_runner=self.webpackChunkcollection_runner||[]).push([[5059,7560,2389,3331],{7560:(e,n,o)=>{function t(){return t=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},t.apply(this,arguments)}o.d(n,{Z:()=>t})},15059:(e,n,o)=>{o.r(n),o.d(n,{COLLECTION_RUNS_LIST_PREFIX:()=>u,COLLECTION_RUN_PREFIX:()=>l,collectionRunByIdQuery:()=>p,collectionRunsListQuery:()=>d,deleteCollectionRun:()=>y,fetchCollectionRunById:()=>I,findCollectionRuns:()=>a,getQueryKey:()=>i,importCollectionRun:()=>w,removeCollectionRunFromListCache:()=>k,useCollectionRunById:()=>g,useCollectionRuns:()=>R,useDeleteCollectionRun:()=>T,useDeleteRuns:()=>E});var t=o(7560),r=o(45860),s=o(26663),c=o.n(s);const a=async e=>{const{signal:n,workspaceId:o,collectionId:s,populateIterations:a,count:u,status:l,owner:i,source:d,since_id:I,max_id:p}=e;return await r.postmanGateway.get({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun`,query:(0,t.Z)({workspace:o},s&&{collection:s},{iterations:a||!1,count:u},l&&{status:l},i&&{owner:i},d&&{source:d},{since_id:I||0},p&&{max_id:p}),signal:n})},u="collection-runs-list",l="collection-run",i=e=>{const n=[u];for(const o of Object.values(e))o&&n.push(o);return n},d=({signal:e,workspaceId:n,collectionId:o,populateIterations:t=!1,count:r,status:s,owner:c,source:u,since_id:l=0,max_id:d=0})=>({queryKey:i({workspaceId:n,collectionId:o}),queryFn:()=>a({signal:e,workspaceId:n,collectionId:o,populateIterations:t,count:r,status:s,owner:c,source:u,since_id:l,max_id:d}),enabled:!!n,useErrorBoundary:!1}),I=async({signal:e,runId:n})=>await r.postmanGateway.get({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/${n}`,signal:e}),p=({signal:e,runId:n})=>({queryKey:[l,n],queryFn:()=>I({signal:e,runId:n}),enabled:!!n,useErrorBoundary:!1}),w=async({signal:e,owner:n,workspace:o,runDetails:t})=>await r.postmanGateway.post({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/import`,query:{owner:n,workspace:o},body:JSON.stringify(t),signal:e}),y=async({runId:e,userId:n,signal:o})=>await r.postmanGateway.delete({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/${e}`,query:{owner:n},signal:o});var _=o(97201);const R=({workspaceId:e,collectionId:n,count:o,status:t,source:r,owner:s})=>(0,_.useDataFetch)(d({workspaceId:e,collectionId:n,count:o,status:t,source:r,owner:s})),g=e=>(0,_.useDataFetch)(p({runId:e})),k=(e,n,o)=>{e&&(0,_.updateCache)({key:i({workspaceId:n,collectionId:null!=o?o:""}),updater:n=>n?n.filter((n=>n.model_id!==e)):n})},T=()=>(0,_.useMutation)({mutationFn:e=>y({runId:e.runId,userId:e.userId,signal:e.signal}),onSuccess:(e,n)=>{k(n.runId,n.workspaceId,n.collectionId),n.onSuccess&&n.onSuccess(e)},onError:(e,n)=>{n.onError&&n.onError(e)}});var m=o(53186),C=o(10099);const E=(e,n)=>{const o=(0,C.useActiveWorkspaceId)(),{userCanDeleteHistory:t}=(0,m.useWorkspacePermissions)(o),r=T(),{data:s}=R({workspaceId:o,count:e});return{deleteRuns:e=>{if(!t||!s)return;const c=s.map((e=>r.mutateAsync({runId:e.data.id,userId:e.data.owner,workspaceId:o,collectionId:n})));Promise.all(c).catch((n=>{e&&e(n)}))}}}}}]);
//# sourceMappingURL=5059.5660f6160270d76d.js.map