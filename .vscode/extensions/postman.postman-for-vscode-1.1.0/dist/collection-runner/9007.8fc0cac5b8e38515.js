"use strict";(self.webpackChunkcollection_runner=self.webpackChunkcollection_runner||[]).push([[9007],{83709:(e,t,n)=>{n.r(t);var r=n(40540),o=n.n(r),s=n(21730),a=n(60607),i=n(6928),l=n(7560),c=n(59530),d=n.n(c),u=n(58560),p=n(9460),m=n(23468),h=n(47838),g=n(35736),x=n(49437),y=n(80429),j=n(22135),f=n(19832),b=n(77986),v=n(81397),w=n(90608),I=n(47503),C=n(52322);const Z=({status:e})=>{switch(e){case"aborted":return(0,C.jsx)(v.Z,{content:"Run aborted",openDelay:250,children:(0,C.jsx)(w.Z,{color:"content-color-secondary"})});case"error":return(0,C.jsx)(v.Z,{content:"Error running some requests",openDelay:250,children:(0,C.jsx)(I.Z,{color:"base-color-error"})});default:return null}};var _=n(53752),k=n(74962),R=n(39245);const S={start_time:{header:"Start time",tooltip:{aborted:"Run aborted",error:"Error running some requests"}},source:{tooltip:"Where the run is executed from",header:"Source",pipeline_meta_cell:"Build {id}"},duration:{tooltip:"Time taken to complete the run",header:"Duration"},all_tests:{tooltip:"Sum of passed, skipped, and failed tests across iterations",header:"All tests"},passed:{tooltip:"Passed tests across iterations",header:"Passed"},failed:{tooltip:"Failed tests across iterations",header:"Failed",cell:{tooltip:{less_than_one:"Less than 1% of tests failed",more_than_one:"{percentage}% tests failed"}}},skipped:{tooltip:"Skipped tests across iterations",header:"Skipped"},avg_res_time:{tooltip:"Average response time",header:"Avg. Resp. Time"},actions:{report:{tooltip:"View Report"},share:{tooltip:"Share",popover:{private:{heading:"Share with team",content:"This collection run is in your personal workspace.",content2:"No one can access this unless you invite them.",button:"Invite people"},shared:{private_team_content:"Only workspace members can access this link.",team_content:"Only team members can access this link.",heading:"Share link",button:{copy:"Copy link",invite:"Invite people"}},partner:{heading:"Share link",content:"Only people with access to this workspace can access this link.",button:{copy:"Copy link",invite:"Invite people"}}},error:{toast:"Unable to invite right now. Try again later?"}}}},D=[{label:"Last 100",value:100},{label:"Last 500",value:500},{label:"Last 1000",value:1e3}],P=[{label:"Completed",value:"finished"},{label:"Failed",value:"failed"},{label:"Error",value:"error"},{label:"Aborted",value:"aborted"}],N=[{label:"Postman CLI",value:"postman-cli"},{label:"Runner",value:"runner"}];var T=n(688),E=n(74172),z=n(32543);const M=({columnId:e})=>(0,C.jsx)(v.Z,{content:S[e].tooltip,openDelay:750,children:(0,C.jsx)(u.Z,{inline:!0,children:(0,C.jsx)(k.Z,{text:S[e].header,type:"h6"})})}),W=({cell:e,testsType:t})=>(0,C.jsx)(u.Z,{className:"fail"===t?"":"test-count__text--wrapper",height:"35px",alignItems:"center",justifyContent:"flex-end",children:(0,C.jsx)(p.ZP,{className:`test-count__text test-count__text--${t}`,type:"body-medium",children:e.value.toString()})}),H=d().div.withConfig({displayName:"runs-table-config__FailCountWrapper",componentId:"sc-85t54c-0"})(["background-color:",";position:absolute;width:100%;height:100%;& .test-count__text{padding-right:var(--spacing-s);}"],(e=>{switch(e.className){case"fail-low":return"dark"===e.theme.name?e.theme["red-90"]:e.theme["red-10"];case"fail-moderate":return"dark"===e.theme.name?e.theme["red-80"]:e.theme["red-20"];case"fail-high":return"dark"===e.theme.name?e.theme["red-70"]:e.theme["red-30"];default:return"inherit"}})),L=d()(u.Z).withConfig({displayName:"runs-table-config__ActionsWrapper",componentId:"sc-85t54c-1"})(["opacity:0;z-index:1;"]),B=d()(y.Z).withConfig({displayName:"runs-table-config__StyledActionButtons",componentId:"sc-85t54c-2"})(["background-color:var(--highlight-background-color-secondary) !important;&:hover{background-color:var(--highlight-background-color-tertiary) !important;}"]),$=({runId:e,collectionId:t})=>{const n=(0,z.tZ)();return(0,C.jsx)(L,{tabIndex:-1,className:"run-history-view--actions-wrapper",gap:"spacing-xs",padding:{paddingLeft:"spacing-s"},justifyContent:"flex-end",children:(0,C.jsx)(B,{type:"secondary",onClick:()=>{n(e,{loadFromHistory:!0,openInNewTab:!0,navigationPayload:{payload:{collectionId:t}}})},icon:(0,C.jsx)(_.Z,{}),tooltip:(0,C.jsx)(v.Z,{content:"View Report",openDelay:750})})})},A=d()(u.Z).withConfig({displayName:"runs-table-config__UserProfileColumn",componentId:"sc-85t54c-3"})(["padding-top:2px;"]),q=[{id:"owner",accessor:"owner",disableSortBy:!0,Cell:e=>(0,C.jsx)(A,{children:(0,C.jsx)(E.H,{userId:e.row.original.owner})}),cellWidth:"24px",align:"center"},{Header:"Start time",id:"startTime",accessor:T.cy,Cell:({cell:e})=>{const t=e.value?(0,b.format)(new Date(e.value),"MMM dd, yyyy HH:mm:ss"):"-",{status:n}=e.row.original;return(0,C.jsxs)(u.Z,{alignItems:"center",children:[(0,C.jsx)("div",{style:{flex:"0 0 138px"},children:(0,C.jsx)(p.ZP,{type:"body-medium",children:t})}),(0,C.jsx)(Z,{status:n})]})},cellWidth:"162px"},{Header:(0,C.jsx)(M,{columnId:"source"}),accessor:"source",cellWidth:"84px",Cell:({cell:e})=>{const t="postman-cli"===e.value?"Postman CLI":e.value||"runner";if(e.row.original.pipelineMeta){const{id:n,url:r}=e.row.original.pipelineMeta;return(0,C.jsxs)(u.Z,{direction:"column",children:[(0,C.jsx)(p.ZP,{type:"body-medium",children:(0,C.jsx)("span",{style:{textTransform:"capitalize"},children:t})}),r?(0,C.jsx)(R.Link,{to:r,target:"_blank",children:(0,C.jsx)(p.ZP,{type:"body-small",color:"content-color-secondary",children:(0,C.jsx)(p.ZP,{type:"link-subtle",isExternal:!0,children:`Build ${n}`})})}):(0,C.jsx)(p.ZP,{type:"body-small",color:"content-color-secondary",children:`Build ${n}`})]})}return(0,C.jsx)(u.Z,{gap:"spacing-s",direction:"column",children:(0,C.jsx)(p.ZP,{type:"body-medium",children:(0,C.jsx)("span",{style:{textTransform:"capitalize"},children:t})})})}},{Header:(0,C.jsx)(M,{columnId:"duration"}),id:"duration",accessor:e=>e.startedAt?(0,b.differenceInMilliseconds)(new Date(e.createdAt),new Date(e.startedAt)):"-",Cell:e=>{const[t,n]=(0,T.K$)(e.value);return(0,C.jsx)(v.Z,{content:n,openDelay:750,children:(0,C.jsx)("div",{children:(0,C.jsx)(p.ZP,{type:"body-medium",children:t||"-"})})})},cellWidth:"80px",align:"right"},{Header:(0,C.jsx)(M,{columnId:"all_tests"}),accessor:"totalTestCount",align:"right",Cell:e=>W({cell:e,testsType:"all"})},{Header:(0,C.jsx)(M,{columnId:"passed"}),accessor:"passedTestCount",align:"right",Cell:e=>W({cell:e,testsType:"pass"})},{Header:(0,C.jsx)(M,{columnId:"failed"}),accessor:"failedTestCount",align:"right",Cell:e=>(({cell:e})=>{var t;const n=Number(e.value),r=Number(null==(t=e.row.original)?void 0:t.totalTestCount),o=Math.floor(n/r*100),s=e=>{switch(Math.floor(e/30)){case 0:return"fail-low";case 1:return"fail-moderate";case 2:case 3:return"fail-high";default:return""}};return n>0?(0,C.jsx)(v.Z,{content:0===o?S.failed.cell.tooltip.less_than_one:`${o}% tests failed`,openDelay:500,closeDelay:10,children:(0,C.jsx)(H,{className:s(o),onClick:()=>{},children:(0,C.jsx)(u.Z,{className:s(o),height:"35px",alignItems:"center",justifyContent:"flex-end",children:(0,C.jsx)(p.ZP,{className:"test-count__text test-count__text--fail",type:"body-medium",children:n.toString()})})})}):(0,C.jsx)(W,{cell:e,testsType:"fail"})})({cell:e})},{Header:(0,C.jsx)(M,{columnId:"skipped"}),accessor:"skippedTestCount",align:"right",Cell:e=>W({cell:e,testsType:"skip"})},{Header:(0,C.jsx)(M,{columnId:"avg_res_time"}),id:"avgResponseTime",accessor:e=>{const t=e.totalTime&&Number(e.totalTime),n=e.totalRequests&&Number(e.totalRequests);return t&&n?`${Math.round(t/n)} ms`:"-"},align:"right"},{id:"actions",Cell:e=>{const t=e.row.original.id,n=e.row.original.collection;return(0,C.jsx)($,{runId:t,collectionId:n})},disableSortBy:!0}];var F=n(42801),O=n(64382),U=n(16669);const V=d()(u.Z).withConfig({displayName:"runs-filter__FiltersContainer",componentId:"sc-a4qkqn-0"})(["padding:var(--spacing-m) 0;"]),Y=d()(p.ZP).withConfig({displayName:"runs-filter__StyledUserName",componentId:"sc-a4qkqn-1"})(["max-width:140px;line-height:var(--line-height-l);"]),G=({handleFiltersChange:e,filters:t})=>{const{data:n,isLoading:o,isError:s}=(0,U.useTeamsByUserId)(),[a,i]=(0,r.useState)({}),[c,d]=(0,r.useState)([]);return(0,r.useEffect)((()=>{if(!o&&n&&n.organizations[0])for(const e of n.organizations[0].team_users)i((t=>(0,l.Z)({},t,{[e.id]:{name:e.name,email:e.email,id:e.id,username:e.username,profile_pic_url:e.profile_pic_url}}))),d((t=>[...t,{label:e.name||e.username,value:e.id}]))}),[o,n]),(0,C.jsxs)(V,{direction:"row",gap:"spacing-s",alignItems:"center","data-testid":"runs-list-filters",children:[(0,C.jsx)(O.Z,{onChange:t=>e({count:t}),options:D,isClearable:!1,isSearchable:!1,value:t.count,triggerType:"tertiary",triggerWidth:"auto"}),s||o?null:(0,C.jsx)(O.Z,{onChange:t=>e({owner:t}),options:c,placeholder:"Run by",value:t.owner,customOptionComponent:e=>(({optionData:e,teamMembers:t})=>{const n=t[e.value];return t&&n?(0,C.jsxs)(u.Z,{alignItems:"center",gap:"spacing-s",children:[(0,C.jsx)(F.Z,{size:"xs",type:"user",src:n.profile_pic_url,userId:Number(n.id),"data-testid":"runby-filter-option"}),(0,C.jsx)(Y,{isTruncated:!0,children:e.label})]}):null})({optionData:e,teamMembers:a}),menuMaxHeight:300,menuWidth:250,triggerMaxWidth:250,triggerType:"tertiary",triggerWidth:"auto",isVirtualized:c.length>0,emptyStateMessage:"No options found"}),(0,C.jsx)(O.Z,{onChange:t=>e({status:t}),placeholder:"Run status",options:P,value:t.status,isSearchable:!1,triggerType:"tertiary",triggerWidth:"auto"}),(0,C.jsx)(O.Z,{onChange:t=>e({source:t}),placeholder:"Source",options:N,isSearchable:!1,value:t.source,triggerType:"tertiary",triggerWidth:"auto"})]})};var J=n(2358);const K=e=>{const t=(0,z.XC)();return(0,C.jsx)(u.Z,{padding:"spacing-l","data-testid":"runs-blank-state",children:e.hasCollectionBeenRun?(0,C.jsx)(x.Z,{title:"No runs for the applied filters",description:"You may try different filters or clear all filters",children:(0,C.jsx)(J.Z,{})}):(0,C.jsx)(x.Z,{title:"Your collection has not been run yet",primaryAction:(0,C.jsx)(y.Z,{type:"primary",text:"Run Collection",tooltip:e.isRunDisabled?"You do not have permission to run this collection":"Run collection",isDisabled:e.isRunDisabled,"data-testid":"run-collection-btn",onClick:()=>{e.collectionId&&t(e.collectionId)}}),children:(0,C.jsx)(J.Z,{})})})};var X=n(20039),Q=n(97913),ee=n(20455),te=n(98276),ne=n(10099),re=n(25451);const oe=({rowData:e})=>{let t;switch(e.source){case"runner":default:t="Ran locally using Collection Runner";break;case"postman-cli":t="Ran using Postman CLI";break;case"newman":t="Ran in CLI using Newman"}if(e.pipelineMeta){const t="runner"===e.source?"Collection Runner":"Newman",{source:n,id:r}=e.pipelineMeta,s=`Ran in ${n} build ${r} using ${t}`;return(0,C.jsxs)(o().Fragment,{children:[(0,C.jsx)(X.Z,{color:"content-color-secondary"}),(0,C.jsx)(p.ZP,{type:"body-medium",color:"content-color-secondary",children:s})]})}return(0,C.jsxs)(o().Fragment,{children:["newman"===e.source?(0,C.jsx)(X.Z,{color:"content-color-secondary"}):(0,C.jsx)(Q.Z,{color:"content-color-secondary"}),(0,C.jsx)(p.ZP,{type:"body-medium",color:"content-color-secondary",children:t})]})},se=({rowData:e})=>{const t=(0,ne.useActiveWorkspaceId)(),{data:n,isLoading:r}=(0,te.useEnvironmentItems)({workspaceId:t}),s=null==n?void 0:n.find((t=>t.id===e.environment)),a=(0,z.HH)();return r?(0,C.jsx)(re.T,{}):s?(0,C.jsxs)(o().Fragment,{children:[(0,C.jsx)(ee.Z,{color:"content-color-secondary"}),(0,C.jsx)(y.Z,{type:"muted-plain",size:"medium",onClick:()=>{a(e.environment)},text:null==s?void 0:s.name})]}):(0,C.jsx)(p.ZP,{type:"body-medium",color:"content-color-secondary",children:"No environment used"})},ae=({rowData:e})=>{const t=e.currentIteration;return"error"===e.status?(0,C.jsx)(p.ZP,{type:"body-medium",color:"content-color-secondary",children:`${t} ${t>1?"iterations":"iteration"} completed (some requests couldn't run)`}):"aborted"===e.status?(0,C.jsx)(p.ZP,{type:"body-medium",color:"content-color-secondary",children:`Run aborted at iteration no. ${t}`}):(0,C.jsx)(p.ZP,{type:"body-medium",color:"content-color-secondary",children:`${t} completed`})},ie=d()(u.Z).withConfig({displayName:"row-sub-component__SubComponentWrapper",componentId:"sc-1ddvj5d-0"})(["background-color:var(--background-color-secondary);margin:calc(var(--spacing-s) * -1) calc(var(--spacing-xs) * -1);padding:12px 36px 16px;"]),le=d().div.withConfig({displayName:"row-sub-component__SubComponentSeperator",componentId:"sc-1ddvj5d-1"})(["width:2px;height:2px;background:var(--content-color-tertiary);border-radius:50px;"]),ce=({rowData:e})=>(0,C.jsxs)(ie,{alignItems:"center",gap:"spacing-m",children:[(0,C.jsx)(u.Z,{gap:"spacing-xs",alignItems:"center",children:(0,C.jsx)(oe,{rowData:e})}),(0,C.jsx)(le,{}),(0,C.jsx)(u.Z,{gap:"spacing-xs",alignItems:"center",children:(0,C.jsx)(se,{rowData:e})}),(0,C.jsx)(le,{}),(0,C.jsx)(ae,{rowData:e})]});var de=n(53186),ue=n(94250),pe=n(26246);const me=d().span.withConfig({displayName:"bulk-action-bar__ButtonWrapper",componentId:"sc-oqx0xn-0"})(["padding-left:var(--spacing-m);"]),he=(0,r.forwardRef)(((e,t)=>(0,C.jsx)(ue.Z,{status:"neutral",hideIcon:!0,children:(0,C.jsxs)(u.Z,{justifyContent:"space-between",alignItems:"center",children:[(0,C.jsx)(p.ZP,{type:"body-medium",color:"content-color-primary",children:`${e.rowIdsSelected.length} items selected`}),(0,C.jsxs)(u.Z,{justifyContent:"flex-end",alignItems:"center",padding:("spacing-m","spacing-zero","spacing-l","spacing-zero",{paddingLeft:"spacing-m",paddingTop:"spacing-zero",paddingRight:"spacing-l",paddingBottom:"spacing-zero"}),children:[(0,C.jsx)(me,{children:(0,C.jsx)(y.Z,{type:"secondary",text:"Cancel",size:"small",ref:t})}),(0,C.jsx)(me,{children:(0,C.jsx)(y.Z,{type:"destructive",text:"Delete",size:"small",isDisabled:!e.isDeleteEnabled,onClick:()=>(async(e,t,n)=>{const r=pe.Modals.getModals(),o=await r.showWarningDialog({uid:"collections-runner-delete-run",subject:"Delete selected runs?",message:"Are you sure you want to permanently delete the selected runs?",options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Delete",isPrimary:!0}]});o&&"Delete"===o.title&&n&&t(e)})(e.rowIdsSelected,e.handleDeleteRuns,e.isDeleteEnabled)})})]})]})}))),ge=d()(u.Z).withConfig({displayName:"runs-history-view__RunsListContainer",componentId:"sc-wm4uzz-0"})(["margin-top:var(--spacing-l);"]),xe=d()(p.ZP).withConfig({displayName:"runs-history-view__StyledTextContainer",componentId:"sc-wm4uzz-1"})(["padding-left:var(--spacing-s);"]),ye=d()(m.Z).withConfig({displayName:"runs-history-view__StyledTable",componentId:"sc-wm4uzz-2"})(["margin-left:var(--spacing-s);& tr{& .test-count__text--wrapper{margin-top:calc(var(--spacing-s) * -1);margin-bottom:calc(var(--spacing-s) * -1);margin-left:var(--spacing-l);}}& .run-history-view--actions-wrapper.share-modal-open{opacity:1;}& tr:hover{& .run-history-view--actions-wrapper{opacity:1;}}& th{padding:var(--spacing-s) var(--spacing-xs);}& td{padding:var(--spacing-s) var(--spacing-xs);&:nth-last-child(4){padding:0 var(--spacing-xs);position:relative;}&:nth-last-child(1){padding:var(--spacing-xs) var(--spacing-xs);position:sticky;right:0;}}"]),je=()=>{const{workspaceId:e,collectionId:t}=(0,a.useParams)(),[n,o]=(0,r.useState)({count:D[0],source:null,owner:null,status:null}),{addToast:s}=(0,h.ZP)(),[i,c]=(0,r.useState)(!1),{data:d,isError:p,refetch:m,isLoading:b}=(0,f.useCollectionRuns)({workspaceId:e,collectionId:t,count:n.count.value,status:n.status?n.status.value:void 0,source:n.source?n.source.value:void 0,owner:n.owner?n.owner.value:void 0}),{userCanRunCollection:v,userCanDeleteHistory:w}=(0,de.useWorkspacePermissions)(e),[I,Z]=(0,r.useState)([]),_=(0,r.createRef)(),[k,R]=(0,r.useState)([]),[S,P]=(0,r.useState)(!1),N=(0,f.useDeleteCollectionRun)(),[T,E]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{E(!0),m().finally((()=>{E(!1)}))}),[n]),(0,r.useEffect)((()=>{!b&&d&&d.length>0&&c(!0)}),[b]),(0,r.useEffect)((()=>{if(d){const e=d.map((e=>e.data));Z(e)}}),[d]),b||T?(0,C.jsx)(u.Z,{alignItems:"center",justifyContent:"center",height:"276px",children:(0,C.jsx)(g.Z,{description:"Loading runs"})}):p?(0,C.jsx)(u.Z,{padding:"spacing-l",children:(0,C.jsx)(x.Z,{title:"Couldn’t load the runs",description:"Just a faulty wire. Try reloading.",primaryAction:(0,C.jsx)(y.Z,{type:"outline",text:"Reload",onClick:m}),children:(0,C.jsx)(j.Z,{})})}):(0,C.jsxs)(ge,{direction:"column",gap:"spacing-m","data-testid":"runs-list-container",children:[(0,C.jsx)(xe,{type:"body-medium",text:"Runs triggered for this collection via Collection Runner and Postman CLI.",color:"content-color-secondary"}),S?(0,C.jsx)(he,{rowIdsSelected:k,ref:_,isDeleteEnabled:w,handleDeleteRuns:n=>{P(!1);let r=!1;for(const o of n){const n=I.find((e=>e.id===o));n&&N.mutate({runId:o,userId:n.owner,workspaceId:e,collectionId:t},{onError:()=>{r=!0}})}r&&s({status:"error",description:"Could not delete some collection runs."})}}):(0,C.jsx)(G,{handleFiltersChange:e=>{o((0,l.Z)({},n,e))},filters:n}),(0,C.jsx)(ye,{data:I,columns:q,bodyMaxHeight:"340px",rowSelected:{onSelect:e=>{const t=Object.keys(e);t.length>0?P(!0):P(!1),R(t)},clearSelectionNodeRef:_},pagination:{initialPageSize:20},blankState:{isEmpty:0===(null==I?void 0:I.length),component:(0,C.jsx)(K,{hasCollectionBeenRun:i,isRunDisabled:!v,collectionId:t})},getRowId:e=>e.id,sorting:!0,rowExpanded:{subComponent:e=>(0,C.jsx)(ce,{rowData:e})}})]})};var fe=n(21180);const be=()=>(0,C.jsx)(fe.CustomErrorBoundary,{appId:"collection-runs-history",errorElementId:"collection-runs-history-tab",fallback:(0,C.jsx)(fe.GenericErrorMessage,{title:"There was a problem loading run history",description:"Please try again.",illustration:"illustration-internal-server-error"}),children:(0,C.jsx)(h.VW,{children:(0,C.jsx)(je,{})})});var ve=n(82993),we=n(71932),Ie=n(72883),Ce=n(8243);const Ze=d().div.withConfig({displayName:"collection-run-open__CollectionRunOpenContainer",componentId:"sc-1yu8o1r-0"})(["flex:1;display:flex;flex-direction:column;min-height:0;height:calc(100% - 60px);"]),_e=()=>(0,C.jsx)(Ie.z,{children:(0,C.jsxs)(ve.U,{children:[(0,C.jsx)(we.e,{}),(0,C.jsx)(Ze,{"data-testid":"collection-run-open-container",children:(0,C.jsx)(Ce.P,{})})]})}),ke=[{path:"/workspace/:workspaceId/run/create",element:(0,C.jsx)(i.Z,{}),errorElement:(0,C.jsx)(fe.RouteErrorBoundary,{appId:"collection-runner",errorElementId:"collection-runner-route"})},{path:"/workspace/:workspaceId/run/:runId",element:(0,C.jsx)(_e,{}),errorElement:(0,C.jsx)(fe.RouteErrorBoundary,{appId:"collection-runner",errorElementId:"collection-runner-route"})},{path:"/workspace/:workspaceId/collection/:collectionId",element:(0,C.jsx)(be,{}),errorElement:(0,C.jsx)(fe.RouteErrorBoundary,{appId:"collection-runner",errorElementId:"collection-runner-route"})}],{router:Re}=(0,R.createPlatformRouter)(ke);function Se(){return(0,C.jsx)(a.RouterProvider,{router:Re})}var De=n(28422);const Pe=document.querySelector("#collection-runner_root");s.render((0,C.jsx)(De.PostmanBootstrap,{appId:"collection-runner",errorElementId:"global-error-boundary",children:(0,C.jsx)(Se,{})}),Pe)}}]);
//# sourceMappingURL=9007.8fc0cac5b8e38515.js.map