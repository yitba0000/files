"use strict";(self.webpackChunkcollection_runner=self.webpackChunkcollection_runner||[]).push([[3331],{15059:(e,n,o)=>{o.r(n),o.d(n,{COLLECTION_RUNS_LIST_PREFIX:()=>a,COLLECTION_RUN_PREFIX:()=>l,collectionRunByIdQuery:()=>p,collectionRunsListQuery:()=>d,deleteCollectionRun:()=>y,fetchCollectionRunById:()=>I,findCollectionRuns:()=>u,getQueryKey:()=>i,importCollectionRun:()=>w,removeCollectionRunFromListCache:()=>T,useCollectionRunById:()=>k,useCollectionRuns:()=>R,useDeleteCollectionRun:()=>g,useDeleteRuns:()=>E});var t=o(7560),s=o(45860),r=o(26663),c=o.n(r);const u=async e=>{const{signal:n,workspaceId:o,collectionId:r,populateIterations:u,count:a,status:l,owner:i,source:d,since_id:I,max_id:p}=e;return await s.postmanGateway.get({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun`,query:(0,t.Z)({workspace:o},r&&{collection:r},{iterations:u||!1,count:a},l&&{status:l},i&&{owner:i},d&&{source:d},{since_id:I||0},p&&{max_id:p}),signal:n})},a="collection-runs-list",l="collection-run",i=e=>{const n=[a];for(const o of Object.values(e))o&&n.push(o);return n},d=({signal:e,workspaceId:n,collectionId:o,populateIterations:t=!1,count:s,status:r,owner:c,source:a,since_id:l=0,max_id:d=0})=>({queryKey:i({workspaceId:n,collectionId:o}),queryFn:()=>u({signal:e,workspaceId:n,collectionId:o,populateIterations:t,count:s,status:r,owner:c,source:a,since_id:l,max_id:d}),enabled:!!n,useErrorBoundary:!1}),I=async({signal:e,runId:n})=>await s.postmanGateway.get({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/${n}`,signal:e}),p=({signal:e,runId:n})=>({queryKey:[l,n],queryFn:()=>I({signal:e,runId:n}),enabled:!!n,useErrorBoundary:!1}),w=async({signal:e,owner:n,workspace:o,runDetails:t})=>await s.postmanGateway.post({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/import`,query:{owner:n,workspace:o},body:JSON.stringify(t),signal:e}),y=async({runId:e,userId:n,signal:o})=>await s.postmanGateway.delete({url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/collectionrun/${e}`,query:{owner:n},signal:o});var _=o(97201);const R=({workspaceId:e,collectionId:n,count:o,status:t,source:s,owner:r})=>(0,_.useDataFetch)(d({workspaceId:e,collectionId:n,count:o,status:t,source:s,owner:r})),k=e=>(0,_.useDataFetch)(p({runId:e})),T=(e,n,o)=>{e&&(0,_.updateCache)({key:i({workspaceId:n,collectionId:null!=o?o:""}),updater:n=>n?n.filter((n=>n.model_id!==e)):n})},g=()=>(0,_.useMutation)({mutationFn:e=>y({runId:e.runId,userId:e.userId,signal:e.signal}),onSuccess:(e,n)=>{T(n.runId,n.workspaceId,n.collectionId),n.onSuccess&&n.onSuccess(e)},onError:(e,n)=>{n.onError&&n.onError(e)}});var m=o(53186),C=o(10099);const E=(e,n)=>{const o=(0,C.useActiveWorkspaceId)(),{userCanDeleteHistory:t}=(0,m.useWorkspacePermissions)(o),s=g(),{data:r}=R({workspaceId:o,count:e});return{deleteRuns:e=>{if(!t||!r)return;const c=r.map((e=>s.mutateAsync({runId:e.data.id,userId:e.data.owner,workspaceId:o,collectionId:n})));Promise.all(c).catch((n=>{e&&e(n)}))}}}}}]);
//# sourceMappingURL=3331.0fb5df8c492bec2c.js.map