"use strict";(self.webpackChunkcollection_runner=self.webpackChunkcollection_runner||[]).push([[4888,7560,2389,4591],{7560:(e,t,r)=>{function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},s.apply(this,arguments)}r.d(t,{Z:()=>s})},84888:(e,t,r)=>{r.r(t),r.d(t,{ACCESS_CONTROL_QUERY_KEY_PREFIX:()=>l,ALL_ROLES:()=>i,DEFAULT_ROLES:()=>u,ENTITY_PERMISSIONS_QUERY_KEY:()=>p,entityPermissionsQuery:()=>g,getAllRolesForObjectType:()=>c,getDefaultRolesForObjectType:()=>d,getDefaultRolesMap:()=>v,getRolesData:()=>_,getRolesForObject:()=>y,getUserGroupsFromRoles:()=>G,segregateGroupRoles:()=>m,useEntityPermissions:()=>C,useFetchAssociatedRoles:()=>h,useFetchDefaultRolesForObjectType:()=>E,useFetchRolesForObject:()=>j,useFetchRolesForObjectType:()=>T,validateRolesAssignment:()=>o});var s=r(45860),a=r(26663),n=r.n(a);const o=async({signal:e,validationCriteria:t})=>await s.postmanGateway.post({url:`${n().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:"/api/validations/role-assignment",data:{body:{validations:t},service:"acs"},signal:e}),l="acs",i="all-roles",u="default-roles",p="entity-permissions",c=({signal:e,objectType:t,getGuestConfig:r,partnerWorkspaceEnabled:a})=>({queryKey:[l,i,t],queryFn:()=>(async({signal:e,objectType:t,getGuestConfig:r=!1,partnerWorkspaceEnabled:a=!1})=>await s.postmanGateway.post({url:`${n().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,service:"acs",path:"/api/roles/list/by-objects",data:{body:{getGuestConfig:r,partnerWorkspaceEnabled:a,objects:[t]},query:{guest:r,include:"state",partner:a,permissions:!0,populate:!0,type:"all"}},signal:e}))({signal:e,objectType:t,getGuestConfig:r,partnerWorkspaceEnabled:a}),enabled:!!t,useErrorBoundary:!1}),y=({signal:e,objectType:t,objectId:r,getGuestConfig:a,partnerWorkspaceEnabled:o})=>({queryKey:[l,i,t,r],queryFn:()=>(async({signal:e,objectType:t,objectId:r,getGuestConfig:a=!1,partnerWorkspaceEnabled:o=!1})=>await s.postmanGateway.post({url:`${n().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,service:"acs",path:"/api/roles/list-by-object",data:{body:{item:{getGuestConfig:a,objectId:r,objectType:t,partnerWorkspaceEnabled:o}},query:{guest:a,include:"state",partner:o,permissions:!0,populate:!0,type:"all"}},signal:e}))({signal:e,objectType:t,objectId:r,getGuestConfig:a,partnerWorkspaceEnabled:o}),enabled:!!r&&!!t,useErrorBoundary:!1}),d=({signal:e,objectType:t,getGuestConfig:r,partnerWorkspaceEnabled:a})=>({queryKey:[l,u,t],queryFn:()=>(async({signal:e,objectType:t,getGuestConfig:r=!1,partnerWorkspaceEnabled:a=!1})=>await s.postmanGateway.get({url:`${n().HTTPS_GATEWAY_PRIVATE_URL}/roles/default`,query:{objectType:t,getGuestConfig:r,partnerWorkspaceEnabled:a},signal:e}))({signal:e,objectType:t,getGuestConfig:r,partnerWorkspaceEnabled:a}),enabled:!!t,useErrorBoundary:!1}),g=({signal:e,entityId:t,permissions:r})=>({queryKey:[p,t],queryFn:()=>(async({permissions:e,signal:t})=>await s.postmanGateway.post({url:`${n().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:"/api/permissions/check",service:"acs",data:{body:e},signal:t}))({signal:e,permissions:r}),enabled:!!t,useErrorBoundary:!1});var b=r(97201);const T=(e,t,r)=>(0,b.useDataFetch)(c({objectType:e,getGuestConfig:t,partnerWorkspaceEnabled:r})),E=(e,t,r)=>(0,b.useDataFetch)(d({objectType:e,getGuestConfig:t,partnerWorkspaceEnabled:r})),j=(e,t,r,s)=>(0,b.useDataFetch)(y({objectType:e,objectId:t,getGuestConfig:r,partnerWorkspaceEnabled:s})),R=(e,t,r)=>Array.isArray(e)?0===e.length?r:e.reduce(((e,r,s,a)=>t(e,r,s,a)||e),r):"object"==typeof e?0===Object.keys(e).length?r:Object.keys(e).reduce(((r,s,a,n)=>t(r,e[s],s,n)||r),r):r;var f=r(7560);const v=(e,t)=>{const r={};for(const a of["user","team","guest","partner"]){var s;const n=null==t||null==(s=t.listing)||null==(s=s[a])||null==(s=s[e])?void 0:s.roles;n&&(r[a]=n[0])}return r},m=(e,t)=>{const r=new Set(t.map((e=>e.id.toString()))),s={},a={};for(const[t,n]of Object.entries(e))r.has(t)?s[t]=n:a[t]=n;return{userGroupRoles:s,otherGroupRoles:a}},G=(e,t)=>R(e,((e,r,s)=>{const a=t.find((e=>`${e.id}`==`${s}`));return a&&(e[s]=(0,f.Z)({},a,{canRemove:!0,value:a.name})),e}),{}),_=(e,t,r,s,a)=>{const n=[],o=(0,f.Z)({},r,s);null!=a&&a.id&&(o[a.id]=a);for(const[,r]of Object.entries(o))n.push({entityId:r.id,entityType:r.type,roles:{[r.name]:{objects:[{objectId:t,objectType:e}]}}});return n},h=()=>(e,t,r,s)=>{var a,n;const o=r.objects[e],l=[...r.roleOrder[e]].reverse()||[],i=t.listing,u=v(e,s),p=null==(a=r.wrapperData)||null==(a=a.guest)?void 0:a[e],c=null==(n=r.wrapperData)||null==(n=n.partner)?void 0:n[e];return{defaultRoles:u,rolesList:o,userCurrentRoles:R(null==i?void 0:i.user,((e,t,r)=>{var s;return e[r]={type:"user",id:r,name:null==t||null==(s=t.roles)?void 0:s[0]},e}),{}),teamCurrentRoles:R(null==i?void 0:i.team,((e,t,r)=>{var s;return e[r]={type:"team",id:r,name:null==t||null==(s=t.roles)?void 0:s[0]},e}),{}),groupCurrentRoles:R(null==i?void 0:i.group,((e,t,r)=>{var s;return e[r]={type:"group",id:r,name:null==t||null==(s=t.roles)?void 0:s[0]},e}),{}),rolesOrder:l,guestRoles:p,partnerRoles:c}},C=(e,t)=>(0,b.useDataFetch)(g({entityId:e,permissions:t}))}}]);
//# sourceMappingURL=4888.3e5e3e079f0c0f72.js.map