(self.webpackChunkcollection_workbench=self.webpackChunkcollection_workbench||[]).push([[9825],{99951:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ACCESS_TOKENS_KEY:()=>Ie,AUTH_OPTIONS:()=>g,AuthPanel:()=>va,OAuth2TokenFetcher:()=>st,SHARED_OAUTH2_TOKEN_ID:()=>T,composeAuthSessionId:()=>ka,decomposeAuthSessionId:()=>ya,defaultAuthSession:()=>Ia,getAllOAuth2AccessTokens:()=>qe,getAuthSession:()=>ba,getAuthSessionById:()=>ga,getOAuth2AccessToken:()=>Oe,getStorage:()=>wa,getTokenIdForAuthSession:()=>Ra,getTokenStorage:()=>He,getTokenValuesForAuthSession:()=>Sa,getTokenValuesForTokenId:()=>Pa,hasAuthSession:()=>xa,initialAuthState:()=>b,isTokenAutoRefreshable:()=>Je,isTokenExpired:()=>$e,removeOAuth2AccessToken:()=>Ne,removeSession:()=>ja,setAuthSession:()=>Ta,setAuthSessionById:()=>_a,setOAuth2AccessToken:()=>Ue,subscribeToAuthSession:()=>Aa,subscribeToOAuth2AccessTokens:()=>ze,supportedAuthOptions:()=>x,updateOAuth2Token:()=>Ee,useAuthSession:()=>Oa,useAuthSessionSafe:()=>qa,useOAuth2Tokens:()=>rt});var n=a(40540),s=a.n(n),r=a(59530),o=a.n(r),i=a(50297),l=a(58560),u=a(37110),c=a(98529),d=a(74269),h=a(63622),p=a(88131),m=a(52322);const v=o()(c.Z).withConfig({displayName:"components__Input",componentId:"sc-jxbkzv-0"})(["&:not(:focus){border-color:var(--border-color-default);background-color:var(--background-color-secondary);}"]),k=({name:e,label:t,onChange:a,value:n,type:s="text"})=>(0,p.usePostmanInputFeatureFlag)()?(0,m.jsx)(p.AuthInput,{onChange:t=>{a(t,e)},suggestions:[],value:n,placeholder:t,ariaLabel:t,dataTestId:`${e}-input`}):(0,m.jsx)(v,{onChange:t=>{a(t.target.value,e)},name:e,value:n,placeholder:t,type:s,"data-testid":`${e}-input`}),y=o()(d.Z).withConfig({displayName:"components__Select",componentId:"sc-jxbkzv-1"})([".aether-dropdown__control:not(:focus){border-color:var(--border-color-default);background-color:var(--background-color-secondary);}.aether-dropdown__control .aether-dropdown__single-value{color:var(--content-color-secondary);font-weight:600;font-size:var(--text-size-s);}"]),f=o()(h.ZP).withConfig({displayName:"components__Label",componentId:"sc-jxbkzv-2"})(["color:var(--content-color-primary);"]),g={apikey:"apikey",basic:"basic",bearer:"bearer",noauth:"noauth",inherit:"inherit"},b={noauth:[],apikey:[],bearer:[],basic:[],inherit:null,oauth2:[{key:"addTokenTo",value:"header"}],awsv4:[],oauth1:[{key:"signatureMethod",value:"HMAC-SHA1"},{key:"version",value:"1.0"},{key:"addParamsToHeader",value:!1},{key:"addEmptyParamsToSign",value:!1}]},x=[{label:"Inherit auth from parent",value:"inherit"},{label:"No Auth",value:"noauth"},{label:"API Key",value:"apikey"},{label:"Basic Auth",value:"basic"},{label:"Bearer Token",value:"bearer"},{label:"OAuth 2.0",value:"oauth2"},{label:"AWS Signature",value:"awsv4"},{label:"OAuth 1.0",value:"oauth1"}],_=[{label:"JWT Bearer",value:"jwt"},{label:"Digest Auth",value:"digest"},{label:"Hawk Authentication",value:"hawk"},{label:"NTLM Authentication [Beta]",value:"ntlm"},{label:"Akamai EdgeGrid",value:"edgegrid"}],T="shared-token";var j=a(39245),A=a(71453);const w=o()(j.Link).withConfig({displayName:"authorization-desc-link__AuthorizationLink",componentId:"sc-189u5l5-0"})(["display:inline-flex;align-items:center;text-decoration:underline;color:var(--content-color-secondary);"]),C=()=>(0,m.jsxs)(w,{type:"link-default",to:"https://go.pstmn.io/docs-auth",target:"_blank",rel:"noopener noreferer",children:["authorization",(0,m.jsx)(A.Z,{})]}),S=()=>{const e=(0,n.useContext)(ma).authState;return(0,n.useMemo)((()=>_.find((t=>t.value===e.activeAuthType))),[e])},R=()=>{const e=s().useContext(ma).disabledAuthTypes;return x.filter((t=>!(null!=e&&e.includes(t.value))))},P=o().div.withConfig({displayName:"auth-type-selector__AuthTypeSection",componentId:"sc-lvj2yu-0"})(["flex:0.35;padding:var(--spacing-m);border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);height:100%;box-sizing:border-box;"]),I=o()(l.Z).withConfig({displayName:"auth-type-selector__AuthTypeWrapper",componentId:"sc-lvj2yu-1"})(["align-items:center;padding:var(--spacing-s) var(--spacing-zero);flex-wrap:wrap;"]),O=o().div.withConfig({displayName:"auth-type-selector__AuthFlexContentWrapper",componentId:"sc-lvj2yu-2"})(["flex:1;"]),q=o().div.withConfig({displayName:"auth-type-selector__AutoAuthTypeDescription",componentId:"sc-lvj2yu-3"})(["padding:var(--spacing-s) var(--spacing-zero);"]),U=(0,i.observer)((()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,n=R(),r=S();return(0,m.jsxs)(P,{"data-testid":"auth-type-selector",children:[(0,m.jsxs)(I,{children:[(0,m.jsx)(O,{children:(0,m.jsx)(u.Z,{text:"Type",htmlFor:"auth-type-selector-dropdown"})}),(0,m.jsx)(O,{children:(0,m.jsx)(y,{onChange:({value:e})=>{a(Object.assign({},t,{activeAuthType:e}))},options:n,value:n.find((e=>e.value===t.activeAuthType)),id:"auth-type-selector-dropdown",isSearchable:!1,isClearable:!1,viaPortal:!0,placeholder:r?r.label:""})})]}),"noauth"!==t.activeAuthType&&(0,m.jsxs)(q,{children:["The authorization header will be automatically generated when you send the request. Learn more about"," ",(0,m.jsx)(C,{})]})]})})),N=o()(l.Z).withConfig({displayName:"default__DefaultAuthModeContainer",componentId:"sc-1t90ldu-0"})(["width:100%;height:100%;align-items:center;justify-content:center;"]),E=()=>(0,m.jsx)(N,{children:"This request is not inheriting any authorization helper at the moment."}),z=o()(l.Z).withConfig({displayName:"bearer__BearerTokenAuthWrapper",componentId:"sc-rh1mkt-0"})(["align-items:center;padding-top:var(--spacing-s);max-width:500px;"]),H=o().div.withConfig({displayName:"bearer__BearerTokenAuthContentWrapper",componentId:"sc-rh1mkt-1"})(["flex:1;"]),F=(0,i.observer)((()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,r=(0,n.useCallback)((e=>{if(!e)return a(Object.assign({},t,{bearer:[]}));a(Object.assign({},t,{bearer:[{key:"token",value:e}]}))}),[t,a]),o=(0,n.useMemo)((()=>{var e;return(null==(e=t.bearer)||null==(e=e.find((e=>"token"===e.key)))?void 0:e.value)||""}),[t]);return(0,m.jsxs)(z,{"data-testid":"bearer-auth",children:[(0,m.jsx)(H,{children:(0,m.jsx)(f,{children:"Token"})}),(0,m.jsx)(H,{children:(0,m.jsx)(k,{name:"token",label:"token",value:o,onChange:r})})]})})),Z=o()(l.Z).withConfig({displayName:"basic__BasicAuthWrapper",componentId:"sc-a7izfe-0"})(["align-items:center;padding-top:var(--spacing-s);max-width:500px;"]),V=o().div.withConfig({displayName:"basic__BasicAuthContentWrapper",componentId:"sc-a7izfe-1"})(["flex:1;"]),D=[{key:"username",label:"Username",type:"text"},{key:"password",label:"Password",type:"password"}],B=(0,i.observer)((()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,r=(0,n.useCallback)(((e,n)=>{var s;if(!e)return a(Object.assign({},t,{basic:(null==(s=t.basic)?void 0:s.filter((e=>e.key!==n)))||null}));const r=[...t.basic||[]],o=r.findIndex((e=>e.key===n));if(-1===o)return a(Object.assign({},t,{basic:[...t.basic||[],{key:n,value:e}]}));r[o].value=e,a(Object.assign({},t,{basic:r}))}),[t,a]),o=e=>{var a;return(null==(a=t.basic)||null==(a=a.find((t=>t.key===e)))?void 0:a.value)||""};return(0,m.jsx)(m.Fragment,{children:D.map((({key:e,label:t,type:a})=>(0,m.jsxs)(Z,{"data-testid":"basic-input",children:[(0,m.jsx)(V,{children:(0,m.jsx)(f,{children:t})}),(0,m.jsx)(V,{children:(0,m.jsx)(k,{name:e,label:t,value:o(e),onChange:r,type:a})})]},e)))})})),L=o()(l.Z).withConfig({displayName:"api-key__APIKeyAuthWrapper",componentId:"sc-6hvh8k-0"})(["align-items:center;padding-top:var(--spacing-s);max-width:500px;"]),K=o().div.withConfig({displayName:"api-key__APIKeyAuthContentWrapper",componentId:"sc-6hvh8k-1"})(["flex:1;"]),W=[{key:"key",label:"Key"},{key:"value",label:"Value"},{key:"in",label:"Add To",type:"select",options:[{label:"Headers",value:""},{label:"Query Params",value:"query"}]}],M=(0,i.observer)((()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,r=(0,n.useCallback)(((e,n)=>{var s;if(!e)return a(Object.assign({},t,{apikey:(null==(s=t.apikey)?void 0:s.filter((e=>e.key!==n)))||null}));const r=[...t.apikey||[]],o=r.findIndex((e=>e.key===n));if(-1===o)return a(Object.assign({},t,{apikey:[...t.apikey||[],{key:n,value:e}]}));r[o].value=e,a(Object.assign({},t,{apikey:r}))}),[t,a]),o=(0,n.useCallback)((e=>{var n;return e.value?a(Object.assign({},t,{apikey:[...t.apikey||[],{key:"in",value:e.value}]})):a(Object.assign({},t,{apikey:(null==(n=t.apikey)?void 0:n.filter((e=>"in"!==e.key)))||null}))}),[t,a]),i=e=>{var a;return(null==(a=t.apikey)||null==(a=a.find((t=>t.key===e)))?void 0:a.value)||""};return(0,m.jsx)(m.Fragment,{children:W.map((({key:e,label:a,type:n,options:s})=>{return(0,m.jsxs)(L,{"data-testid":"apikey-input",children:[(0,m.jsx)(K,{children:(0,m.jsx)(f,{children:a})}),(0,m.jsx)(K,{children:"select"===n&&null!=s&&s.length?(0,m.jsx)(y,{isClearable:!1,options:s,value:(null==(l=t.apikey)?void 0:l.find((e=>"in"===e.key)))?{label:"Query Params",value:"query"}:{label:"Headers",value:""},onChange:o,name:e,"aria-label":"add auth to",viaPortal:!0}):(0,m.jsx)(k,{name:e,label:a,value:i(e),onChange:r})})]},e);var l}))})}));var $=a(74962),G=a(69019),J=a(1078),Q=a(81397),Y=a(31987),X=a(38163),ee=a(80429),te=a(98244),ae=a(26663),ne=a.n(ae),se=a(26246),re=a(91500),oe=a.n(re),ie=a(60398),le=a(84452),ue=a(21466),ce=a(5634);const de="authorization_code",he="authorization_code_with_pkce",pe="implicit",me={authorization_code:"Authorization Code",authorization_code_with_pkce:"Authorization Code (With PKCE)",implicit:"Implicit",password_credentials:"Password Credentials",client_credentials:"Client Credentials"},ve={S256:"SHA-256",plain:"Plain"},ke={header:"Send as Basic Auth header",body:"Send client credentials in body"},ye="request_url",fe="request_body",ge="request_header",be={[fe]:"Request Body",[ye]:"Request URL",[ge]:"Request Headers"},xe={grant_type:me,client_authentication:ke,challengeAlgorithm:ve},_e={header:"Request Headers",queryParams:"Request URL"},Te="id_token",je="access_token",Ae={[je]:"Access token",[Te]:"ID token"},we={accessTokenUrl:"",refreshTokenUrl:"",refreshToken:"",client_authentication:"header",authUrl:"",clientId:"",clientSecret:"",grant_type:"authorization_code",password:"",redirect_uri:ne().OAUTH2_CALLBACK_URL,scope:"",state:"",username:"",challengeAlgorithm:"S256",code_verifier:"",name:"Untitled Token",authRequestParams:[],tokenRequestParams:[],refreshRequestParams:[],addTokenTo:"header"},Ce=[{key:"tokenName",label:"Token Name"},{key:"grant_type",label:"Grant Type",type:"select",options:Object.keys(me).map((e=>({label:me[e],value:e})))},{key:"redirect_uri",label:"Callback URL",disabled:!0},{key:"authUrl",label:"Auth URL"},{key:"accessTokenUrl",label:"Access Token URL"},{key:"clientId",label:"Client ID"},{key:"clientSecret",label:"Client Secret"},{key:"username",label:"Username"},{key:"password",label:"Password"},{key:"challengeAlgorithm",label:"Code Challenge Method",type:"select",options:Object.keys(ve).map((e=>({label:ve[e],value:e})))},{key:"code_verifier",label:"Code Verifier"},{key:"scope",label:"Scope"},{key:"state",label:"State"},{key:"client_authentication",label:"Client Authentication",type:"select",options:Object.keys(ke).map((e=>({label:ke[e],value:e})))}],Se={authorization_code:new Set(["tokenName","grant_type","redirect_uri","authUrl","accessTokenUrl","clientId","clientSecret","scope","state","client_authentication"]),authorization_code_with_pkce:new Set(["tokenName","grant_type","redirect_uri","authUrl","accessTokenUrl","clientId","clientSecret","challengeAlgorithm","code_verifier","scope","state","client_authentication"]),implicit:new Set(["tokenName","grant_type","redirect_uri","authUrl","clientId","scope","state","client_authentication"]),password_credentials:new Set(["tokenName","grant_type","accessTokenUrl","clientId","clientSecret","username","password","scope","client_authentication"]),client_credentials:new Set(["tokenName","grant_type","accessTokenUrl","clientId","clientSecret","scope","client_authentication"])};var Re=a(29875);const Pe=new Re.KVStorage("oauth2-access-tokens"),Ie="access-tokens",Oe=async e=>{const t=await Pe.get(Ie);return t?t[e]:null},qe=async()=>await Pe.get(Ie)||{},Ue=async(e,t)=>{const a=(n=t,JSON.parse(JSON.stringify(n)));var n;let s=await Pe.get(Ie);return s||(s={}),s[e]=a,Pe.set(Ie,s)},Ne=async e=>{let t=await Pe.get(Ie);return t||(t={}),delete t[e],Pe.set(Ie,t)},Ee=async(e,t)=>{const a=await Pe.get(Ie);if(!a||a&&!a[e])return;const n=Object.assign({},a[e].data,t.data),s=Object.assign({},a[e],t);s.data=n,await Ue(e,s)},ze=e=>Pe.subscribe(Ie,e),He=()=>Pe,Fe=(e,t)=>{const a=[];for(const n of e)if(n){const e={key:n.key,value:n.value,enabled:n.enabled,send_as:t};n.options&&(e.send_as=n.options.value),a.push(e)}return a};function Ze(e){const t=[];for(const a of e)if(a){const e={key:a.key,value:a.value,type:"text",enabled:a.enabled};a.send_as&&(e.options={value:a.send_as,label:be[a.send_as]}),t.push(e)}return t}function Ve(e,t){if(!e||!Array.isArray(e))return;const a=e.find((e=>(null==e?void 0:e.key)===t&&!0===(null==e?void 0:e.enabled)));return null==a?void 0:a.value}function De(e,t){let a=t;for(const t of e)t.enabled&&(a=`${a}${a.includes("?")?"&":"?"}${t.key}=${t.value}`);return a}function Be(e,t){for(const a of e)if(a.enabled)switch(a.send_as){case ye:t.url=De([a],t.url);break;case ge:if(!a.key)continue;t.headerData.push({key:a.key,value:a.value,enabled:!0,type:"text"});break;default:t.data.push({key:a.key,value:a.value,enabled:!0,type:"text"})}return t}var Le=a(98276),Ke=a(77986);const We=e=>{var t;const a=null==e?void 0:e.timestamp,n=null==e||null==(t=e.data)?void 0:t.expires_in;if(a&&n)return Number(a)+1e3*Number(n)},Me=e=>e?{refresh_token:e.data.refresh_token||"",accessTokenUrl:e.data.accessTokenUrl||"",refreshTokenUrl:e.data.refreshTokenUrl||"",clientId:e.data.clientId||"",clientSecret:e.data.clientSecret||"",refreshRequestParams:e.data.refreshRequestParams||""}:null,$e=(e,t)=>{if(!e)return!1;t||(t=0);const a=We(e);return!!a&&a<Date.now()+1e3*t},Ge=e=>{if(!e)return!1;const t=Me(e);return(null==t?void 0:t.refresh_token)&&((null==t?void 0:t.refreshTokenUrl)||(null==t?void 0:t.accessTokenUrl))},Je=e=>!!e&&$e(e,59)&&(null==e?void 0:e.isTokenAutoRefreshEnabled)&&Ge(e),Qe=e=>{let t=e.toString("base64");return t=t.split("=")[0],t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t},Ye=e=>{for(const t of Object.keys(we))e[t]||(e[t]=oe()(we[t]));const{tokenName:t,grant_type:a,authUrl:n,accessTokenUrl:s,refreshTokenUrl:r,refresh_token:o,client_authentication:i,clientId:l,clientSecret:u,redirect_uri:c,scope:d,state:h,username:p,password:m,challengeAlgorithm:v,code_verifier:k,authRequestParams:y,tokenRequestParams:f,refreshRequestParams:g}=e;return{tokenName:t,grant_type:a,authUrl:n,accessTokenUrl:s,refreshTokenUrl:r,refreshToken:o,client_authentication:i,clientId:l,clientSecret:u,redirect_uri:c,scope:d,state:h,username:p,password:m,challengeAlgorithm:v,code_verifier:k,authRequestParams:y,tokenRequestParams:f,refreshRequestParams:g}},Xe=new Set(["iso-2022-cn","iso-2022-cn-ext"]),et="authorization_code",tt="authorization_code_with_pkce",at="implicit",nt="client_credentials",st=new class{constructor(){this.tokenGenerationCallback=null,this.tokenRefreshCallback=null,this.resolveVariablesPromise=null,this.resolveVariablesPromiseResolve=null,this.resolveVariablesPromiseReject=null,this.timeoutId=null,this.id=null,this.params=null,ue.VSCodeCommunicationsService.subscribe("OAUTH2_CALLBACK",(e=>{this.handleAuthCallback(e)})),ue.VSCodeCommunicationsService.subscribe("RESOLVED_VARIABLES",(e=>{var t;if(!e)return;const{id:a,resolvedObject:n}=e;a===this.id&&(null==(t=this.resolveVariablesPromiseResolve)||t.call(this,n))}))}async getResolvedParams(e,t,a){if(!t||0===t.length)return e;const n=function(){const e={};return e.promise=new Promise(((t,a)=>{e.resolve=t,e.reject=a})),e}();return this.resolveVariablesPromise=n.promise,this.resolveVariablesPromiseResolve=n.resolve,this.resolveVariablesPromiseReject=n.reject,(0,Le.resolveVariablesInObject)(e,t,a),setTimeout((()=>{var e;null==(e=this.resolveVariablesPromiseReject)||e.call(this,new Error("Failed to resolve variables"))}),1e4),this.resolveVariablesPromise}handleRedirectToBrowser(e){if(!e.startsWith("https")&&!e.startsWith("http"))return this.finishAuthorizationFlow(new Error("Invalid protocol for auth URL. Only HTTP and HTTPS protocol are allowed."));(0,j.openExternalLink)(e)}async startAuthorization(e,t,a){if(this.id)throw new Error("OAuth2 authorization already in progress");let n=e;if(this.id=(0,ie.v4)(),a)try{n=await this.getResolvedParams(oe()(e),a,this.id)}finally{this.resolveVariablesPromise=null,this.resolveVariablesPromiseResolve=null,this.resolveVariablesPromiseReject=null}var s;if(this.params=Ye(n),!this.params)return null==(s=this.finishAuthorizationFlow)?void 0:s.call(this,new Error("OAuth2 authorization params not provided"));switch(this.tokenGenerationCallback=t,this.timeoutId=setTimeout((()=>{this.finishAuthorizationFlow(new Error("OAuth2 authorization timed out"))}),3e4),this.params.grant_type){case et:case tt:return this.handleAuthorizationCodeType();case at:return this.handleImplicitType();case"password_credentials":return this.handlePasswordCredentialsType();case nt:return this.handleClientCredentialsType();default:var r;return null==(r=this.finishAuthorizationFlow)?void 0:r.call(this,new Error("Could not complete OAuth 2.0 authorization, grant type is invalid"))}}async refreshTokenByTokenId(e,t){const a=await Oe(e),n=a&&Me(a);n&&this.refreshToken(n,t)}async refreshToken(e,t){if(this.id)throw new Error("OAuth2 authorization already in progress");this.params=Ye(e);const a=(0,ie.v4)();var n;if(this.id=a,this.tokenRefreshCallback=t,!this.params)return null==(n=this.finishAuthorizationFlow)?void 0:n.call(this,new Error("OAuth2 authorization params not provided"));this.timeoutId=setTimeout((()=>{this.finishRefreshFlow(new Error("OAuth2 authorization timed out"))}),3e4);const s=this.params.refreshTokenUrl||this.params.accessTokenUrl,r=Ve(this.params.refreshRequestParams,"grant_type"),o=Ve(this.params.refreshRequestParams,"refresh_token"),i=this.getOAuth2TokenRequest(s);!o&&i.data.push({key:"refresh_token",value:this.params.refreshToken,enabled:!0,type:"text"}),!r&&i.data.push({key:"grant_type",value:"refresh_token",enabled:!0,type:"text"}),this.addClientAuthentication(i,this.params);const l=Be(this.params.refreshRequestParams,i);this.requestAccessToken(l,{refresh:!0})}handleClientCredentialsType(){const{params:e}=this;var t,a;if(!e)return null==(t=this.finishAuthorizationFlow)?void 0:t.call(this,new Error("OAuth2TokenFetcher: params not found"));if(!e.accessTokenUrl)return null==(a=this.finishAuthorizationFlow)?void 0:a.call(this,new Error("OAuth2TokenFetcher: tokenUrl not found"));const n=this.getOAuth2TokenRequest(e.accessTokenUrl),s=Ve(e.tokenRequestParams,"grant_type"),r=Ve(e.tokenRequestParams,"scope"),o=Ve(e.tokenRequestParams,"client_id"),i=Ve(e.tokenRequestParams,"client_secret");!s&&n.data.push({key:"grant_type",value:nt,type:"text",enabled:!0}),!r&&n.data.push({key:"scope",value:e.scope,type:"text",enabled:!0}),(!o||!i)&&this.addClientAuthentication(n,e);const l=Be(e.tokenRequestParams,n);this.requestAccessToken(l)}handlePasswordCredentialsType(){const{params:e}=this;var t,a;if(!e)return null==(t=this.finishAuthorizationFlow)?void 0:t.call(this,new Error("OAuth2TokenFetcher: params not found"));if(!e.accessTokenUrl||"string"!=typeof e.accessTokenUrl)return null==(a=this.finishAuthorizationFlow)?void 0:a.call(this,new Error("OAuth2TokenFetcher: tokenUrl not found"));const n=this.getOAuth2TokenRequest(e.accessTokenUrl),s=Ve(e.tokenRequestParams,"grant_type"),r=Ve(e.tokenRequestParams,"username"),o=Ve(e.tokenRequestParams,"password"),i=Ve(e.tokenRequestParams,"scope"),l=Ve(e.tokenRequestParams,"client_id"),u=Ve(e.tokenRequestParams,"client_secret"),c=Ve(e.tokenRequestParams,"redirect_uri");(!l||!u)&&this.addClientAuthentication(n,e),!s&&n.data.push({key:"grant_type",value:"password",type:"text",enabled:!0}),!r&&n.data.push({key:"username",value:e.username,type:"text",enabled:!0}),!o&&n.data.push({key:"password",value:e.password,type:"text",enabled:!0}),!i&&n.data.push({key:"scope",value:e.scope,type:"text",enabled:!0}),!c&&n.data.push({key:"redirect_uri",value:e.redirect_uri,type:"text",enabled:!0});const d=Be(e.tokenRequestParams,n);this.requestAccessToken(d)}handleAuthorizationCodeType(){if(!this.params)return;let e=this.params.authUrl;if(!e)return this.finishAuthorizationFlow(new Error("Auth URL not found"));const t=Ve(this.params.authRequestParams,"response_type"),a=Ve(this.params.authRequestParams,"client_id"),n=Ve(this.params.authRequestParams,"state"),s=Ve(this.params.authRequestParams,"scope"),r=Ve(this.params.authRequestParams,"redirect_uri");if(e+=e.includes("?")?"&":"?",!t&&(e+=`response_type=${encodeURIComponent("code")}`),!a&&(e+=`&client_id=${encodeURIComponent(this.params.clientId)}`),!n&&this.params.state&&(e+=`&state=${encodeURIComponent(this.params.state)}`),!s&&this.params.scope&&(e+=`&scope=${encodeURIComponent(this.params.scope)}`),!r&&this.params.redirect_uri&&(e+=`&redirect_uri=${encodeURIComponent(this.params.redirect_uri)}`),this.params.grant_type===tt){const t=Ve(this.params.authRequestParams,"code_challenge"),a=Ve(this.params.authRequestParams,"code_challenge_method");this.params.code_verifier=this.params.code_verifier||((e=32)=>{const t=ce.O6(e);return Qe(t)})(),!t&&(e+=`&code_challenge=${encodeURIComponent(((e,t)=>{if(!e||"plain"===t)return e||"";const a=ce.js("sha256").update(e).digest();return Qe(a)})(this.params.code_verifier,this.params.challengeAlgorithm))}`),!a&&(e+=`&code_challenge_method=${encodeURIComponent(this.params.challengeAlgorithm)}`)}e=De(this.params.authRequestParams,e),this.handleRedirectToBrowser(e)}handleImplicitType(){if(!this.params)return;let e=this.params.authUrl;const t=Ve(this.params.authRequestParams,"response_type"),a=Ve(this.params.authRequestParams,"client_id"),n=Ve(this.params.authRequestParams,"state"),s=Ve(this.params.authRequestParams,"scope"),r=Ve(this.params.authRequestParams,"redirect_uri");e+=e.includes("?")?"&":"?",!t&&(e+=`response_type=${encodeURIComponent("token")}`),!a&&(e+=`&client_id=${encodeURIComponent(this.params.clientId)}`),!n&&this.params.state&&(e+=`&state=${encodeURIComponent(this.params.state)}`),!s&&this.params.scope&&(e+=`&scope=${encodeURIComponent(this.params.scope)}`),!r&&this.params.redirect_uri&&(e+=`&redirect_uri=${encodeURIComponent(this.params.redirect_uri)}`),e=De(this.params.authRequestParams,e),this.handleRedirectToBrowser(e)}handleAuthCallback(e){if(!this.params||!this.id)return;var t,a,n,s;if(this.params.grant_type===at)return e.access_token?null==(t=this.finishAuthorizationFlow)?void 0:t.call(this,null,e):null==(a=this.finishAuthorizationFlow)?void 0:a.call(this,new Error("OAuth2TokenFetcher~Implicit: access_token not found"));if(!e.code)return null==(n=this.finishAuthorizationFlow)?void 0:n.call(this,new Error("OAuth2TokenFetcher: code not found"));if(!this.params.accessTokenUrl)return null==(s=this.finishAuthorizationFlow)?void 0:s.call(this,new Error("OAuth2TokenFetcher: tokenUrl not found"));const r=Ve(this.params.tokenRequestParams,"grant_type"),o=Ve(this.params.tokenRequestParams,"client_id"),i=Ve(this.params.tokenRequestParams,"client_secret"),l=Ve(this.params.tokenRequestParams,"redirect_uri"),u=Ve(this.params.tokenRequestParams,"code_verifier"),c=Ve(this.params.tokenRequestParams,"code"),d=this.getOAuth2TokenRequest(this.params.accessTokenUrl);!r&&d.data.push({key:"grant_type",value:et,type:"text",enabled:!0}),!c&&d.data.push({key:"code",value:e.code,type:"text",enabled:!0}),!l&&d.data.push({key:"redirect_uri",value:this.params.redirect_uri,type:"text",enabled:!0}),this.params.grant_type===tt&&!u&&d.data.push({key:"code_verifier",value:this.params.code_verifier,type:"text",enabled:!0}),(!o||!i)&&this.addClientAuthentication(d,this.params);const h=Be(this.params.tokenRequestParams,d);this.requestAccessToken(h)}addClientAuthentication(e,t){if("body"!==t.client_authentication)e.auth={type:"basic",basic:[{key:"username",value:t.clientId},{key:"password",value:t.clientSecret}]};else{if(e.data.push({key:"client_id",value:t.clientId,enabled:!0,type:"string"}),t.grant_type===tt&&!t.clientSecret)return;e.data.push({key:"client_secret",value:t.clientSecret,enabled:!0,type:"string"})}}getOAuth2TokenRequest(e){if(!this.params||!this.id)throw new Error("OAuth2TokenFetcher: params or id not found");return{id:this.id,method:"POST",dataMode:"urlencoded",url:e,headerData:[{key:"Content-Type",value:"application/x-www-form-urlencoded",type:"text",enabled:!0}],auth:{type:"noauth"},data:[]}}finishAuthorizationFlow(e,t){var a;if(!this.id||!this.params)throw new Error("OAuth2TokenFetcher: params or id not found");const n=this.params.tokenName||"Untitled Token",s=this.params.accessTokenUrl,r=this.params.refreshTokenUrl,o=this.params.clientId,i=this.params.clientSecret,l=this.params.refreshRequestParams;var u,c;if(this.id=null,this.params=null,this.timeoutId&&clearTimeout(this.timeoutId),e)return null==(u=this.tokenGenerationCallback)?void 0:u.call(this,e);if(!t)return null==(c=this.tokenGenerationCallback)?void 0:c.call(this,new Error("OAuth2TokenFetcher: authResponse not found"));const d={name:n||"Untitled Token",id:(0,ie.v4)(),timestamp:Date.now(),data:Object.assign({},t,{accessTokenUrl:s,clientId:o,clientSecret:i,refreshRequestParams:l,refreshTokenUrl:r})};null==(a=this.tokenGenerationCallback)||a.call(this,null,d)}finishRefreshFlow(e,t){var a;if(this.id||this.params){var n,s;if(this.id=null,this.params=null,e)return null==(n=this.tokenRefreshCallback)?void 0:n.call(this,e);if(this.timeoutId&&clearTimeout(this.timeoutId),!t)return null==(s=this.tokenRefreshCallback)?void 0:s.call(this,new Error("OAuth2TokenFetcher: authResponse not found"));null==(a=this.tokenRefreshCallback)||a.call(this,null,t)}}async requestAccessToken(e,t){var a=this;(0,le.sendRequestViaAgent)(e,{variables:{},runOptionsOverrides:{timeout:{global:null,request:3e4,script:null}},exception:({error:e})=>null!=t&&t.refresh?this.finishRefreshFlow(e):this.finishAuthorizationFlow(e),response:async function({error:e,response:n}){if(e)return null!=t&&t.refresh?a.finishRefreshFlow(e):void a.finishAuthorizationFlow(e);if(!n||!n.stream)return null!=t&&t.refresh?a.finishRefreshFlow(new Error("OAuth2TokenFetcher: response not found")):a.finishAuthorizationFlow(new Error("OAuth2TokenFetcher: response not found"));n.stream instanceof ArrayBuffer&&(n.stream=new Uint8Array(n.stream));const s=(r=n.stream,o=n.contentInfo.charset,Xe.has(o)?"":("utf-16"===o&&r.length>=2&&254===r[0]&&255===r[1]&&(o="utf-16be"),new TextDecoder(o||"utf8").decode(r)));var r,o;return null!=t&&t.refresh?a.finishRefreshFlow(null,JSON.parse(s)):a.finishAuthorizationFlow(null,JSON.parse(s))},console:()=>null,start:()=>null,responseStart:()=>null,assertion:()=>null,script:()=>null})}},rt=()=>{const{value:e,setValue:t}=(0,Re.useKVStorage)(He(),Ie),a=(a,n)=>{const s=null==e?void 0:e[a];if(s){for(const e of Object.keys(n.data))s.data[e]=n.data[e];return n.name&&(s.name=n.name),n.timestamp&&(s.timestamp=n.timestamp),e[a]=s,t(e)}};return{oAuth2Tokens:e,createOAuth2Token:(a,n)=>{const s=e||{};return s[a]=n,t(s)},updateOAuth2Token:a,updateKeyInOAuth2Token:(t,n,s)=>{const r=null==e?void 0:e[t];r&&(r.data[n]=s,a(t,r))},deleteOAuth2TokenById:a=>{if(null==e?void 0:e[a])return delete e[`${a}`],t(e)},deleteAllOAuth2Token:()=>t({}),deleteAllExpiredOAuth2Token:()=>{if(e){for(const[t,a]of Object.entries(e))$e(a)&&delete e[`${t}`];return t(e)}}}},ot=o()(l.Z).withConfig({displayName:"oauth2-standard-wrappers__OAuth2AuthWrapper",componentId:"sc-nw4etj-0"})(["align-items:center;padding-top:var(--spacing-s);padding-bottom:var(--spacing-s);max-width:500px;"]),it=o().div.withConfig({displayName:"oauth2-standard-wrappers__OAuth2AuthContentWrapper",componentId:"sc-nw4etj-1"})(["flex:1;"]),lt=()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,n=(e,n)=>{if(!e)return a(Object.assign({},t,{oauth2:t.oauth2.filter((e=>e.key!==n))}));const s=[...t.oauth2],r=s.findIndex((e=>e.key===n));if(-1===r)return a(Object.assign({},t,{oauth2:[...t.oauth2,{key:n,value:e}]}));const o=[...s];return o[r]={key:s[r].key,value:e},a(Object.assign({},t,{oauth2:o}))},r=e=>{var a;return(null==(a=t.oauth2.find((t=>t.key===e)))?void 0:a.value)||we[e]},o=(e,s,o,i,l)=>"redirect_uri"===e?(0,m.jsx)(v,{onChange:e=>{n(e.target.value,e.target.name)},name:e,value:r(e),placeholder:s,isDisabled:l}):"select"===o?i&&0!==(null==i?void 0:i.length)?(0,m.jsx)(y,{isClearable:!1,options:i,value:{value:r(e),label:xe[e][r(e)]},onChange:n=>{((e,n)=>{if(!n.value)return a(Object.assign({},t,{oauth2:t.oauth2.filter((t=>t.key!==e))}));const s=[...t.oauth2],r=s.findIndex((t=>t.key===e));if(-1===r)return a(Object.assign({},t,{oauth2:[...t.oauth2,{key:e,value:n.value}]}));const o=[...s];o[r]={key:s[r].key,value:n.value},a(Object.assign({},t,{oauth2:o}))})(e,n)},name:e,"aria-label":"add auth to",viaPortal:!0,isDisabled:!1,isSearchable:!1}):null:(0,m.jsx)(k,{onChange:(e,t)=>{n(e,t)},name:e,value:r(e),label:s});return(0,m.jsx)(m.Fragment,{children:Ce.filter((({key:e})=>Se[r("grant_type")].has(e))).map((({key:e,label:t,type:a,options:n,disabled:s})=>(0,m.jsxs)(ot,{"data-testid":`oauth2-input-${e}`,children:[(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:t})}),(0,m.jsx)(it,{children:o(e,t,a,n,s)})]},e)))})};var ut=a(35736),ct=a(35482),dt=a(70068),ht=a(56880);const pt=o().div.withConfig({displayName:"oauth2-refresh-cta__StyledRefreshCTAWrapper",componentId:"sc-p5t6o7-0"})(["display:flex;margin-top:var(--spacing-xs);align-items:center;justify-content:left;"]),mt=o()(h.ZP).withConfig({displayName:"oauth2-refresh-cta__StyledExpiryInfoWrapper",componentId:"sc-p5t6o7-1"})(["margin-left:var(--spacing-xs);margin-right:var(--spacing-xs);"]),vt=o()(ut.Z).withConfig({displayName:"oauth2-refresh-cta__StyledSpinner",componentId:"sc-p5t6o7-2"})(["margin-left:var(--spacing-xs);"]),kt=()=>{var e,t;const a=s().useContext(ma).authSessionState,[r,o]=(0,n.useState)(!1),{oAuth2Tokens:i,updateOAuth2Token:l}=rt(),u=null==(e=a.oauth2)||null==(e=e.find((e=>"token_id"===e.key)))?void 0:e.value,c=u?null==i?void 0:i[u]:null,d=(e,t)=>{if(e)return void o(!1);if(!t)return void o(!1);const a=c;a&&(a.data=Object.assign({},a.data,t.access_token&&{access_token:t.access_token},t.id_token&&{id_token:t.id_token},t.refresh_token&&{refresh_token:t.refresh_token},t.expires_in&&{expires_in:t.expires_in},t.token_type&&{token_type:t.token_type}),a.timestamp=Date.now(),l(a.id,a),o(!1),ht.AnalyticsService.addEventV2({category:"authorization",action:"manual_token_refresh_successful",label:"oauth2"}))},p=()=>{if(!c)return;const e=Me(c);e?(o(!0),st.refreshToken(e,d),ht.AnalyticsService.addEventV2({category:"authorization",action:"manual_token_refresh",label:"oauth2"})):o(!1)};if(null==c||null==(t=c.data)||!t.refresh_token)return null;const v=We(c)||0,k=Date.now(),y=Me(c),f=Ge(c);if(!y||!f)return;if(r)return(0,m.jsxs)(pt,{children:[(0,m.jsx)(h.ZP,{hasBottomSpacing:!0,color:"content-color-secondary",children:"Refreshing token"}),(0,m.jsx)(vt,{})]});if(!v)return(0,m.jsx)(pt,{children:(0,m.jsx)(h.ZP,{type:"link-default",hasBottomSpacing:!0,children:(0,m.jsx)("div",{onClick:p,children:"Refresh"})})});const g=Number(v),b=new Date(g).toDateString()===new Date(k).toDateString();let x=null;if($e(c))x=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ct.Z,{name:"icon-state-error-stroke",color:"content-color-error"}),(0,m.jsx)(mt,{hasBottomSpacing:!0,color:"content-color-error",children:"Token expired."})]});else if(b){const e=(e=>`Expires at ${(0,Ke.format)(e,"h:mm aaaa")} today.`)(g);x=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(dt.Z,{color:"content-color-secondary"}),(0,m.jsx)(mt,{hasBottomSpacing:!0,color:"content-color-secondary",children:e})]})}return(0,m.jsxs)(pt,{children:[x,(0,m.jsx)(h.ZP,{type:"link-default",hasBottomSpacing:!0,children:(0,m.jsx)("div",{onClick:p,children:"Refresh"})})]})},yt=()=>{var e,t;const a=s().useContext(ma).authSessionState,{oAuth2Tokens:n,updateKeyInOAuth2Token:r}=rt(),o=null==(e=a.oauth2)||null==(e=e.find((e=>"token_id"===e.key)))?void 0:e.value,i=o?null==n?void 0:n[o]:null,l=(null==i||null==(t=i.data)?void 0:t.token_key)||je;if(null!=i&&i.data[Te])return(0,m.jsxs)(ot,{"data-testid":"oauth2-input-token-key",children:[(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Token Type"})}),(0,m.jsx)(it,{children:(0,m.jsx)(y,{isClearable:!1,options:Object.keys(Ae).map((e=>({value:e,label:Ae[e],isOptionDisabled:e=>{var t;return null==i||null==(t=i.data)?void 0:t[null==e?void 0:e.value]}}))),placeholder:"Select Token Type",value:{value:l,label:Ae[l]},onChange:e=>(e=>{i&&r(i.id,"token_key",e.value)})(e),name:"token","aria-label":"Select token",viaPortal:!0,isDisabled:!1,isSearchable:!1})})]},"token_key")};var ft=a(56415),gt=a(3341);const bt=o().div.withConfig({displayName:"auth-advanced-toggle__StyledAdvancedToggleWrapper",componentId:"sc-gvkwux-0"})(["display:flex;align-items:center;cursor:pointer;margin-bottom:var(--spacing-xs);margin-top:var(--spacing-xs);"]),xt=e=>{const{onToggleAdvancedFields:t,title:a,isOpen:n}=e;return(0,m.jsxs)(bt,{onClick:()=>t(),children:[n?(0,m.jsx)(ft.Z,{}):(0,m.jsx)(gt.Z,{}),(0,m.jsx)("div",{children:(0,m.jsx)(u.Z,{type:"primary",text:a||"Advanced configuration"})})]})};var _t=a(19956);const Tt=()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,n=(e,n)=>{const s=[...t.oauth2],r=s.findIndex((t=>t.key===e));return-1===r||(s[r].value=n,a(Object.assign({},t,{oauth2:s}))),a(Object.assign({},t,{oauth2:[...t.oauth2,{key:e,value:n}]}))},r=e=>{var a;return(null==(a=t.oauth2.find((t=>t.key===e)))?void 0:a.value)||we[e]},o=r("authRequestParams"),i=r("tokenRequestParams"),u=r("refreshRequestParams"),c=Object.keys(be).map((e=>({value:e,label:be[e]}))),d=r("grant_type"),h=[de,he,pe].includes(d),p=d!==pe;return(0,m.jsxs)(l.Z,{direction:"column",children:[(0,m.jsxs)(ot,{"data-testid":"oauth2-input-refreshTokenUrl",children:[(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Refresh Token URL"})}),(0,m.jsx)(it,{children:(0,m.jsx)(k,{onChange:(e,n)=>{((e,n)=>{if(!e)return a(Object.assign({},t,{oauth2:t.oauth2.filter((e=>e.key!==n))}));const s=[...t.oauth2],r=s.findIndex((e=>e.key===n));if(-1===r)return a(Object.assign({},t,{oauth2:[...t.oauth2,{key:n,value:e}]}));s[r].value=e,a(Object.assign({},t,{oauth2:s}))})(e,n)},name:"refreshTokenUrl",value:r("refreshTokenUrl"),label:r("refreshTokenUrl")||"Enter Refresh Token URL"})})]},"refreshTokenUrl"),h&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ot,{"data-testid":"oauth2-input-authRequestParams",children:(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Auth Request"})})},"authRequestParams"),(0,m.jsx)(it,{children:(0,m.jsx)(_t.KeyValueEditor,{tableName:"Auth Request",allowedColumns:["key","value"],showColumns:["key","value"],values:Ze(o),onChange:e=>{n("authRequestParams",Fe(e,ye))},disableSorting:!0,nonEditableKeys:!1,nonEditableValues:!1,nonEditableToggles:!1,disableBulkEdit:!0,enableVariableSuggestions:!0,optionsDropdownValues:[{label:"Text",value:"text"}]})})]}),p&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(ot,{"data-testid":"oauth2-input-tokenRequestParams",children:(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Token Request"})})},"tokenRequestParams"),(0,m.jsx)(it,{children:(0,m.jsx)(_t.KeyValueEditor,{tableName:"Token Request",allowedColumns:["key","value","options"],showColumns:["key","value","options"],values:Ze(i),onChange:e=>{n("tokenRequestParams",Fe(e,fe))},disableSorting:!0,nonEditableKeys:!1,nonEditableValues:!1,nonEditableToggles:!1,disableBulkEdit:!0,enableVariableSuggestions:!0,optionsDropdownValues:c})})]}),(0,m.jsx)(ot,{"data-testid":"oauth2-input-refreshRequestParams",children:(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Refresh Request"})})},"refreshRequestParams"),(0,m.jsx)(it,{children:(0,m.jsx)(_t.KeyValueEditor,{tableName:"Refresh Request",allowedColumns:["key","value","options"],showColumns:["key","value","options"],values:Ze(u),onChange:e=>{n("refreshRequestParams",Fe(e,fe))},disableSorting:!0,nonEditableKeys:!1,nonEditableValues:!1,nonEditableToggles:!1,disableBulkEdit:!0,enableVariableSuggestions:!0,optionsDropdownValues:c})})]})};var jt=a(10099);const At=o().div.withConfig({displayName:"oauth2__StyledLine",componentId:"sc-16h4gio-0"})(["border-bottom:1px solid var(--border-color-default);"]),wt=o()($.Z).withConfig({displayName:"oauth2__StyledHeading",componentId:"sc-16h4gio-1"})(["margin-top:var(--spacing-m);margin-bottom:var(--spacing-m);"]),Ct=o()(l.Z).withConfig({displayName:"oauth2__StyledToken",componentId:"sc-16h4gio-2"})(["padding-right:var(--spacing-l);flex:1;overflow:hidden;text-overflow:ellipsis;display:block;word-break:break-all;white-space:nowrap;"]),St=o().div.withConfig({displayName:"oauth2__StyledManageTokenCTAWrapper",componentId:"sc-16h4gio-3"})(["display:flex;margin-top:var(--spacing-xs);align-items:center;justify-content:left;"]),Rt=o().div.withConfig({displayName:"oauth2__StyledAutoRefreshTokenToggleWrapper",componentId:"sc-16h4gio-4"})(["margin-top:var(--spacing-xxl);"]),Pt=o().div.withConfig({displayName:"oauth2__StyledAutoRefreshTokenToggle",componentId:"sc-16h4gio-5"})(["margin-top:var(--spacing-l);margin-right:var(--spacing-l);display:flex;justify-content:space-between;"]),It=o().div.withConfig({displayName:"oauth2__StyledShareTokenRadioButtons",componentId:"sc-16h4gio-6"})(["margin-top:var(--spacing-l);margin-right:var(--spacing-l);display:flex;justify-content:space-between;"]),Ot=o().div.withConfig({displayName:"oauth2__StyledSharedTokenMenuOption",componentId:"sc-16h4gio-7"})(["display:flex;justify-content:space-between;width:100%;padding-right:var(--spacing-s);align-items:center;"]),qt=()=>{var e;const t=s().useContext(ma),a=t.authState,r=t.authSessionState,o=t.setAuthSessionState,i=t.setAuthState,[l,u]=(0,n.useState)(!1),c=se.Modals.getModals(),d=(0,n.useRef)(null),[p,g]=(0,n.useState)(null),[b,x]=(0,n.useState)(!1),{oAuth2Tokens:_,createOAuth2Token:A,updateKeyInOAuth2Token:w,updateOAuth2Token:C}=rt(),{data:S}=(0,Le.useActiveAndDynamicVariables)(),{addToast:R}=(0,G.ZP)(),P=null==r||null==(e=r.oauth2)||null==(e=e.find((e=>"token_id"===e.key)))?void 0:e.value,I=P?null==_?void 0:_[P]:null,O=e=>{o("token_id",e)};(0,n.useEffect)((()=>{g(null)}),[_,r]);const q=(0,jt.useActiveWorkspaceId)(),U=(0,j.useNavigate)(),N=e=>{const t=a.oauth2.filter((e=>!("tokenType"===e.key||"accessToken"===e.key)));if(!e)return i(Object.assign({},a,{oauth2:t}));t.push({key:"tokenType",value:e.tokenType},{key:"accessToken",value:e.accessToken}),i(Object.assign({},a,{oauth2:t}))},E=e=>{var t;return(null==(t=a.oauth2.find((t=>t.key===e)))?void 0:t.value)||we[e]},z=(e,t)=>t?t.data.error?(u(!1),void R({status:"error",description:"Authentication failed"})):(R({status:"success",description:"Authentication successful"}),A(t.id,t),(e=>{e&&O(e.id)})(t),u(!1),void ht.AnalyticsService.addEventV2({category:"authorization",action:"get_access_token_successful",label:"oauth2"})):(u(!1),void R({status:"error",description:"Authentication failed"})),H=()=>{var e;let t=(null==I||null==(e=I.data)?void 0:e.token_key)===Te?I.data.id_token:null==I?void 0:I.data.access_token;return P===T&&(t=E("accessToken")),null!==p?p:t},F=()=>I&&null!=I&&I.data.access_token&&(null==I?void 0:I.data.access_token)===E("accessToken")||P===T&&E("accessToken")?"yes":"no",Z=()=>I&&void 0!==I?{value:null==I?void 0:I.id,label:null==I?void 0:I.name}:P&&P===T&&Boolean(E("accessToken"))?{value:T,label:"Shared Token"}:null;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(ot,{"data-testid":"oauth2-input-tokens",children:[(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Token"})}),(0,m.jsxs)(it,{children:[(0,m.jsx)(y,{isClearable:!1,options:(()=>{let e=[];return e=Object.values(_||{}).map((e=>({value:e.id,label:e.name}))),E("accessToken")&&(e=[{value:T,label:"Shared Token"},...e]),0===e.length?[]:e})(),placeholder:"Available Tokens",customOptionComponent:e=>{const{label:t,value:a}=e;return a===T?(0,m.jsxs)(Ot,{children:[t,(0,m.jsx)(te.Z,{color:"content-color-success"})]}):(0,m.jsxs)(Ct,{children:[" ",t," "]})},value:Z(),onChange:e=>{null!=e&&e.value&&O(e.value)},name:"token","aria-label":"Select token",viaPortal:!0,isDisabled:!1,isSearchable:!1},`${Z()}`),(0,m.jsx)(St,{children:(0,m.jsx)(h.ZP,{type:"link-default",hasBottomSpacing:!0,children:(0,m.jsx)("div",{onClick:()=>{U(`/workspace/${q}/openManageTokensTab`,{},{customNavEvent:j.OPEN_EXTENSION_URL})},children:"Manage Tokens"})})})]})]},"token"),yt(),(0,m.jsxs)(ot,{"data-testid":"oauth2-input-token_value",children:[(0,m.jsx)(it,{}),(0,m.jsxs)(it,{children:[(0,m.jsx)(v,{onChange:e=>{const t=e.target.value;g(t),d.current&&clearTimeout(d.current);const a=setTimeout((()=>{(e=>{var t;let a=I;if(!a)return a={id:(0,ie.v4)(),name:"Untitled Token",timestamp:Date.now(),data:{[je]:e,token_type:"Bearer"}},A(a.id,a),O(a.id);const n=(null==I||null==(t=I.data)?void 0:t.token_key)===Te?Te:je;w(a.id,n,e)})(t),d.current=null}),1e3);d.current=a},name:"access_token",value:H(),placeholder:"Enter Token Here",isDisabled:!1}),kt()]})]},"token_value"),(0,m.jsxs)(ot,{"data-testid":"oauth2-input-headerPrefix",children:[(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Header Prefix"})}),(0,m.jsx)(it,{children:(0,m.jsx)(k,{onChange:(e,t)=>{((e,t)=>{if(!e)return i(Object.assign({},a,{oauth2:a.oauth2.filter((e=>e.key!==t))}));const n=[...a.oauth2],s=n.findIndex((e=>e.key===t));if(-1===s)return i(Object.assign({},a,{oauth2:[...a.oauth2,{key:t,value:e}]}));n[s].value=e,i(Object.assign({},a,{oauth2:n}))})(e,t)},name:"headerPrefix",value:E("headerPrefix")||"Bearer",label:"Enter Prefix Here"})})]},"headerPrefix"),(0,m.jsxs)(ot,{"data-testid":"oauth2-input-addTokenTo",children:[(0,m.jsx)(it,{children:(0,m.jsx)(f,{children:"Add authorization data to"})}),(0,m.jsx)(it,{children:(0,m.jsx)(y,{isClearable:!1,options:Object.keys(_e).map((e=>({value:e,label:_e[e]}))),value:{value:E("addTokenTo"),label:_e[E("addTokenTo")]},onChange:e=>{((e,t)=>{if(!t.value)return i(Object.assign({},a,{oauth2:a.oauth2.filter((t=>t.key!==e))}));const n=[...a.oauth2],s=n.findIndex((t=>t.key===e));if(-1===s)return i(Object.assign({},a,{oauth2:[...a.oauth2,{key:e,value:t.value}]}));n[s].value=t.value,i(Object.assign({},a,{oauth2:n}))})("addTokenTo",e)},name:"addTokenTo","aria-label":"add auth to",viaPortal:!0,isDisabled:!1,isSearchable:!1})})]},"addTokenTo"),(0,m.jsxs)(Rt,{children:[(0,m.jsxs)(Pt,{children:[(0,m.jsx)($.Z,{type:"h6",text:"Auto-refresh token",color:"content-color-secondary"}),(()=>{const e=P?null==_?void 0:_[P]:null,t=e&&Ge(e),a=(0,m.jsx)(J.Z,{name:"Refresh Token",onChange:t=>{const a=e;a&&(a.isTokenAutoRefreshEnabled=t,C(P,a))},isDisabled:!t,isChecked:t&&e.isTokenAutoRefreshEnabled});if(t)return a;const n=e?Me(e):null;let s;return P===T&&Boolean(E("accessToken"))?s="Shared token cannot be auto-refreshed. Generate a new token to refresh it automatically on expire.":n?n.refresh_token?n.accessTokenUrl||(s="Access token URL is not present. Generate a new token to refresh it automatically on expire."):s="Refresh token is not present. Generate a new token to refresh it automatically on expire.":s="Select a token from available tokens to refresh it automatically on expire.",(0,m.jsx)(Q.Z,{content:s,children:a})})()]}),(0,m.jsx)(h.ZP,{type:"para",hasBottomSpacing:!0,color:"content-color-secondary",children:"Your expired token will be auto-refreshed before sending a request."})]}),(0,m.jsx)(At,{}),(0,m.jsxs)(It,{children:[(0,m.jsx)($.Z,{type:"h6",text:"Share Token",color:"content-color-secondary"}),(0,m.jsxs)(Y.Z,{name:"share-token",value:F(),onChange:async e=>{if(e===F())return;const t="yes"===e?"Sync Token":"Disable Token Sharing",a="yes"===e?"Sharing this token will allow anyone with access to this request to view and potentially use it.":"People with access to this request will no longer be able to see or use this token. They will be able to generate their own access token instead.",n="yes"===e?"Share":"Disable Share",s=await c.showWarningDialog({uid:"share-token",subject:t,message:a,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:n,isPrimary:!0}]});if(s&&"Share"===s.title){const e=I&&I.data.token_type,t=H();N({tokenType:"string"==typeof e?e:"",accessToken:"string"==typeof t?t:""})}else s&&"Disable Share"===s.title&&N()},children:[(0,m.jsx)(X.Z,{value:"yes",label:"Yes",id:"yes",isDisabled:!I&&P!==T||P===T&&!E("accessToken")}),(0,m.jsx)(X.Z,{value:"no",label:"No",id:"no",isDisabled:!I&&P!==T||P===T&&!E("accessToken")})]})]}),(0,m.jsx)(h.ZP,{type:"para",hasBottomSpacing:!0,color:"content-color-secondary",children:"This will allow anyone with access to this request to view and use it."}),(0,m.jsx)(At,{}),(0,m.jsx)(wt,{type:"h4",text:"Configure New Token"}),lt(),(0,m.jsx)(xt,{onToggleAdvancedFields:()=>{x(!b)},isOpen:b}),b&&Tt(),(0,m.jsx)(ot,{children:(0,m.jsx)(ee.Z,{onClick:()=>{const e={};for(const t of a.oauth2)e[t.key]=oe()(t.value);e.redirect_uri=ne().OAUTH2_CALLBACK_URL,u(!0),st.startAuthorization(e,z,S||[]).catch((()=>{u(!1),R({status:"error",description:"Authentication failed"})})),ht.AnalyticsService.addEventV2({category:"authorization",action:"get_access_token",label:"oauth2"})},type:"primary",text:"Generate Access Token",isLoading:l})})]})},Ut=(0,i.observer)((()=>(0,m.jsx)(G.VW,{children:(0,m.jsx)(qt,{})})));var Nt=a(49437),Et=a(80047);const zt=o()(l.Z).withConfig({displayName:"coming-soon__ComingSoonWrapper",componentId:"sc-1g7v7ck-0"})(["overflow:hidden;"]);function Ht({description:e}){return(0,m.jsx)(zt,{direction:"column",height:"100%",justifyContent:"center",alignItems:"center",children:(0,m.jsx)(Nt.Z,{title:"Coming Soon",description:e,children:(0,m.jsx)(Et.Z,{name:"illustration-no-custom-domain"})})})}const Ft=o()(l.Z).withConfig({displayName:"inherit__InheritAuthModeContainer",componentId:"sc-1fnmbns-0"})(["width:100%;height:100%;align-items:center;justify-content:center;"]),Zt=()=>{const e=s().useContext(ma).authDescriptions;return(0,m.jsx)(Ft,{children:(null==e?void 0:e.inherit)||"This request is inheriting auth from parent"})},Vt=o()(l.Z).withConfig({displayName:"aws-signature__AuthWrapper",componentId:"sc-1x9z6sr-0"})(["align-items:center;padding-top:var(--spacing-l);max-width:500px;"]),Dt=o()(l.Z).withConfig({displayName:"aws-signature__AdvanceToggle",componentId:"sc-1x9z6sr-1"})(["align-items:center;padding-top:var(--spacing-l);padding-bottom:var(--spacing-s);max-width:500px;margin-left:-4px;"]),Bt=o().div.withConfig({displayName:"aws-signature__AuthContentWrapper",componentId:"sc-1x9z6sr-2"})(["flex:1;"]),Lt=o()(d.Z).withConfig({displayName:"aws-signature__Select",componentId:"sc-1x9z6sr-3"})([".aether-dropdown__control:not(:focus){border-color:var(--border-color-default);background-color:var(--background-color-secondary);}.aether-dropdown__control .aether-dropdown__single-value{color:var(--content-color-secondary);font-weight:600;font-size:var(--text-size-s);}"]),Kt=[{key:"accessKey",label:"AccessKey",type:"text"},{key:"secretKey",label:"SecretKey",type:"text"}],Wt=[{key:"region",label:"AWS Region",type:"text",infoText:"The region that is receiving the request (default value: us-east-1)",placeHolder:"e.g. us-east-1"},{key:"service",label:"Service Name",type:"text",infoText:"The service that is receiving the request.",placeHolder:"e.g. s3"},{key:"sessionToken",label:"Session Token",type:"text",infoText:"Only required when using temporary security credentials.",placeHolder:"Session Token"}],Mt={key:"addAuthDataToQuery",label:"Add authorization data to",options:[{label:"Request Headers",value:!1},{label:"Request URL",value:!0}]},$t=(0,i.observer)((()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,r=(0,n.useCallback)(((e,n)=>{var s;if(!e)return a(Object.assign({},t,{awsv4:(null==(s=t.awsv4)?void 0:s.filter((e=>e.key!==n)))||null}));const r=[...t.awsv4||[]],o=r.findIndex((e=>e.key===n));if(-1===o)return a(Object.assign({},t,{awsv4:[...t.awsv4||[],{key:n,value:e}]}));r[o].value=e,a(Object.assign({},t,{awsv4:r}))}),[t,a]),o=e=>{var a;return(null==(a=t.awsv4)||null==(a=a.find((t=>t.key===e)))?void 0:a.value)||""},[i,l]=(0,n.useState)(!1);return(0,m.jsxs)(m.Fragment,{children:[Kt.map((({key:e,label:t,type:a})=>(0,m.jsxs)(Vt,{"data-testid":"aws-signature-basic-input",children:[(0,m.jsx)(Bt,{children:(0,m.jsx)(u.Z,{text:t})}),(0,m.jsx)(Bt,{children:(0,m.jsx)(k,{name:e,label:t,value:o(e),onChange:r,type:a})})]},e))),(0,m.jsxs)(Vt,{children:[(0,m.jsx)(Bt,{children:(0,m.jsx)(u.Z,{text:Mt.label})}),(0,m.jsx)(Bt,{children:(0,m.jsx)(Lt,{isClearable:!1,options:Mt.options,value:o("addAuthDataToQuery")?{label:"Request URL",value:!0}:{label:"Request Headers",value:!1},onChange:e=>r(e.value,"addAuthDataToQuery"),"aria-label":"add auth to",viaPortal:!0})})]}),(0,m.jsx)(Dt,{children:(0,m.jsx)(xt,{onToggleAdvancedFields:()=>{l(!i)},isOpen:i})}),i&&(0,m.jsx)(h.ZP,{type:"small",children:"Postman auto-generates default values for some of these fields unless a value is specified."}),i&&Wt.map((({key:e,label:t,type:a,infoText:n,placeHolder:s})=>(0,m.jsxs)(Vt,{"data-testid":"aws-signature-advance-input",children:[(0,m.jsx)(Bt,{children:(0,m.jsx)(u.Z,{text:t,infoText:n})}),(0,m.jsx)(Bt,{children:(0,m.jsx)(k,{name:e,label:s,value:o(e),onChange:r,type:a})})]},e)))]})}));var Gt=a(91217),Jt=a(65848);const Qt=o()(l.Z).withConfig({displayName:"oauth1__AuthWrapper",componentId:"sc-1jg4lk5-0"})(["align-items:center;padding-top:var(--spacing-l);max-width:500px;"]),Yt=o()(l.Z).withConfig({displayName:"oauth1__AdvanceToggle",componentId:"sc-1jg4lk5-1"})(["align-items:center;padding-top:var(--spacing-l);padding-bottom:var(--spacing-s);max-width:500px;margin-left:-4px;"]),Xt=o().div.withConfig({displayName:"oauth1__AuthContentWrapper",componentId:"sc-1jg4lk5-2"})(["flex:1;"]),ea=o()(d.Z).withConfig({displayName:"oauth1__Select",componentId:"sc-1jg4lk5-3"})([".aether-dropdown__control:not(:focus){border-color:var(--border-color-default);background-color:var(--background-color-secondary);}.aether-dropdown__control .aether-dropdown__single-value{color:var(--content-color-secondary);font-weight:600;font-size:var(--text-size-s);}"]),ta=o().div.withConfig({displayName:"oauth1__CheckboxWrapper",componentId:"sc-1jg4lk5-4"})(["display:flex;flex-direction:column;gap:var(--spacing-l);"]),aa=o().div.withConfig({displayName:"oauth1__StyledLine",componentId:"sc-1jg4lk5-5"})(["margin:var(--spacing-l) 0;border-bottom:1px solid var(--border-color-default);"]),na=o().label.withConfig({displayName:"oauth1__StyledFileUploaderLabel",componentId:"sc-1jg4lk5-6"})(["display:flex;gap:var(--spacing-s);user-select:none;color:var(--content-color-primary);font-size:var(--text-size-m);width:max-content;height:var(--size-s);line-height:1.8;vertical-align:middle;padding:var(--spacing-zero) var(--spacing-m);border:var(--button-outline-border);border-color:var(--button-outline-border-color);box-sizing:border-box;border-radius:var(--border-radius-default);&:hover{cursor:pointer;border-color:var(--button-outline-hover-border-color);}"]),sa=o()(Gt.Z).withConfig({displayName:"oauth1__StyledTextArea",componentId:"sc-1jg4lk5-7"})(["min-height:80px;"]),ra=[{key:"consumerKey",label:"Consumer Key",type:"text",infoText:"A value used by the Consumer to identify itself to the Service Provider",placeHolder:"Consumer Key"},{key:"consumerSecret",label:"Consumer Secret",type:"text",disableIfRSA:!0,infoText:"A secret used by the Consumer to establish ownership of the Consumer Key.",placeHolder:"Consumer Secret"},{key:"token",label:"Access Token",type:"text",placeHolder:"Access Token"},{key:"tokenSecret",label:"Token Secret",type:"text",disableIfRSA:!0,infoText:"A secret used by the Consumer to establish ownership of a given Token.",placeHolder:"Token Secret"}],oa=[{key:"callback",label:"Callback URL",type:"text",infoText:"An absolute URL where the service provider will redirect to after obtaining user authorization.",placeHolder:"Callback URL"},{key:"verifier",label:"Verifier",type:"text",infoText:"The verification code given by the service provider after obtaining user authorization.",placeHolder:"Verifier"},{key:"timestamp",label:"Timestamp",type:"text",placeHolder:"Timestamp"},{key:"nonce",label:"Nonce",type:"text",infoText:"A random string generated by the client.",placeHolder:"Nonce"},{key:"version",label:"Version",type:"text",placeHolder:"e.g. 1.0"},{key:"realm",label:"Realm",type:"text",infoText:"This is a string specified by the server in the WWW-Authenticate response header. It should contain at least the name of the host performing the authentication and might additionally indicate the collection of users who might have access",placeHolder:"testrealm@example.com"}],ia={key:"signatureMethod",label:"Signature Method",infoText:"The signature method the Consumer used to sign the request.",options:[{label:"HMAC-SHA1",value:"HMAC-SHA1"},{label:"HMAC-SHA256",value:"HMAC-SHA256"},{label:"HMAC-SHA512",value:"HMAC-SHA512"},{label:"RSA-SHA1",value:"RSA-SHA1"},{label:"RSA-SHA256",value:"RSA-SHA256"},{label:"RSA-SHA512",value:"RSA-SHA512"},{label:"PLAINTEXT",value:"PLAINTEXT"}]},la={key:"addParamsToHeader",label:"Add authorization data to",options:[{label:"Request Headers",value:"header"},{label:"Request Body/Request URL",value:"url"}]},ua=(0,i.observer)((()=>{const e=s().useContext(ma),t=e.authState,a=e.setAuthState,r=(0,n.useCallback)(((e,n)=>{var s;if(!e)return a(Object.assign({},t,{oauth1:(null==(s=t.oauth1)?void 0:s.filter((e=>e.key!==n)))||null}));const r=[...t.oauth1||[]],o=r.findIndex((e=>e.key===n));if(-1===o)return a(Object.assign({},t,{oauth1:[...t.oauth1||[],{key:n,value:e}]}));r[o].value=e,a(Object.assign({},t,{oauth1:r}))}),[t,a]),o=e=>{var a;return(null==(a=t.oauth1)||null==(a=a.find((t=>t.key===e)))?void 0:a.value)||""},[i,l]=(0,n.useState)(!1),c=()=>o("signatureMethod").includes("RSA");return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(Qt,{children:[(0,m.jsx)(Xt,{children:(0,m.jsx)(u.Z,{text:ia.label,infoText:ia.infoText})}),(0,m.jsx)(Xt,{children:(0,m.jsx)(ea,{isClearable:!1,options:ia.options,value:(()=>{const e=o("signatureMethod");return e?{label:e,value:e}:{label:"HMAC-SHA1",value:"HMAC-SHA1"}})(),onChange:e=>r(e.value,"signatureMethod"),"aria-label":"add auth to",viaPortal:!0})})]}),ra.map((({key:e,label:t,type:a,infoText:n,disableIfRSA:s})=>s&&c()?null:(0,m.jsxs)(Qt,{"data-testid":"oauth1-basic-input",children:[(0,m.jsx)(Xt,{children:(0,m.jsx)(u.Z,{text:t,infoText:n})}),(0,m.jsx)(Xt,{children:(0,m.jsx)(k,{name:e,label:t,value:o(e),onChange:r,type:a})})]},e))),c()&&(0,m.jsxs)(Qt,{children:[(0,m.jsx)(Xt,{children:(0,m.jsx)(u.Z,{text:"Private Key",infoText:"RSA private key in PEM format for signing the request."})}),(0,m.jsxs)(Xt,{children:[(0,m.jsx)("input",{type:"file",onChange:e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.addEventListener("load",(e=>{const t=e.target.result;r(t,"privateKey")})),e.readAsText(t)}},id:"upload",hidden:!0}),(0,m.jsx)(na,{htmlFor:"upload",children:(0,m.jsx)("span",{children:"Select file"})})]})]}),c()&&(0,m.jsxs)(Qt,{children:[(0,m.jsx)(Xt,{}),(0,m.jsx)(Xt,{children:(0,m.jsx)(sa,{value:o("privateKey"),onChange:e=>{r(e.target.value,"privateKey")},placeholder:"-----BEGIN RSA PRIVATE KEY-----\nprivate key in PEM format\n-----END RSA PRIVATE KEY-----"})})]}),(0,m.jsxs)(Qt,{children:[(0,m.jsx)(Xt,{children:(0,m.jsx)(u.Z,{text:la.label})}),(0,m.jsx)(Xt,{children:(0,m.jsx)(ea,{isClearable:!1,options:la.options,value:o("addParamsToHeader")?{label:"Request Headers",value:"headers"}:{label:"Request Body/Request URL",value:"url"},onChange:e=>"url"===(null==e?void 0:e.value)?r(!1,"addParamsToHeader"):r(!0,"addParamsToHeader"),"aria-label":"add auth to",viaPortal:!0})})]}),(0,m.jsx)(Yt,{children:(0,m.jsx)(xt,{onToggleAdvancedFields:()=>{l(!i)},isOpen:i})}),i&&(0,m.jsx)(h.ZP,{type:"small",children:"Postman auto-generates default values for some of these fields unless a value is specified."}),i&&oa.map((({key:e,label:t,type:a,infoText:n,placeHolder:s})=>(0,m.jsxs)(Qt,{"data-testid":"oauth1-advance-input",children:[(0,m.jsx)(Xt,{children:(0,m.jsx)(u.Z,{text:t,infoText:n})}),(0,m.jsx)(Xt,{children:(0,m.jsx)(k,{name:e,label:s,value:o(e),onChange:r,type:a})})]},e))),i&&(0,m.jsx)(aa,{}),i&&(0,m.jsxs)(ta,{children:[(0,m.jsx)(Jt.Z,{isChecked:o("includeBodyHash"),label:(0,m.jsx)(u.Z,{text:"Include body hash",infoText:"OAuth Request Body Hash extension provides support for request body integrity check for content types other than application/x-www-form-urlencoded. If this option is selected, the oauth_body_hash parameter will be calculated and added to the request."}),onChange:e=>{r(e,"includeBodyHash")}}),(0,m.jsx)(Jt.Z,{isChecked:o("addEmptyParamsToSign"),label:(0,m.jsx)(u.Z,{text:"Add empty parameters to signature",infoText:"Some implementations of OAuth1.0 require empty parameters to be added to the signature. If this option is selected, any of the above fields which have been left empty will be included in the authorization data."}),onChange:e=>{r(e,"addEmptyParamsToSign")}}),o("addParamsToHeader")&&(0,m.jsx)(Jt.Z,{isChecked:!o("disableHeaderEncoding")||!1,label:(0,m.jsx)(u.Z,{text:" Encode the parameters in the Authorization header"}),onChange:e=>{r(!e,"disableHeaderEncoding")}})]})]})})),ca=o().div.withConfig({displayName:"auth-mode-specific-panel__AuthModeSpecificPanelWrapper",componentId:"sc-ujmr36-0"})(["flex:0.65;padding:var(--spacing-m);overflow:auto;box-sizing:border-box;"]),da=(0,i.observer)((()=>{const e=s().useContext(ma),t=e.authState,a=S();if(a)return(0,m.jsx)(Ht,{description:`Support for ${(null==a?void 0:a.label)||"this auth method"} is coming soon.`});switch(t.activeAuthType){case"noauth":var n;return null==(n=e.authDescriptions)?void 0:n.noauth;case"bearer":return(0,m.jsx)(F,{});case"basic":return(0,m.jsx)(B,{});case"apikey":return(0,m.jsx)(M,{});case"inherit":return(0,m.jsx)(Zt,{});case"oauth2":return(0,m.jsx)(Ut,{});case"awsv4":return(0,m.jsx)($t,{});case"oauth1":return(0,m.jsx)(ua,{});default:return(0,m.jsx)(E,{})}})),ha=()=>(0,m.jsx)(ca,{children:(0,m.jsx)(da,{})}),pa=o().div.withConfig({displayName:"auth-panel__AuthPanelWrapper",componentId:"sc-14bce5s-0"})(["display:flex;min-height:0;flex:1;font-size:var(--text-size-m);color:var(--content-color-secondary);border-top:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"]),ma=s().createContext({}),va=e=>(0,m.jsx)(ma.Provider,{value:e,children:(0,m.jsxs)(pa,{className:"auth-editor",role:"tabpanel",children:[(0,m.jsx)(U,{}),(0,m.jsx)(ha,{})]})}),ka=({model:e,modelId:t})=>e&&t?[e,t].join("/"):"",ya=e=>{const t=String(e).split("/");if(2!==t.length)return"";const[a,n]=t;return a&&n?{model:a,modelId:n}:""},fa=new Re.KVStorage("auth-session"),ga=e=>fa.get(e),ba=e=>{const t=ka(e);return ga(t)},xa=e=>{const t=ka(e);return fa.has(t)},_a=(e,t)=>{const a=(n=t,JSON.parse(JSON.stringify(n)));var n;return fa.set(e,a)},Ta=(e,t)=>{const a=ka(e);return _a(a,t)},ja=e=>{const t=ka(e);return fa.remove(t)},Aa=(e,t)=>{const a=ka(e);return fa.subscribe(a,t)},wa=()=>fa,Ca=async e=>{var t;const a=await Oe(e);if(a)return[{key:"accessToken",value:(null==(t=a.data)?void 0:t.token_key)===Te?null==a?void 0:a.data[Te]:null==a?void 0:a.data[je]},{key:"tokenType",value:null==a?void 0:a.data.tokenType}]},Sa=async e=>{var t;const a=ka(e),n=await ga(a);if(!n)return;const s=null==(t=n.oauth2.find((e=>"token_id"===e.key)))?void 0:t.value;return{type:"oauth2",oauth2:await Ca(s)||[]}},Ra=async e=>{var t;const a=ka(e),n=await ga(a);if(n)return null==(t=n.oauth2.find((e=>"token_id"===e.key)))?void 0:t.value},Pa=async e=>({type:"oauth2",oauth2:await Ca(e)||[]}),Ia={id:"",type:"oauth2",oauth2:[]},Oa=e=>(0,Re.useKVStorage)(wa(),ka(e)),qa=({model:e,modelId:t})=>{const a=e&&t?ka({model:e,modelId:t}):"";return(0,Re.useKVStorage)(wa(),a)}},38087:()=>{},74854:()=>{},66602:()=>{}}]);
//# sourceMappingURL=9825.2849af34abadd5a8.js.map