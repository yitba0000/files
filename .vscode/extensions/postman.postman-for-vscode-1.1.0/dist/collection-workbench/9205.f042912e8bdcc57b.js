"use strict";(self.webpackChunkcollection_workbench=self.webpackChunkcollection_workbench||[]).push([[9205],{29205:(e,n,t)=>{t.r(n),t.d(n,{default:()=>be});var r=t(68367),o=t(39778),i=t(71534),a=t(34613),s=t(40505),l=t.n(s),c=t(59530),d=t.n(c),u=t(40540),p=t(21180),g=t(1765),v=t(76971);const f=(0,v.createCommand)();function x({onKeyPress:e}){const[n]=(0,g.useLexicalComposerContext)();return(0,u.useEffect)((()=>n.registerCommand(v.KEY_DOWN_COMMAND,(e=>(n.dispatchCommand(f,e),!1)),v.COMMAND_PRIORITY_LOW))),(0,u.useEffect)((()=>n.registerCommand(f,(n=>e(n)),v.COMMAND_PRIORITY_LOW)),[n,e]),null}function m(){const[e]=(0,g.useLexicalComposerContext)();return(0,u.useEffect)((()=>e.registerNodeTransform(v.LineBreakNode,(e=>{e.remove()}))),[e]),null}function b({onPaste:e}){const[n]=(0,g.useLexicalComposerContext)();return(0,u.useEffect)((()=>n.registerCommand(v.PASTE_COMMAND,(n=>(e(n),!1)),v.COMMAND_PRIORITY_LOW)),[n,e]),null}function h({onChange:e,value:n}){const[t]=(0,g.useLexicalComposerContext)();return(0,u.useEffect)((()=>t.registerTextContentListener((n=>{e(n)}))),[t,e]),(0,u.useEffect)((()=>{t.update((()=>{const e=(0,v.$getRoot)(),r=e.getTextContent();if(r===n||!r&&!n)return;const o=t.getRootElement()===document.activeElement;(0,v.$setSelection)(null);const i=e.getFirstChild(),a=(0,v.$createParagraphNode)(),s=(0,v.$createTextNode)(n);a.append(s),null==i||i.replace(a),o&&a.selectEnd()}))}),[t,n]),null}var y=t(21730),C=t.n(y),_=t(6443),E=t(19578),w=t(52322);const I=({domNode:e,value:n})=>{if(!e||!e.outerHTML)return null;e.className=n?"resolved-variable":"unresolved-variable";const t=(0,w.jsx)("span",{dangerouslySetInnerHTML:{__html:e.outerHTML}});return(0,w.jsx)(_.Z,{trigger:t,value:n})};class M extends v.TextNode{constructor(e,n,t){super(n,t),this.__variable=void 0,this.__variable=e}canInsertTextAfter(){return!1}createDOM(e){const n=super.createDOM(e),t=this.__variable,r=document.createElement("div"),o=(0,w.jsx)(E.ThemeContextProvider,{children:(0,w.jsx)(I,{value:t,domNode:n})});return C().render(o,r),r.firstChild}updateDOM(){return!0}}class j extends M{static getType(){return"unresolved-variable-node"}static clone(e){return new j(null,e.__text,e.__key)}}function O(e){return new j(null,e)}var k=t(98366);class N extends M{static getType(){return"resolved-variable-node"}static clone(e){return new N(e.__variable,e.__text,e.__key)}get variable(){return this.__variable}}function T(e,n){const t=(0,k.E0)(e,n);return new N(t,e)}function R(e,n){const t=(0,v.$createTextNode)(n);return e.replace(t),e.remove(),t}function A(e,n,t,r,o){const[i]=(0,g.useLexicalComposerContext)();(0,u.useEffect)((()=>{if(r.current)return i.registerNodeTransform(e,n);i.setEditable(!1);const o=i.registerNodeTransform(e,n);return requestAnimationFrame((()=>{i.setEditable(t)})),o}),[...o])}const L=(e,n,t)=>{A(v.TextNode,(n=>{n.getTextContent()&&function(e,n=[]){const t=e.getTextContent(),r=(0,k.rn)(t);let o=e;for(const e of r){var i;if(!o)return;const r=e.lastIndex-(t.length-(null==(i=o.__text)?void 0:i.length)||0);let s;if(r===e.name.length){const e=o.splitText(r);s=e[0],o=e[1]}else{var a;s=o.splitText(r-e.name.length)[1];const n=null==(a=s)?void 0:a.splitText(e.name.length);s=null==n?void 0:n[0],o=null==n?void 0:n[1]}if(!s)return;const l=(0,k.Q0)(e.name,n)?T(e.name,n):O(e.name);s.replace(l),s.remove()}}(n,e)}),t.isEditable,t.isEditorInFocus,[e])};function D(e,n){if(typeof e!=typeof n)return!1;const t=typeof e;return["string","number","boolean","undefined"].includes(typeof e)?e===n:Array.isArray(e)&&Array.isArray(n)?e.length===n.length&&e.every(((e,t)=>D(e,n[t]))):"object"===t&&(null===e&&null===n||null!==e&&null!==n&&!Array.isArray(e)&&!Array.isArray(n)&&Object.keys(e).length===Object.keys(n).length&&Object.keys(e).every((t=>D(e[t],n[t]))))}const S=(e,n,t)=>{A(N,(n=>{const t=n.getTextContent();if((0,k.CS)(t,e))!function(e,n){const t=O(n);e.replace(t),e.remove()}(n,t);else if((0,k.yG)(t)){if(!D((0,k.E0)(t,e),n.variable)){const r=T(t,e);n.replace(r)}}else R(n,t)}),t.isEditable,t.isEditorInFocus,[e])},P=(e,n,t)=>{A(j,(n=>{const t=n.getTextContent();(0,k.Q0)(t,e)?function(e,n,t){const r=T(n,t);e.replace(r),e.remove()}(n,t,e):(0,k.yG)(t)||R(n,t)}),t.isEditable,t.isEditorInFocus,[e])};var F=t(76802);function H({variables:e,isEditable:n,autofocus:t=!1}){const[r]=(0,g.useLexicalComposerContext)(),[o]=function(e,n){const t=(0,u.useRef)(n);return(0,u.useEffect)((()=>(0,F.mergeRegister)(e.registerCommand(v.FOCUS_COMMAND,(()=>(t.current=!0,!1)),v.COMMAND_PRIORITY_HIGH),e.registerCommand(v.BLUR_COMMAND,(()=>(t.current=!1,!1)),v.COMMAND_PRIORITY_HIGH))),[e]),[t]}(r,null!=t&&t);return L(e,r,{isEditable:n,isEditorInFocus:o}),S(e,r,{isEditable:n,isEditorInFocus:o}),P(e,r,{isEditable:n,isEditorInFocus:o}),null}var z=t(10892),Y=t(20856),V=t(95362),W=t(70262),K=t(98276);const G=(0,u.forwardRef)((({name:e,scope:n,type:t,onClick:r,onMouseEnter:o,isSelected:i,toggleMaskValue:a,isMasked:s},l)=>(0,w.jsxs)(Z,{onMouseEnter:o,isSelected:i,ref:l,role:"option","aria-label":e,"aria-selected":i,onMouseDown:e=>{null==r||r(),e.preventDefault()},children:[(0,w.jsx)(q,{scope:n,"aria-label":`scope: ${n}`,role:"presentation",children:n[0].toUpperCase()}),(0,w.jsxs)($,{children:[(0,w.jsx)(U,{"aria-label":`key: ${e}`,role:"presentation",children:e}),t===K.SECRET&&(0,w.jsx)(B,{onMouseDown:e=>{a(),e.stopPropagation()},onMouseLeave:()=>{a(!0)},children:s?(0,w.jsx)(V.Z,{}):(0,w.jsx)(W.Z,{})})]})]}))),$=d().div.withConfig({displayName:"suggestion-menu-variable-tile__VariableKeyWrapper",componentId:"sc-12lghp2-0"})(["flex:auto;overflow:hidden;text-overflow:ellipsis;display:flex;"]),B=d().div.withConfig({displayName:"suggestion-menu-variable-tile__SecretIconContainer",componentId:"sc-12lghp2-1"})(["display:flex;margin-left:auto;margin-right:var(--spacing-xs);align-items:center;"]),U=d().div.withConfig({displayName:"suggestion-menu-variable-tile__VariableName",componentId:"sc-12lghp2-2"})(["color:var(--content-color-primary);margin-left:var(--spacing-s);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:11px;font-weight:var(--text-weight-medium);"]),Z=d().div.withConfig({displayName:"suggestion-menu-variable-tile__VariableTileWrapper",componentId:"sc-12lghp2-3"})(["display:flex;padding:5px;border-bottom:1px solid var(--border-color-default);justify-content:flex-start;background-color:",";min-height:var(--text-size-l);cursor:pointer;align-items:center;"],(e=>e.isSelected?"var(--highlight-background-color-secondary)":"transparent")),q=d().div.withConfig({displayName:"suggestion-menu-variable-tile__ScopeFirstLetter",componentId:"sc-12lghp2-4"})(["display:inline-flex;height:17px;width:17px;justify-content:center;border-radius:1px;flex:none;text-align:center;line-height:17px;color:var(--content-color-constant);font-weight:var(--text-weight-m);font-size:var(--text-size-m);background-color:",";"],(e=>{switch(e.scope){case"globals":return"var(--base-color-info)";case"collection":return"var(--base-color-warning)";case"environment":return"var(--base-color-success)";default:return""}})),Q=G;function J({label:e,value:n,isMasked:t,isOverridden:r}){if(!1===n)return null;const o="string"==typeof n&&t?"*".repeat(n.length):n;return(0,w.jsxs)(X,{children:[(0,w.jsx)(ee,{children:e}),(0,w.jsx)(ne,{isOverridden:r,children:"string"==typeof n?o:n})]})}const X=d().div.withConfig({displayName:"suggestion-menu-value-tile__ValueTileWrapper",componentId:"sc-120pa9u-0"})(["display:flex;margin:var(--spacing-xs);"]),ee=d().div.withConfig({displayName:"suggestion-menu-value-tile__LabelTile",componentId:"sc-120pa9u-1"})(["flex:0.3;margin-right:var(--spacing-xs);color:var(--content-color-secondary);"]),ne=d().div.withConfig({displayName:"suggestion-menu-value-tile__LabelValue",componentId:"sc-120pa9u-2"})(["flex:0.7;margin:0 var(--spacing-xs);overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;",";"],(({isOverridden:e})=>e&&"text-decoration: line-through;")),te=({variable:e})=>{const{scope:n,overriddenBy:t}=e;if(!t)return null;const r={globals:"global",collection:"collection",environment:"environment"},o=r[n],i=r[t.scope];return t.scope===n?(0,w.jsxs)(ae,{children:["The value is overridden because duplicates of this variable are active in the ",i,". You can enable or disable variables on the ",i," page."]}):(0,w.jsxs)(ae,{children:["This variable exists in both ",i," and ",o," ","scopes. ",(0,w.jsx)("span",{style:{textTransform:"capitalize"},children:i})," variables overwrite ",o," variables."]})},re=({item:e,isMasked:n})=>{if(!e)return(0,w.jsx)(oe,{});const t={globals:"Global",collection:"Collection",environment:"Environment"}[e.variable.scope],r=Boolean(e.variable.overriddenBy);return(0,w.jsxs)(oe,{children:["dynamic"===e.variable.type?(0,w.jsx)(J,{label:"VALUE",value:(0,k.Fn)(e.variable.description)}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(J,{label:"INITIAL",value:(0,k.Fn)(e.variable.value),isMasked:e.variable.type===K.SECRET&&n,isOverridden:r}),(0,w.jsx)(J,{label:"CURRENT",value:(0,k.Fn)(e.variable.sessionValue),isMasked:e.variable.type===K.SECRET&&n,isOverridden:r})]}),r&&(0,w.jsx)(J,{label:"",value:(0,w.jsx)(ie,{children:"OVERRIDDEN"})}),(0,w.jsx)(J,{label:"SCOPE",value:t}),r&&(0,w.jsx)(te,{variable:e.variable})]})},oe=d().div.withConfig({displayName:"suggestion-menu-variable-detail__DetailWrapper",componentId:"sc-ns37kh-0"})(["flex:0.6;height:100%;padding:0 var(--spacing-xs);overflow:hidden auto;box-sizing:border-box;display:flex;flex-direction:column;font-size:var(--text-size-xs);color:var(--content-color-primary);text-align:left;"]),ie=d().div.withConfig({displayName:"suggestion-menu-variable-detail__OverriddenLabel",componentId:"sc-ns37kh-1"})(["background:var(--base-color-warning);border-radius:2px;padding:1px 2px;color:var(--content-color-constant);width:fit-content;font-size:var(--text-size-xs);line-height:12px;"]),ae=d().div.withConfig({displayName:"suggestion-menu-variable-detail__OverrideDescriptionWrapper",componentId:"sc-ns37kh-2"})(["font-size:var(--text-size-xs);padding:var(--spacing-xs);border-top:1px solid var(--border-color-default);color:var(--content-color-secondary);margin-top:var(--spacing-s);line-height:var(--line-height-s);"]);class se extends z.MenuOption{constructor(e,n){super(e),this.variable=void 0,this.variable=Object.assign({},n,{sessionValue:(0,k.Fn)(n.sessionValue),value:(0,k.Fn)(n.value),key:(0,k.Fn)(n.key)})}}function le(e){const n=e.lastIndexOf("{{");return-1==n?null:{leadOffset:n,matchingString:e.slice(n+2,e.length),replaceableString:e.slice(n,e.length)}}function ce({variables:e,onEnter:n}){const[t]=(0,g.useLexicalComposerContext)(),[r,o]=(0,u.useState)(null);(0,u.useEffect)((()=>t.registerCommand(v.KEY_ENTER_COMMAND,(()=>null===r&&(n(),!1)),v.COMMAND_PRIORITY_HIGH)),[r,t,n]),(0,u.useEffect)((()=>t.registerCommand(f,(e=>!(null===r||!["ArrowDown","ArrowUp","Tab","Enter"].includes(e.key))),v.COMMAND_PRIORITY_HIGH)),[t,r]);const i=e.map((e=>new se(e.id,e))),[a,s]=(0,u.useState)(i);return(0,u.useEffect)((()=>{const n=e.filter((e=>{const n=(0,k.Fn)(e.key).toLowerCase();return!r||n.includes(r.toLowerCase())})).map(((e,n)=>new se(String(n),e)));s(n)}),[r,e]),(0,w.jsx)(z.LexicalTypeaheadMenuPlugin,{onSelectOption:(e,n,r)=>{t.update((()=>{const t=(0,v.$createTextNode)(`{{${(0,k.Fn)(e.variable.key)}}}`);null==n||n.replace(t),t.select(),r(),o(null)}))},onQueryChange:o,menuRenderFn:(e,n)=>{const[t,r]=(0,u.useState)(!0),[o,i]=(0,u.useState)(!0);if(!e.current)return null;const a=n.options;if(0===a.length)return null;const s="number"==typeof n.selectedIndex?a[n.selectedIndex]:void 0;return(0,w.jsx)(Y.ZP,{isOpen:t,onClickOutside:()=>r(!1),placement:"bottom-start",triggerRef:e.current,padding:"var(--spacing-s)",maxWidth:"initial",children:(0,w.jsxs)(de,{id:"variable-suggestions","aria-label":"variable suggestions",role:"listbox",children:[(0,w.jsx)(ue,{children:a.map(((e,t)=>(0,w.jsx)(Q,{ref:e.ref,onClick:()=>{n.selectOptionAndCleanUp(e)},onMouseEnter:()=>{n.setHighlightedIndex(t)},isSelected:n.selectedIndex===t,scope:e.variable.scope,name:e.variable.key,type:e.variable.type,toggleMaskValue:e=>i("boolean"==typeof e?e:!o),isMasked:n.selectedIndex!==t||o},e.key)))}),(0,w.jsx)(re,{item:s,isMasked:o})]})})},options:a,triggerFn:le})}const de=d().div.withConfig({displayName:"variable-suggestion-plugin__StyledWrapper",componentId:"sc-1b8nnqb-0"})(["border-radius:var(--border-radius-default);height:196px;width:386px;box-shadow:0 1px 4px 0 rgb(0 0 0 / 37%);background-color:var(--background-color-primary);display:flex;flex-direction:row;"]),ue=d().div.withConfig({displayName:"variable-suggestion-plugin__LeftSideWrapper",componentId:"sc-1b8nnqb-1"})(["flex:0.4;height:100%;box-sizing:border-box;overflow:hidden auto;display:flex;flex-direction:column;border-right:var(--border-width-default) solid var(--border-color-default);font-family:var(--font-family-default);"]),pe=(e,n)=>{(0,u.useEffect)((()=>{if(n)return(0,F.mergeRegister)(e.registerCommand(v.BLUR_COMMAND,(()=>(n(!1),!1)),v.COMMAND_PRIORITY_HIGH),e.registerCommand(v.CLICK_COMMAND,(()=>(n(!0),!1)),v.COMMAND_PRIORITY_HIGH),e.registerCommand(v.KEY_DOWN_COMMAND,(e=>1===e.key.length?(n(!0),!1):!(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||("Escape"===e.key?(n(!1),1):"Backspace"!==e.key||(n(!0),1)))),v.COMMAND_PRIORITY_HIGH))}),[e,n])};function ge({onHardFocus:e}){const[n]=(0,g.useLexicalComposerContext)();return pe(n,e),null}function ve({autofocus:e=!1}){const[n]=(0,g.useLexicalComposerContext)();return(0,u.useEffect)((()=>{e&&n.focus()}),[n]),null}const fe={namespace:"editor",theme:{paragraph:"editor-paragraph",root:"editor-root"},onError(e){throw e},nodes:[N,j]};function xe(){return(0,w.jsx)(l(),{onError:e=>{(0,p.logError)(e,{stack:void 0,appId:"variable-suggestions",crash:!0,errorElementId:"postman-input"})},children:(0,w.jsx)("div",{children:"Snap! something went wrong"})})}function me(e){var n;const t=Object.assign({},fe,{editable:e.isEditable}),i=null==(n=(0,K.useActiveAndDynamicVariables)())?void 0:n.data;return(0,w.jsxs)(r.LexicalComposer,{initialConfig:t,children:[(0,w.jsxs)(_e,{children:[(0,w.jsx)(o.PlainTextPlugin,{contentEditable:(0,w.jsx)(ye,{className:"content-editable",ariaLabel:e.ariaLabel,"data-testid":e.dataTestId,isEditable:e.isEditable}),placeholder:(0,w.jsx)(he,{text:e.placeholder}),ErrorBoundary:xe}),(0,w.jsx)(a.HistoryPlugin,{}),(0,w.jsx)(h,{onChange:n=>e.onChange(n),value:e.value}),e.allowEnter?null:(0,w.jsx)(m,{}),e.onHardFocus&&(0,w.jsx)(ge,{onHardFocus:e.onHardFocus}),(0,w.jsx)(x,{onKeyPress:e.onKeyDown}),(0,w.jsx)(b,{onPaste:e.onPaste}),(0,w.jsx)(ve,{autofocus:e.autofocus})]}),(0,w.jsx)(H,{variables:i||[],isEditable:e.isEditable,autofocus:e.autofocus}),(0,w.jsx)(ce,{variables:i||[],onEnter:e.onEnter})]})}const be=(0,u.memo)(me);function he({text:e}){return(0,w.jsx)(Ce,{className:"placeholder",children:e})}const ye=d()(i.ContentEditable).withConfig({displayName:"lexical-component__StyledEditorInput",componentId:"sc-1p50xnu-0"})(["position:absolute;top:var(--spacing-zero);left:var(--spacing-zero);width:100%;background-color:",";color:var(--content-color-primary);outline:none;margin-top:auto;font-size:var(--font-size-default);display:flex;align-items:center;overflow:auto;line-height:1.5;.editor-paragraph{width:100%;margin:var(--spacing-zero);}:focus{z-index:10;}:focus .editor-paragraph{padding:0 var(--spacing-s);}:not(:focus) .editor-paragraph{text-overflow:ellipsis;overflow:hidden;white-space:nowrap !important;}.variable{color:var(--base-color-brand);text-decoration:none;&:hover{opacity:0.7;}}.unresolved-variable{color:var(--content-color-error);background:var(--background-color-error);padding:2px;}.resolved-variable{color:var(--base-color-brand);text-decoration:none;padding:2px;}"],(e=>e.isEditable?"var(--background-color-primary)":"var(--background-color-secondary)")),Ce=d().div.withConfig({displayName:"lexical-component__StyledPlaceholder",componentId:"sc-1p50xnu-1"})(["position:relative;display:flex;align-items:center;padding:0 var(--spacing-s);top:0;left:0;z-index:20;user-select:none;pointer-events:none;height:100%;color:var(--content-color-tertiary);line-height:1.5;"]),_e=d().div.withConfig({displayName:"lexical-component__StyledEditorContainer",componentId:"sc-1p50xnu-2"})(["background-color:var(--background-color-primary);position:relative;font-size:var(--font-size-default);width:100%;"])}}]);
//# sourceMappingURL=9205.f042912e8bdcc57b.js.map