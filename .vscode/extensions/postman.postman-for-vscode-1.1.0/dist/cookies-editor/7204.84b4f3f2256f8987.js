"use strict";(self.webpackChunkcookies_editor=self.webpackChunkcookies_editor||[]).push([[7204],{8137:(e,t,n)=>{n.r(t),n.d(t,{FeatureFlagsProvider:()=>_,useFeatureFlag:()=>u,withFeatureFlagsConsumer:()=>i});var l=n(8439);const a=({options:e,allFlags:t,ldClient:n})=>{var l,a;const{flagName:u,defaultValue:s,requiredAttributesInContext:r=[]}="defaultValue"in e?e:Object.assign({},e,{defaultValue:void 0}),o=null!=(l=null==n||null==(a=n.getContext())?void 0:a.custom)?l:{},i=(null==r?void 0:r.length)>0&&!r.every((e=>e in o))?s:t[u];return null!=i?i:t[u]};function u(e){const t=(0,l.useFlags)(),n=(0,l.useLDClient)();return{value:a({allFlags:t,ldClient:n,options:e})}}var s=n(540),r=n(2322);const o={ldClient:void 0,flags:void 0};function i(e){return(0,l.withLDConsumer)()((t=>{const n=(0,l.useFlags)(),u=(0,l.useLDClient)();return(0,r.jsx)(e,Object.assign({},t,o,{getFlagsValue:e=>a({options:e,ldClient:u,allFlags:n})}))}))}var d=n(6663),c=n.n(d),g=n(3101);const C=()=>(0,g.isLoggedIn)()?{kind:"user",key:(0,g.getUserId)(),custom:{platform:window.SDK_PLATFORM,appVersion:window.APP_VERSION,releaseChannel:window.NX_RELEASE_CHANNEL,analyticsEnabled:"browser"===window.SDK_PLATFORM,userCreatedAt:0,daysSinceUserCreate:0,emailDomain:"",isPaidPlanGrowth:!1,teamSize:0,roles:[],teamCreatedAt:0,daysSinceTeamCreate:0,webFnCustomPlanId:""}}:{kind:"anonymous",key:"0",custom:{platform:window.SDK_PLATFORM,appVersion:window.APP_VERSION,releaseChannel:window.NX_RELEASE_CHANNEL,analyticsEnabled:"browser"===window.SDK_PLATFORM}};var m=n(6669),v=n(8749);function w(e){return e&&+new Date(e)||0}function F(e){if(!e)return null;const t=new Date,n=new Date(e);return Math.floor(Math.abs(t.getTime()-n.getTime())/864e5)}const f=(0,s.createContext)(void 0),I=({passedInFeatureFlagContext:e,children:t,debounceInterval:n=200})=>{const[a,u]=(0,s.useState)([]),o=(0,s.useRef)(!1),i=(0,l.useLDClient)(),d=(0,s.useCallback)((e=>{u((t=>[...t,e]))}),[]),{loggedInUserCustomAttributes:c,isCustomAttributesLoading:C,externalUserId:I}=function(e){var t,n,a;const u=(0,g.getUserId)(),r=(0,g.isLoggedIn)(),o=(0,l.useLDClient)(),{data:i,isLoading:d}=(0,m.useTeamsByUserId)({overrideQueryParams:{billing:!0},enabled:r}),{data:c,isLoading:C}=(0,m.useExternalId)({userId:u,enabled:r}),{data:f,isLoading:I}=(0,m.useUserInfo)({userId:u,enabled:r}),{data:b,isLoading:p}=(0,v.useGetPlanFeatures)(u,r),_=null!=(t=null==i||null==(n=i.organizations)?void 0:n.find((e=>e.id===(0,g.getTeamId)())))?t:void 0,x=d||I||p||C,L=(0,s.useMemo)((()=>{var t,n,l,a,u,s,i,d,c,g,C;return x||!r?void 0:Object.assign({},null==o?void 0:o.getContext().custom,null==e?void 0:e.custom,{userCreatedAt:w(null!=(t=null==f?void 0:f.created_at)?t:null),daysSinceUserCreate:F(null!=(n=null==f?void 0:f.created_at)?n:null)||0,emailDomain:null!=(l=null==f||null==(a=f.email)?void 0:a.split("@")[1])?l:"",teamSize:null!=(u=null==_?void 0:_.team_size)?u:0,roles:(null!=(s=null==_?void 0:_.roles)?s:"").split(","),teamCreatedAt:w(null!=(i=null==_?void 0:_.created_at)?i:null),daysSinceTeamCreate:F(null!=(d=null==_?void 0:_.created_at)?d:null)||0,webFnCustomPlanId:null!=(c=null==_?void 0:_.plan)?c:null,isPaidPlanGrowth:null!=(g=null==b||null==(C=b.data)||null==(C=C.features.is_paid_plan_growth)?void 0:C.value)&&g})}),[x,r,o,null==e?void 0:e.custom,null==f?void 0:f.created_at,null==f?void 0:f.email,null==_?void 0:_.team_size,null==_?void 0:_.roles,null==_?void 0:_.created_at,null==_?void 0:_.plan,null==b||null==(a=b.data)?void 0:a.features]);return{isCustomAttributesLoading:x,loggedInUserCustomAttributes:L,externalUserId:null!=c?c:(0,g.getUserId)()}}(e);(0,s.useEffect)((()=>{C||d(c)}),[d,C,c]);const p=((e,t)=>{const n=(0,s.useRef)(null);return(0,s.useCallback)((()=>{n.current&&clearTimeout(n.current),n.current=setTimeout(e,t)}),[e,t])})((0,s.useCallback)((async()=>{if(!o.current&&0!==a.length){const t=b({contextUpdateQueue:a,currentFeatureFlagsContext:null==i?void 0:i.getContext(),externalUserId:I,passedInFeatureFlagContext:e});o.current=!0;try{await(null==i?void 0:i.identify(t)),u([])}catch(e){throw new Error(`Error occurred while updating feature flags context: ${e}`)}finally{o.current=!1}}}),[a,i,I,e]),n);return(0,s.useEffect)((()=>{p()}),[p]),(0,r.jsx)(f.Provider,{value:{addCustomAttributesUpdateToQueue:d},children:t})},b=({contextUpdateQueue:e,currentFeatureFlagsContext:t,externalUserId:n,passedInFeatureFlagContext:l})=>e.reduce(((e,l)=>{const a=Object.assign({},e.custom,l);return Object.assign({},t,{key:n,custom:a})}),Object.assign({},t,l,{custom:(null==t?void 0:t.custom)||{}})),p={useCamelCaseFlagKeys:!1};function _({children:e,featureFlagsContext:t}){const n=c().LAUNCH_DARKLY_CLIENT_SIDE_ID;return n?(0,r.jsx)(l.LDProvider,{clientSideID:n,context:C(),reactOptions:p,children:(0,r.jsx)(I,{passedInFeatureFlagContext:t,children:e})}):(0,r.jsx)(r.Fragment,{children:e})}}}]);
//# sourceMappingURL=7204.84b4f3f2256f8987.js.map