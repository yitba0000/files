"use strict";(self.webpackChunkcookies_editor=self.webpackChunkcookies_editor||[]).push([[3740],{7977:(o,e,i)=>{i.d(e,{L:()=>a});var n=i(2837);async function a(){return(0,n.getCookieManager)().fetchCookies()}},3740:(o,e,i)=>{i.d(e,{Z:()=>U});var n=i(540),a=i(2837),t=i(9245),s=i(9530),d=i.n(s),c=i(8560),r=i(8495),l=i(605),m=i(1607),p=i(2322);const g=d().section.withConfig({displayName:"domain-input__DomainInputWrapper",componentId:"sc-1n805ju-0"})(["display:grid;gap:var(--spacing-s);grid-template-columns:1fr auto auto;grid-template-areas:'domain_input domain_add_btn refresh_btn';margin-block-end:var(--spacing-m);"]),k=d()(r.Z).withConfig({displayName:"domain-input__StyledInput",componentId:"sc-1n805ju-1"})(["&:not(:focus){border-color:var(--border-color-default);background-color:var(--background-color-secondary);}"]),u=d()(l.Z).withConfig({displayName:"domain-input__StyledRoloadButton",componentId:"sc-1n805ju-2"})(["grid-area:'refresh_btn';&:hover{background:var(--highlight-background-color-primary);}"]),h=o=>{const[e,i]=(0,n.useState)(""),a=e=>{const n=e.trim();""!==n&&(i((()=>"")),o.onAddDomain(n))};return(0,p.jsxs)(g,{children:[(0,p.jsx)(k,{style:{gridArea:"domain_input"},placeholder:"Type a domain name",value:e,onClear:()=>i((()=>"")),onKeyDown:o=>{"Enter"===o.key&&a(e)},onChange:o=>{i(o.target.value)}}),(0,p.jsx)(l.Z,{style:{gridArea:"domain_add_btn"},type:"secondary",text:"Add domain",onClick:()=>a(e)}),(0,p.jsx)(u,{type:"tertiary",icon:(0,p.jsx)(m.Z,{}),text:"Refresh",onClick:e=>{e.stopPropagation(),o.onRefresh()}})]})};var C=i(3691),_=i(4962),E=i(9460),I=i(9627),y=i(9705),b=i(5869);const x=d().div.withConfig({displayName:"cookie-pill__CookiePillWrapper",componentId:"sc-1nabzyu-0"})(["color:var(--content-color-secondary);background-color:",";border-radius:var(--border-radius-default);cursor:default;display:flex;align-items:center;margin-block-end:var(--spacing-s);padding-block:var(--spacing-s);padding-inline-start:var(--spacing-s);"],(o=>{return e=o.theme,o.isActive?e["highlight-background-color-secondary"]:e["background-color-primary"];var e})),f=o=>{const{isActive:e,onClick:i,onDelete:n,cookieName:a}=o;return(0,p.jsxs)(x,{isActive:e,onClick:o=>{o.stopPropagation(),i()},role:"tab","aria-expanded":e,"aria-label":"edit cookie",children:[a,(0,p.jsx)(l.Z,{type:"plain",icon:(0,p.jsx)(I.Z,{}),onClick:o=>{o.stopPropagation(),n()},"aria-label":"delete cookie"})]})},j=d()(c.Z).withConfig({displayName:"cookie-per-domain__Wrapper",componentId:"sc-n0abup-0"})(["margin-block:var(--spacing-m);padding-inline:var(--spacing-s);"]),O=o=>{const{cookies:e,selectedCookieId:i,onAddCookie:n,onCookieClicked:t,onCookieDelete:s}=o;return(0,p.jsxs)(j,{gap:"spacing-m",wrap:"wrap",children:[e.map((o=>{const e=(0,a.getCookieIdentifier)(o);return(0,p.jsx)(f,{isActive:e===i,onClick:()=>t(o),onDelete:()=>s(o),cookieName:o.name},e)})),(0,p.jsx)(l.Z,{type:"tertiary",text:"Add cookie",icon:(0,p.jsx)(b.Z,{}),onClick:o=>{o.stopPropagation(),n()}})]})};var v=i(1217);const D=d()(c.Z).withConfig({displayName:"cookie-source-editor__Wrapper",componentId:"sc-fsx1zx-0"})(["margin-block:var(--spacing-s);padding-inline:var(--spacing-s);"]),A=o=>{const[e,i]=(0,n.useState)((0,a.stringifyCookie)(o.cookie));return(0,p.jsxs)(D,{direction:"column",gap:"spacing-m",children:[(0,p.jsx)(v.Z,{value:e,onChange:o=>{i(o.target.value)}}),(0,p.jsxs)(c.Z,{gap:"spacing-m",justifyContent:"flex-end",children:[(0,p.jsx)(l.Z,{text:"Cancel",type:"secondary",size:"small",onClick:()=>o.onCancel()}),(0,p.jsx)(l.Z,{text:"Save",type:"primary",size:"small",onClick:()=>(()=>{const i=(0,a.parseCookieString)(o.host,e);i&&o.onSave(i)})()})]})]})};function S(o){const e={};for(const i of o)e[i.domain]=e[i.domain]||{expanded:!1,cookies:[]},e[i.domain].cookies.push(i);return e}const T=o=>({domains:S(o),highlightedDomain:null,cookieInEditMode:null,cookieCounter:o.length}),N=o=>1===o.length?"1 cookie":`${o.length} cookies`,M=(o,e)=>{o({type:"ADD_DOMAIN",domain:e})},L=(o,e)=>e?o["highlight-background-color-primary"]:"transparent",Z=d().header.withConfig({displayName:"domains-list__DomainSectionHeader",componentId:"sc-a8srlu-0"})(["gap:0.5rem;display:grid;grid-template-columns:auto auto 1fr;grid-template-areas:'domain_name domain_count domain_delete_btn';place-items:center end;min-height:var(--size-m);padding-inline:var(--spacing-s);"]),w=d()(l.Z).withConfig({displayName:"domains-list__DeleteDomainButton",componentId:"sc-a8srlu-1"})(["grid-area:domain_delete_btn;display:none;"]),P=d().section.withConfig({displayName:"domains-list__DomainSection",componentId:"sc-a8srlu-2"})(["cursor:default;background-color:",";border-bottom:var(--border-style-solid) var(--border-width-default) var(--border-color-default);&:hover{","{background-color:",";}","{display:inline-flex;}}"],(o=>L(o.theme,o.isActive)),Z,(o=>L(o.theme,!0)),w),R=d().figure.withConfig({displayName:"domains-list__EmptyCookieFigure",componentId:"sc-a8srlu-3"})(["margin:0;margin-block-start:var(--spacing-xxxl);display:flex;flex-direction:column;flex:1;height:100%;align-items:center;justify-content:center;"]),K=d().figcaption.withConfig({displayName:"domains-list__EmptyCookieCaption",componentId:"sc-a8srlu-4"})(["margin-block-start:var(--spacing-l);"]),H=o=>{const{state:e,dispatch:i}=o,n=Object.entries(e.domains),t=(0,a.useCookieActions)();return 0===n.length?(0,p.jsxs)(R,{children:[(0,p.jsx)(C.Z,{}),(0,p.jsx)(K,{children:(0,p.jsx)(_.Z,{type:"h4",text:"No Cookies available",color:"content-color-primary"})})]}):(0,p.jsx)(p.Fragment,{children:n.map((([o,{cookies:n,expanded:s}])=>(0,p.jsxs)(P,{onClick:e=>{e.stopPropagation(),i({type:"HIGHLIGHT_SECTION",domain:o})},isActive:o===e.highlightedDomain,role:"region","aria-label":"domain",children:[(0,p.jsxs)(Z,{onClick:e=>{e.stopPropagation(),i({type:"COLLAPSE_EXPAND_SECTION",domain:o})},"aria-label":"domain header",children:[(0,p.jsx)(_.Z,{style:{gridArea:"domain_name"},type:"h4",text:o}),(0,p.jsx)(E.ZP,{style:{gridArea:"domain_count"},children:N(n)}),(0,p.jsx)(w,{icon:(0,p.jsx)(I.Z,{}),type:"tertiary",tooltip:"Delete","data-testid":"domain-delete-btn",onClick:e=>{e.stopPropagation(),t.deleteDomain(o),i({type:"DELETE_DOMAIN",domain:o})}})]}),s&&(0,p.jsx)(O,{cookies:n,selectedCookieId:e.cookieInEditMode&&(0,a.getCookieIdentifier)(e.cookieInEditMode),onCookieClicked:o=>{i({type:"START_EDIT_COOKIE",cookie:o})},onAddCookie:()=>{i({type:"ADD_COOKIE",domain:o,onAddCookie:t.addCookie})},onCookieDelete:o=>{t.deleteCookie(o),i({type:"DELETE_COOKIE",cookie:o})}}),null!==e.cookieInEditMode&&e.cookieInEditMode.domain===o&&(0,p.jsx)(A,{host:e.cookieInEditMode.domain,cookie:e.cookieInEditMode,onCancel:()=>{i({type:"CANCEL_EDIT_COOKIE"})},onSave:o=>{e.cookieInEditMode&&(t.updateCookie(e.cookieInEditMode,o),i({type:"SAVE_EDITED_COOKIE",cookie:o}))}},(0,a.getCookieIdentifier)(e.cookieInEditMode))]},o)))})};var F=i(7977);const q=o=>({activeTabIndex:0,domainsList:T(o)}),z=(o,e)=>{switch(e.type){case"SET_ACTIVE_TAB":return Object.assign({},o,{activeTabIndex:e.index});case"FROM_DOMAIN_LIST":{const i=((o,e)=>{switch(e.type){case"ADD_DOMAIN":{const i=function(o){const e=y.parse(o);return e.host?e.host.join(".").toLowerCase():""}(e.domain);return""===i||void 0!==o.domains[i]?o:Object.assign({},o,{domains:Object.assign({},o.domains,{[i]:{expanded:!0,cookies:[]}})})}case"DELETE_DOMAIN":{const i={};for(const[n,a]of Object.entries(o.domains))n!==e.domain&&(i[n]=a);return Object.assign({},o,{domains:i})}case"HIGHLIGHT_SECTION":return Object.assign({},o,{highlightedDomain:e.domain});case"COLLAPSE_EXPAND_SECTION":{const i={};for(const[n,a]of Object.entries(o.domains))i[n]=n===e.domain?Object.assign({},a,{expanded:!a.expanded}):a;return Object.assign({},o,{highlightedDomain:e.domain,cookieInEditMode:null,domains:i})}case"START_EDIT_COOKIE":return Object.assign({},o,{highlightedDomain:e.cookie.domain,cookieInEditMode:e.cookie});case"CANCEL_EDIT_COOKIE":return Object.assign({},o,{cookieInEditMode:null});case"SAVE_EDITED_COOKIE":{if(!o.cookieInEditMode)return o;const{domain:i}=e.cookie;return o.domains[i].cookies=((o,e,i)=>{if((0,a.cookiesEq)(e,i)){const i=o.findIndex((o=>(0,a.cookiesEq)(o,e)));return o[i]=e,o}const n=o.findIndex((o=>(0,a.cookiesEq)(o,i))),t=o.findIndex((o=>(0,a.cookiesEq)(o,e)));return t>-1?(o.splice(t,1,e),o.splice(n,1),o):(o[n]=e,o)})(o.domains[i].cookies,e.cookie,o.cookieInEditMode),o.cookieInEditMode=null,o}case"ADD_COOKIE":{const i=o.cookieCounter+1,n=(0,a.makeCookie)(`Cookie_${i}`,e.domain),t=[...o.domains[e.domain].cookies,n];return e.onAddCookie(n),Object.assign({},o,{highlightedDomain:e.domain,cookieCounter:i,cookieInEditMode:n,domains:Object.assign({},o.domains,{[e.domain]:Object.assign({},o.domains[e.domain],{cookies:t})})})}case"DELETE_COOKIE":{const{domain:i,name:n,path:a}=e.cookie,t=o.domains[i].cookies.filter((o=>o.name===n?o.path!==a:o.name!==n));return Object.assign({},o,{cookieInEditMode:null,domains:Object.assign({},o.domains,{[i]:Object.assign({},o.domains[i],{cookies:t})})})}}})(o.domainsList,e.subAction);return Object.assign({},o,{domainsList:i})}case"REFRESH_SUCCESS":return Object.assign({},o,{domainsList:T(e.cookies)})}},G=d()(c.Z).withConfig({displayName:"cookies-editor__CookieEditorContainer",componentId:"sc-298s6q-0"})(["background-color:var(--background-color-primary);color:var(--content-color-primary);display:flex;flex-direction:column;padding:var(--spacing-l);"]);function W(o){const{state:e,dispatch:i}=o,n=o=>{i({type:"FROM_DOMAIN_LIST",subAction:o})};return(0,p.jsxs)(G,{children:[(0,p.jsx)(h,{onAddDomain:o=>{M(n,o)},onRefresh:()=>{(0,F.L)().then((o=>{i({type:"REFRESH_SUCCESS",cookies:o})}))}}),(0,p.jsx)(H,{state:e.domainsList,dispatch:n})]})}var B=i(6669);function U(){const{setTabTitle:o}=(0,t.useTabTitleMeta)();o("Cookies","cookies-editor"),(0,B.useAccountDataUpdateSubscription)();const e=(0,t.useLoaderData)(),[i,s]=(0,n.useReducer)(z,q(e));return(0,p.jsx)(a.CookieActionsProvider,{children:(0,p.jsx)(W,{dispatch:s,state:i})})}}}]);
//# sourceMappingURL=3740.c99aea6518578218.js.map